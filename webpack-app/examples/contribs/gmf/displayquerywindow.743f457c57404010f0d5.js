webpackJsonp([2],{217:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=m(r(4)),n=m(r(2)),i=m(r(62)),l=m(r(41)),u=m(r(218)),s=m(r(95)),a=m(r(16)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(6)),h=m(r(44)),d=m(r(30)),p=m(r(31)),f=m(r(12));function m(e){return e&&e.__esModule?e:{default:e}}var g=angular.module("gmfQueryWindowComponent",[i.default.module.name,l.default.module.name,u.default.name,s.default.module.name,"ngAnimate","ngTouch"]);function y(e,t,r){return r(e,t)}g.config(["$animateProvider",function(e){e.classNameFilter(/gmf-animatable/)}]),g.value("gmfDisplayquerywindowTemplateUrl",function(e,t){var r=t.gmfDisplayquerywindowTemplateurl;return void 0!==r?r:o.default.baseModuleTemplateUrl+"/query/windowComponent.html"}),y.$inject=["$element","$attrs","gmfDisplayquerywindowTemplateUrl"],g.component_={controller:"GmfDisplayquerywindowController as ctrl",bindings:{draggableContainment:"<?gmfDisplayquerywindowDraggableContainment",featuresStyleFn:"&gmfDisplayquerywindowFeaturesstyle",selectedFeatureStyleFn:"&gmfDisplayquerywindowSelectedfeaturestyle",defaultCollapsedFn:"&?gmfDisplayquerywindowDefaultcollapsed",desktop:"=gmfDisplayquerywindowDesktop",showUnqueriedLayers:"=gmfDisplayquerywindowShowunqueriedlayers"},templateUrl:y},g.component("gmfDisplayquerywindow",g.component_),g.Controller_=function(e,t,r,o,n){var i=this;this.draggableContainment,this.desktop=!1,this.collapsed=!this.desktop,this.showUnqueriedLayers_=!1,this.sourcesFilter={queried:!0},this.ngeoQueryResult={sources:[],total:0,pending:!1},this.ngeoMapQuerent_=o,this.selectedSource=null,this.features_=new a.default,this.ngeoFeatureOverlayMgr_=n,this.highlightFeatures_=new a.default,this.source=null,this.feature=null,this.currentResult=-1,this.isNext=!0,this.animate=0,this.open=!1,this.element_=e,t.$watchCollection(function(){return r},function(e,t){i.updateQueryResult_(e),e.total>0?i.show():t!==e&&i.close()})},g.Controller_.$inject=["$element","$scope","ngeoQueryResult","ngeoMapQuerent","ngeoFeatureOverlayMgr"],g.Controller_.prototype.$onInit=function(){this.draggableContainment=this.draggableContainment||"document",this.desktop=this.desktop,this.collapsed=this.defaultCollapsedFn?!0===this.defaultCollapsedFn():!this.desktop,this.showUnqueriedLayers_=!!this.showUnqueriedLayers&&!0===this.showUnqueriedLayers,this.sourcesFilter=this.showUnqueriedLayers_?{}:{queried:!0};var e=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();e.setFeatures(this.features_);var t=this.featuresStyleFn();void 0!==t&&(n.default.assertInstanceof(t,f.default),e.setStyle(t));var r=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();r.setFeatures(this.highlightFeatures_);var o=this.selectedFeatureStyleFn();if(void 0!==o)n.default.assertInstanceof(o,f.default);else{var i=new d.default({color:[255,0,0,.6]}),l=new p.default({color:[255,0,0,1],width:2});o=new f.default({fill:i,image:new h.default({fill:i,radius:5,stroke:l}),stroke:l})}r.setStyle(o),this.desktop&&(this.element_.find(".gmf-displayquerywindow .container").draggable({cancel:"input,textarea,button,select,option,tr",containment:this.draggableContainment}),this.element_.find(".gmf-displayquerywindow .container").resizable({minHeight:240,minWidth:240}))},g.Controller_.prototype.show=function(){this.clear(),this.updateFeatures_()},g.Controller_.prototype.updateFeatures_=function(){this.setCurrentResult_(0,!1),null!==this.source&&(this.collectFeatures_(),this.highlightCurrentFeature_(),this.open=!0)},g.Controller_.prototype.setCurrentResult_=function(e,t){var r=!1;if(e!==this.currentResult){var o=void 0,n=void 0,i=void 0,l=this.feature,u=this.ngeoQueryResult.sources;for(this.currentResult=e,o=0;o<u.length;o++)if(n=u[o],null===this.selectedSource||this.selectedSource===n){if(!(e>=(i=n.features).length)){this.source=n,this.feature=n.features[e],r=!0;break}e-=i.length}t&&this.highlightCurrentFeature_(l)}return r},g.Controller_.prototype.previous=function(){var e=this.currentResult-1;e<0&&(e=this.getResultLength()-1),this.setCurrentResult_(e,!0)&&this.animate_(!1)},g.Controller_.prototype.next=function(){var e=this.currentResult+1;e>this.getResultLength()-1&&(e=0),this.setCurrentResult_(e,!0)&&this.animate_(!0)},g.Controller_.prototype.updateQueryResult_=function(e){this.ngeoQueryResult.total=0,this.ngeoQueryResult.sources.length=0;for(var t=0;t<e.sources.length;t++){var r=e.sources[t];r.features=r.features.filter(function(e){return n.default.assert(e),!c.isEmpty(l.default.getFilteredFeatureValues(e))}),this.ngeoQueryResult.sources.push(r),this.ngeoQueryResult.total+=r.features.length}},g.Controller_.prototype.getResultLength=function(){return null===this.selectedSource?this.ngeoQueryResult.total:this.selectedSource.features.length},g.Controller_.prototype.isFirst=function(){return 0==this.currentResult},g.Controller_.prototype.isLast=function(){return this.currentResult==this.getResultLength()-1},g.Controller_.prototype.getFeatureValues=function(){return this.feature?l.default.getFilteredFeatureValues(this.feature):null},g.Controller_.prototype.animate_=function(e){this.isNext=e,this.animate++},g.Controller_.prototype.collectFeatures_=function(){var e=this.ngeoQueryResult.sources;this.features_.clear();for(var t=0;t<e.length;t++){var r=e[t];if(null===this.selectedSource||this.selectedSource===r)for(var o=r.features,n=0;n<o.length;n++)this.features_.push(o[n])}},g.Controller_.prototype.highlightCurrentFeature_=function(e){this.highlightFeatures_.clear(),this.features_.remove(this.feature),this.highlightFeatures_.push(this.feature),void 0!==e&&this.features_.push(e)},g.Controller_.prototype.close=function(){this.open=!1,this.clear(),this.ngeoMapQuerent_.clear()},g.Controller_.prototype.clear=function(){this.feature=null,this.source=null,this.currentResult=-1,this.features_.clear(),this.highlightFeatures_.clear(),this.selectedSource=null},g.Controller_.prototype.setSelectedSource=function(e){null!==e&&e.features.length<=0||(this.clear(),this.selectedSource=e,this.updateFeatures_())},g.controller("GmfDisplayquerywindowController",g.Controller_),t.default=g},218:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=angular.module("ngeoMiscSwipe",[]);o.factory("$verticalSwipe",[function(){var e={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup",cancel:"pointercancel"}};function t(e){var t=e.originalEvent||e,r=t.touches&&t.touches.length?t.touches:[t],o=t.changedTouches&&t.changedTouches[0]||r[0];return{x:o.clientX,y:o.clientY}}function r(t,r){var o=[];return angular.forEach(t,function(t){var n=e[t][r];n&&o.push(n)}),o.join(" ")}return{bind:function(e,o,n){var i=void 0,l=void 0,u=void 0,s=void 0,a=!1;n=n||["mouse","touch","pointer"],e.on(r(n,"start"),function(e){u=t(e),a=!0,i=0,l=0,s=u,o.start&&o.start(u,e)});var c=r(n,"cancel");c&&e.on(c,function(e){a=!1,o.cancel&&o.cancel(e)}),e.on(r(n,"move"),function(e){if(a&&u){var r=t(e);if(i+=Math.abs(r.x-s.x),l+=Math.abs(r.y-s.y),s=r,!(i<10&&l<10))return i>l?(a=!1,void(o.cancel&&o.cancel(e))):(e.preventDefault(),void(o.move&&o.move(r,e)))}}),e.on(r(n,"end"),function(e){a&&(a=!1,o.end&&o.end(t(e),e))})}}}]),o.makeSwipeDirective_=function(e,t,r){o.directive(e,["$parse","$verticalSwipe",function(o,n){var i=75,l=.3,u=30;return function(s,a,c){var h=o(c[e]),d=void 0,p=void 0;var f=["touch"];angular.isDefined(c.ngeoSwipeDisableMouse)||f.push("mouse"),n.bind(a,{start:function(e,t){d=e,p=!0},cancel:function(e){p=!1},end:function(e,o){(function(e){if(!d)return!1;var r=(e.y-d.y)*t,o=Math.abs(e.x-d.x);return p&&o<i&&r>0&&r>u&&o/r<l})(e)&&s.$apply(function(){a.triggerHandler(r),h(s,{$event:o})})}},f)}}])},o.makeSwipeDirective_("ngeoSwipeDown",1,"swipedown"),o.makeSwipeDirective_("ngeoSwipeUp",-1,"swipeup"),t.default=o},416:function(e,t,r){r(17),e.exports=r(417)},417:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});v(r(4));var o=v(r(131)),n=v(r(70)),i=v(r(29)),l=v(r(217)),u=v(r(19)),s=v(r(94)),a=(v(r(34)),v(r(140)),v(r(139)),v(r(15))),c=v(r(23)),h=v(r(14)),d=v(r(8)),p=v(r(44)),f=v(r(30)),m=v(r(31)),g=v(r(12)),y=v(r(103));function v(e){return e&&e.__esModule?e:{default:e}}var w={};w.module=angular.module("gmfapp",[o.default.module.name,n.default.name,i.default.name,l.default.name,u.default.module.name,y.default.name,s.default.name]),w.module.value("ngeoQueryOptions",{limit:20}),w.module.value("gmfTreeUrl","https://geomapfish-demo.camptocamp.net/2.2/wsgi/themes?version=2&background=background"),w.constant("defaultTheme","Demo"),w.constant("angularLocaleScript","../build/angular-locale_{{locale}}.js"),w.queryresultComponent={controller:"AppQueryresultController",controllerAs:"qrCtrl",templateUrl:"partials/queryresult.html"},w.module.component("appQueryresult",w.queryresultComponent),w.QueryresultController=function(e){this.result=e},w.QueryresultController.$inject=["ngeoQueryResult"],w.module.controller("AppQueryresultController",w.QueryresultController),w.MainController=function(e,t,r){var o=this;e.loadThemes();var n=new f.default({color:[255,170,0,.6]}),i=new m.default({color:[255,170,0,1],width:2});this.featureStyle=new g.default({fill:n,image:new p.default({fill:n,radius:5,stroke:i}),stroke:i}),this.map=new a.default({layers:[new h.default({source:new d.default})],view:new c.default({projection:"EPSG:21781",resolutions:[200,100,50,20,10,5,2.5,2,1,.5],center:[537635,152640],zoom:3})}),t.setDatasourceMap(this.map),this.themes=void 0,this.treeSource=void 0,this.queryActive=!0,e.getThemesObject().then(function(e){e&&(o.themes=e,o.treeSource=e[3])}),r.init(this.map)},w.MainController.$inject=["gmfThemes","gmfDataSourcesManager","ngeoFeatureOverlayMgr"],w.module.controller("MainController",w.MainController),t.default=w},8:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(25),i=r(22);const l=function(e){const t=e||{},r=void 0!==t.projection?t.projection:"EPSG:3857",o=void 0!==t.tileGrid?t.tileGrid:i.a.createXYZ({extent:i.a.extentFromProjection(r),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});n.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:r,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(o.inherits)(l,n.a);var u=l;const s=function(e){const t=e||{};let r;r=void 0!==t.attributions?t.attributions:[s.ATTRIBUTION];const o=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";u.call(this,{attributions:r,cacheSize:t.cacheSize,crossOrigin:o,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:n,wrapX:t.wrapX})};Object(o.inherits)(s,u),s.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.';t.default=s}},[416]);
//# sourceMappingURL=displayquerywindow.743f457c57404010f0d5.js.map