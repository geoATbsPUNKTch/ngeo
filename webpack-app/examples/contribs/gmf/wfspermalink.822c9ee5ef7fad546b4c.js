webpackJsonp([1],{217:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=g(r(4)),n=g(r(2)),i=g(r(62)),u=g(r(41)),a=g(r(218)),l=g(r(95)),s=g(r(16)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(6)),h=g(r(44)),d=g(r(30)),f=g(r(31)),p=g(r(12));function g(e){return e&&e.__esModule?e:{default:e}}var m=angular.module("gmfQueryWindowComponent",[i.default.module.name,u.default.module.name,a.default.name,l.default.module.name,"ngAnimate","ngTouch"]);function y(e,t,r){return r(e,t)}m.config(["$animateProvider",function(e){e.classNameFilter(/gmf-animatable/)}]),m.value("gmfDisplayquerywindowTemplateUrl",function(e,t){var r=t.gmfDisplayquerywindowTemplateurl;return void 0!==r?r:o.default.baseModuleTemplateUrl+"/query/windowComponent.html"}),y.$inject=["$element","$attrs","gmfDisplayquerywindowTemplateUrl"],m.component_={controller:"GmfDisplayquerywindowController as ctrl",bindings:{draggableContainment:"<?gmfDisplayquerywindowDraggableContainment",featuresStyleFn:"&gmfDisplayquerywindowFeaturesstyle",selectedFeatureStyleFn:"&gmfDisplayquerywindowSelectedfeaturestyle",defaultCollapsedFn:"&?gmfDisplayquerywindowDefaultcollapsed",desktop:"=gmfDisplayquerywindowDesktop",showUnqueriedLayers:"=gmfDisplayquerywindowShowunqueriedlayers"},templateUrl:y},m.component("gmfDisplayquerywindow",m.component_),m.Controller_=function(e,t,r,o,n){var i=this;this.draggableContainment,this.desktop=!1,this.collapsed=!this.desktop,this.showUnqueriedLayers_=!1,this.sourcesFilter={queried:!0},this.ngeoQueryResult={sources:[],total:0,pending:!1},this.ngeoMapQuerent_=o,this.selectedSource=null,this.features_=new s.default,this.ngeoFeatureOverlayMgr_=n,this.highlightFeatures_=new s.default,this.source=null,this.feature=null,this.currentResult=-1,this.isNext=!0,this.animate=0,this.open=!1,this.element_=e,t.$watchCollection(function(){return r},function(e,t){i.updateQueryResult_(e),e.total>0?i.show():t!==e&&i.close()})},m.Controller_.$inject=["$element","$scope","ngeoQueryResult","ngeoMapQuerent","ngeoFeatureOverlayMgr"],m.Controller_.prototype.$onInit=function(){this.draggableContainment=this.draggableContainment||"document",this.desktop=this.desktop,this.collapsed=this.defaultCollapsedFn?!0===this.defaultCollapsedFn():!this.desktop,this.showUnqueriedLayers_=!!this.showUnqueriedLayers&&!0===this.showUnqueriedLayers,this.sourcesFilter=this.showUnqueriedLayers_?{}:{queried:!0};var e=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();e.setFeatures(this.features_);var t=this.featuresStyleFn();void 0!==t&&(n.default.assertInstanceof(t,p.default),e.setStyle(t));var r=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();r.setFeatures(this.highlightFeatures_);var o=this.selectedFeatureStyleFn();if(void 0!==o)n.default.assertInstanceof(o,p.default);else{var i=new d.default({color:[255,0,0,.6]}),u=new f.default({color:[255,0,0,1],width:2});o=new p.default({fill:i,image:new h.default({fill:i,radius:5,stroke:u}),stroke:u})}r.setStyle(o),this.desktop&&(this.element_.find(".gmf-displayquerywindow .container").draggable({cancel:"input,textarea,button,select,option,tr",containment:this.draggableContainment}),this.element_.find(".gmf-displayquerywindow .container").resizable({minHeight:240,minWidth:240}))},m.Controller_.prototype.show=function(){this.clear(),this.updateFeatures_()},m.Controller_.prototype.updateFeatures_=function(){this.setCurrentResult_(0,!1),null!==this.source&&(this.collectFeatures_(),this.highlightCurrentFeature_(),this.open=!0)},m.Controller_.prototype.setCurrentResult_=function(e,t){var r=!1;if(e!==this.currentResult){var o=void 0,n=void 0,i=void 0,u=this.feature,a=this.ngeoQueryResult.sources;for(this.currentResult=e,o=0;o<a.length;o++)if(n=a[o],null===this.selectedSource||this.selectedSource===n){if(!(e>=(i=n.features).length)){this.source=n,this.feature=n.features[e],r=!0;break}e-=i.length}t&&this.highlightCurrentFeature_(u)}return r},m.Controller_.prototype.previous=function(){var e=this.currentResult-1;e<0&&(e=this.getResultLength()-1),this.setCurrentResult_(e,!0)&&this.animate_(!1)},m.Controller_.prototype.next=function(){var e=this.currentResult+1;e>this.getResultLength()-1&&(e=0),this.setCurrentResult_(e,!0)&&this.animate_(!0)},m.Controller_.prototype.updateQueryResult_=function(e){this.ngeoQueryResult.total=0,this.ngeoQueryResult.sources.length=0;for(var t=0;t<e.sources.length;t++){var r=e.sources[t];r.features=r.features.filter(function(e){return n.default.assert(e),!c.isEmpty(u.default.getFilteredFeatureValues(e))}),this.ngeoQueryResult.sources.push(r),this.ngeoQueryResult.total+=r.features.length}},m.Controller_.prototype.getResultLength=function(){return null===this.selectedSource?this.ngeoQueryResult.total:this.selectedSource.features.length},m.Controller_.prototype.isFirst=function(){return 0==this.currentResult},m.Controller_.prototype.isLast=function(){return this.currentResult==this.getResultLength()-1},m.Controller_.prototype.getFeatureValues=function(){return this.feature?u.default.getFilteredFeatureValues(this.feature):null},m.Controller_.prototype.animate_=function(e){this.isNext=e,this.animate++},m.Controller_.prototype.collectFeatures_=function(){var e=this.ngeoQueryResult.sources;this.features_.clear();for(var t=0;t<e.length;t++){var r=e[t];if(null===this.selectedSource||this.selectedSource===r)for(var o=r.features,n=0;n<o.length;n++)this.features_.push(o[n])}},m.Controller_.prototype.highlightCurrentFeature_=function(e){this.highlightFeatures_.clear(),this.features_.remove(this.feature),this.highlightFeatures_.push(this.feature),void 0!==e&&this.features_.push(e)},m.Controller_.prototype.close=function(){this.open=!1,this.clear(),this.ngeoMapQuerent_.clear()},m.Controller_.prototype.clear=function(){this.feature=null,this.source=null,this.currentResult=-1,this.features_.clear(),this.highlightFeatures_.clear(),this.selectedSource=null},m.Controller_.prototype.setSelectedSource=function(e){null!==e&&e.features.length<=0||(this.clear(),this.selectedSource=e,this.updateFeatures_())},m.controller("GmfDisplayquerywindowController",m.Controller_),t.default=m},218:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=angular.module("ngeoMiscSwipe",[]);o.factory("$verticalSwipe",[function(){var e={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup",cancel:"pointercancel"}};function t(e){var t=e.originalEvent||e,r=t.touches&&t.touches.length?t.touches:[t],o=t.changedTouches&&t.changedTouches[0]||r[0];return{x:o.clientX,y:o.clientY}}function r(t,r){var o=[];return angular.forEach(t,function(t){var n=e[t][r];n&&o.push(n)}),o.join(" ")}return{bind:function(e,o,n){var i=void 0,u=void 0,a=void 0,l=void 0,s=!1;n=n||["mouse","touch","pointer"],e.on(r(n,"start"),function(e){a=t(e),s=!0,i=0,u=0,l=a,o.start&&o.start(a,e)});var c=r(n,"cancel");c&&e.on(c,function(e){s=!1,o.cancel&&o.cancel(e)}),e.on(r(n,"move"),function(e){if(s&&a){var r=t(e);if(i+=Math.abs(r.x-l.x),u+=Math.abs(r.y-l.y),l=r,!(i<10&&u<10))return i>u?(s=!1,void(o.cancel&&o.cancel(e))):(e.preventDefault(),void(o.move&&o.move(r,e)))}}),e.on(r(n,"end"),function(e){s&&(s=!1,o.end&&o.end(t(e),e))})}}}]),o.makeSwipeDirective_=function(e,t,r){o.directive(e,["$parse","$verticalSwipe",function(o,n){var i=75,u=.3,a=30;return function(l,s,c){var h=o(c[e]),d=void 0,f=void 0;var p=["touch"];angular.isDefined(c.ngeoSwipeDisableMouse)||p.push("mouse"),n.bind(s,{start:function(e,t){d=e,f=!0},cancel:function(e){f=!1},end:function(e,o){(function(e){if(!d)return!1;var r=(e.y-d.y)*t,o=Math.abs(e.x-d.x);return f&&o<i&&r>0&&r>a&&o/r<u})(e)&&l.$apply(function(){s.triggerHandler(r),h(l,{$event:o})})}},p)}}])},o.makeSwipeDirective_("ngeoSwipeDown",1,"swipedown"),o.makeSwipeDirective_("ngeoSwipeUp",-1,"swipeup"),t.default=o},465:function(e,t,r){r(17),e.exports=r(466)},466:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});f(r(4));var o=f(r(29)),n=f(r(217)),i=(f(r(34)),f(r(15))),u=f(r(23)),a=f(r(14)),l=f(r(8)),s=f(r(31)),c=f(r(12)),h=f(r(30)),d=f(r(44));function f(e){return e&&e.__esModule?e:{default:e}}var p={};p.module=angular.module("gmfapp",[o.default.name,n.default.name]),p.module.value("ngeoWfsPermalinkOptions",{url:"https://geomapfish-demo.camptocamp.net/2.2/wsgi/mapserv_proxy",wfsTypes:[{featureType:"fuel",label:"display_name"},{featureType:"osm_scale",label:"display_name"}],defaultFeatureNS:"http://mapserver.gis.umn.edu/mapserver",defaultFeaturePrefix:"feature"}),p.constant("defaultTheme","Demo"),p.constant("angularLocaleScript","../build/angular-locale_{{locale}}.js"),p.MainController=function(){this.map=new i.default({layers:[new a.default({source:new l.default})],view:new u.default({projection:"EPSG:21781",resolutions:[200,100,50,20,10,5,2.5,2,1,.5],center:[537635,152640],zoom:3})});var e=new h.default({color:[255,170,0,.6]}),t=new s.default({color:[255,170,0,1],width:2});this.featureStyle=new c.default({fill:e,image:new d.default({fill:e,radius:5,stroke:t}),stroke:t})},p.module.controller("MainController",p.MainController),t.default=p},8:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(25),i=r(22);const u=function(e){const t=e||{},r=void 0!==t.projection?t.projection:"EPSG:3857",o=void 0!==t.tileGrid?t.tileGrid:i.a.createXYZ({extent:i.a.extentFromProjection(r),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});n.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:r,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(o.inherits)(u,n.a);var a=u;const l=function(e){const t=e||{};let r;r=void 0!==t.attributions?t.attributions:[l.ATTRIBUTION];const o=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";a.call(this,{attributions:r,cacheSize:t.cacheSize,crossOrigin:o,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:n,wrapX:t.wrapX})};Object(o.inherits)(l,a),l.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.';t.default=l}},[465]);
//# sourceMappingURL=wfspermalink.822c9ee5ef7fad546b4c.js.map