webpackJsonp([24],{11:function(e,t,i){"use strict";t.a="1.3.0"},12:function(e,t,i){"use strict";t.a={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"}},16:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(11),o=i(0),r=i(63),s=i(56),a=i(2),u=i(9),l=i(4);const c=function(e,t,i,n,o,a){r.a.call(this,e,t,i,s.a.IDLE),this.src_=n,this.image_=new Image,null!==o&&(this.image_.crossOrigin=o),this.imageListenerKeys_=null,this.state=s.a.IDLE,this.imageLoadFunction_=a};Object(o.inherits)(c,r.a),c.prototype.getImage=function(){return this.image_},c.prototype.handleImageError_=function(){this.state=s.a.ERROR,this.unlistenImage_(),this.changed()},c.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Object(l.getHeight)(this.extent)/this.image_.height),this.state=s.a.LOADED,this.unlistenImage_(),this.changed()},c.prototype.load=function(){this.state!=s.a.IDLE&&this.state!=s.a.ERROR||(this.state=s.a.LOADING,this.changed(),this.imageListenerKeys_=[a.default.listenOnce(this.image_,u.a.ERROR,this.handleImageError_,this),a.default.listenOnce(this.image_,u.a.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_))},c.prototype.setImage=function(e){this.image_=e},c.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(a.default.unlistenByKey),this.imageListenerKeys_=null};var d=c,h=i(10),f=i(5),_=i(6),g=i(28),p=i(57),m=i(12),y=i(15),v=i(22);const E=function(e){const t=e||{};p.default.call(this,{attributions:t.attributions,projection:t.projection,resolutions:t.resolutions}),this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null,this.url_=t.url,this.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:p.default.defaultImageLoadFunction,this.params_=t.params||{},this.v13_=!0,this.updateV13_(),this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5};Object(o.inherits)(E,p.default),E.GETFEATUREINFO_IMAGE_SIZE_=[101,101],E.prototype.getGetFeatureInfoUrl=function(e,t,i,o){if(void 0===this.url_)return;const r=Object(_.get)(i),s=this.getProjection();s&&s!==r&&(t=g.a.calculateSourceResolution(s,r,e,t),e=Object(_.transform)(e,r,s));const a=Object(l.getForViewAndSize)(e,t,0,E.GETFEATUREINFO_IMAGE_SIZE_),u={SERVICE:"WMS",VERSION:n.a,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object(f.assign)(u,this.params_,o);const c=Math.floor((e[0]-a[0])/t),d=Math.floor((a[3]-e[1])/t);return u[this.v13_?"I":"X"]=c,u[this.v13_?"J":"Y"]=d,this.getRequestUrl_(a,E.GETFEATUREINFO_IMAGE_SIZE_,1,s||r,u)},E.prototype.getParams=function(){return this.params_},E.prototype.getImageInternal=function(e,t,i,o){if(void 0===this.url_)return null;t=this.findNearestResolution(t),1==i||this.hidpi_&&void 0!==this.serverType_||(i=1);const r=t/i,s=Object(l.getCenter)(e),c=Math.ceil(Object(l.getWidth)(e)/r),h=Math.ceil(Object(l.getHeight)(e)/r),_=Object(l.getForViewAndSize)(s,r,0,[c,h]),g=Math.ceil(this.ratio_*Object(l.getWidth)(e)/r),p=Math.ceil(this.ratio_*Object(l.getHeight)(e)/r),m=Object(l.getForViewAndSize)(s,r,0,[g,p]),y=this.image_;if(y&&this.renderedRevision_==this.getRevision()&&y.getResolution()==t&&y.getPixelRatio()==i&&Object(l.containsExtent)(y.getExtent(),_))return y;const v={SERVICE:"WMS",VERSION:n.a,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};Object(f.assign)(v,this.params_),this.imageSize_[0]=Math.round(Object(l.getWidth)(m)/r),this.imageSize_[1]=Math.round(Object(l.getHeight)(m)/r);const E=this.getRequestUrl_(m,this.imageSize_,i,o,v);return this.image_=new d(m,t,i,E,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),a.default.listen(this.image_,u.a.CHANGE,this.handleImageChange,this),this.image_},E.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},E.prototype.getRequestUrl_=function(e,t,i,n,o){if(Object(h.a)(void 0!==this.url_,9),o[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(o.STYLES=""),1!=i)switch(this.serverType_){case m.a.GEOSERVER:const e=90*i+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+e:o.FORMAT_OPTIONS="dpi:"+e;break;case m.a.MAPSERVER:o.MAP_RESOLUTION=90*i;break;case m.a.CARMENTA_SERVER:case m.a.QGIS:o.DPI=90*i;break;default:Object(h.a)(!1,8)}o.WIDTH=t[0],o.HEIGHT=t[1];const r=n.getAxisOrientation();let s;return s=this.v13_&&"ne"==r.substr(0,2)?[e[1],e[0],e[3],e[2]]:e,o.BBOX=s.join(","),Object(v.appendParams)(this.url_,o)},E.prototype.getUrl=function(){return this.url_},E.prototype.setImageLoadFunction=function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()},E.prototype.setUrl=function(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())},E.prototype.updateParams=function(e){Object(f.assign)(this.params_,e),this.updateV13_(),this.image_=null,this.changed()},E.prototype.updateV13_=function(){const e=this.params_.VERSION||n.a;this.v13_=y.default.compareVersions(e,"1.3")>=0};t.default=E},181:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(47),r=i(144),s=i(40),a=i(88),u=i(90),l=i(8),c=i(86),d=i(2),h=i(43),f=i(9),_=i(85),g=i(4),p=i(13),m=i(27),y="modifystart",v="modifyend",E=i(78),S=i(20),R=i(18),O=i(189),F=i(155),b=i(17);const x=function(e){let t;if(E.default.call(this,{handleDownEvent:x.handleDownEvent_,handleDragEvent:x.handleDragEvent_,handleEvent:x.handleEvent,handleUpEvent:x.handleUpEvent_}),this.condition_=e.condition?e.condition:_.default.primaryAction,this.defaultDeleteCondition_=function(e){return _.default.altKeyOnly(e)&&_.default.singleClick(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:_.default.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new F.default,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new S.default({source:new R.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:x.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,t=new o.default(this.source_.getFeatures()),d.default.listen(this.source_,O.a.ADDFEATURE,this.handleSourceAdd_,this),d.default.listen(this.source_,O.a.REMOVEFEATURE,this.handleSourceRemove_,this)):t=e.features,!t)throw new Error("The modify interaction requires features or a source");this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),d.default.listen(this.features_,r.a.ADD,this.handleFeatureAdd_,this),d.default.listen(this.features_,r.a.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null};Object(n.inherits)(x,E.default),x.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX=0,x.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX=1,x.prototype.addFeature_=function(e){const t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),d.default.listen(e,f.a.CHANGE,this.handleFeatureChange_,this)},x.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new x.Event(y,this.features_,e)))},x.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),d.default.unlisten(e,f.a.CHANGE,this.handleFeatureChange_,this)},x.prototype.removeFeatureSegmentData_=function(e){const t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])},x.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),E.default.prototype.setActive.call(this,e)},x.prototype.setMap=function(e){this.overlay_.setMap(e),E.default.prototype.setMap.call(this,e)},x.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},x.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},x.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},x.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}},x.prototype.handleFeatureRemove_=function(e){const t=e.element;this.removeFeature_(t)},x.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},x.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();let n,o,r,s;for(o=0,r=i.length;o<r;++o)s={feature:e,geometry:t,depth:[o],index:o,segment:[n=i[o],n]},this.rBush_.insert(t.getExtent(),s)},x.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,o,r,s;for(n=0,o=i.length-1;n<o;++n)s={feature:e,geometry:t,index:n,segment:r=i.slice(n,n+2)},this.rBush_.insert(Object(g.boundingExtent)(r),s)},x.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,o,r,s,a,u,l;for(s=0,a=i.length;s<a;++s)for(o=0,r=(n=i[s]).length-1;o<r;++o)l={feature:e,geometry:t,depth:[s],index:o,segment:u=n.slice(o,o+2)},this.rBush_.insert(Object(g.boundingExtent)(u),l)},x.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,o,r,s,a,u,l;for(s=0,a=i.length;s<a;++s)for(o=0,r=(n=i[s]).length-1;o<r;++o)l={feature:e,geometry:t,depth:[s],index:o,segment:u=n.slice(o,o+2)},this.rBush_.insert(Object(g.boundingExtent)(u),l)},x.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,o,r,s,a,u,l,c,d,h;for(u=0,l=i.length;u<l;++u)for(s=0,a=(c=i[u]).length;s<a;++s)for(o=0,r=(n=c[s]).length-1;o<r;++o)h={feature:e,geometry:t,depth:[s,u],index:o,segment:d=n.slice(o,o+2)},this.rBush_.insert(Object(g.boundingExtent)(d),h)},x.prototype.writeCircleGeometry_=function(e,t){const i=t.getCenter(),n={feature:e,geometry:t,index:x.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX,segment:[i,i]},o={feature:e,geometry:t,index:x.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX,segment:[i,i]},r=[n,o];n.featureSegments=o.featureSegments=r,this.rBush_.insert(Object(g.createOrUpdateFromCoordinate)(i),n),this.rBush_.insert(t.getExtent(),o)},x.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t)this.SEGMENT_WRITERS_[i[t].getType()].call(this,e,i[t])},x.prototype.createOrUpdateVertexFeature_=function(e){let t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new s.default(new m.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t));return t},x.compareIndexes_=function(e,t){return e.index-t.index},x.handleDownEvent_=function(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);const t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;const i=this.vertexFeature_;if(i){const o=[],r=i.getGeometry().getCoordinates(),s=Object(g.boundingExtent)([r]),a=this.rBush_.getInExtent(s),u={};a.sort(x.compareIndexes_);for(let i=0,s=a.length;i<s;++i){const s=a[i],l=s.segment;let d=Object(n.getUid)(s.feature);const h=s.depth;if(h&&(d+="-"+h.join("-")),u[d]||(u[d]=new Array(2)),s.geometry.getType()===p.default.CIRCLE&&s.index===x.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const e=x.closestOnSegmentData_(t,s);c.default.equals(e,r)&&!u[d][0]&&(this.dragSegments_.push([s,0]),u[d][0]=s)}else if(c.default.equals(l[0],r)&&!u[d][0])this.dragSegments_.push([s,0]),u[d][0]=s;else if(c.default.equals(l[1],r)&&!u[d][1]){if((s.geometry.getType()===p.default.LINE_STRING||s.geometry.getType()===p.default.MULTI_LINE_STRING)&&u[d][0]&&0===u[d][0].index)continue;this.dragSegments_.push([s,1]),u[d][1]=s}else this.insertVertexCondition_(e)&&Object(n.getUid)(l)in this.vertexSegments_&&!u[d][0]&&!u[d][1]&&o.push([s,r])}o.length&&this.willModifyFeatures_(e);for(let e=o.length-1;e>=0;--e)this.insertVertex_.apply(this,o[e])}return!!this.vertexFeature_},x.handleDragEvent_=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);const t=e.coordinate;for(let e=0,i=this.dragSegments_.length;e<i;++e){const i=this.dragSegments_[e],n=i[0],o=n.depth,r=n.geometry;let s;const a=n.segment,u=i[1];for(;t.length<r.getStride();)t.push(a[u][t.length]);switch(r.getType()){case p.default.POINT:s=t,a[0]=a[1]=t;break;case p.default.MULTI_POINT:(s=r.getCoordinates())[n.index]=t,a[0]=a[1]=t;break;case p.default.LINE_STRING:(s=r.getCoordinates())[n.index+u]=t,a[u]=t;break;case p.default.MULTI_LINE_STRING:case p.default.POLYGON:(s=r.getCoordinates())[o[0]][n.index+u]=t,a[u]=t;break;case p.default.MULTI_POLYGON:(s=r.getCoordinates())[o[1]][o[0]][n.index+u]=t,a[u]=t;break;case p.default.CIRCLE:a[0]=a[1]=t,n.index===x.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX?(this.changingFeature_=!0,r.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,r.setRadius(c.default.distance(r.getCenter(),t)),this.changingFeature_=!1)}s&&this.setGeometryCoordinates_(r,s)}this.createOrUpdateVertexFeature_(t)},x.handleUpEvent_=function(e){let t,i;for(let e=this.dragSegments_.length-1;e>=0;--e)if((i=(t=this.dragSegments_[e][0]).geometry).getType()===p.default.CIRCLE){const e=i.getCenter(),n=t.featureSegments[0],o=t.featureSegments[1];n.segment[0]=n.segment[1]=e,o.segment[0]=o.segment[1]=e,this.rBush_.update(Object(g.createOrUpdateFromCoordinate)(e),n),this.rBush_.update(i.getExtent(),o)}else this.rBush_.update(Object(g.boundingExtent)(t.segment),t);return this.modified_&&(this.dispatchEvent(new x.Event(v,this.features_,e)),this.modified_=!1),!1},x.handleEvent=function(e){if(!(e instanceof u.default))return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=a.a.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=a.a.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==a.a.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),E.default.handleEvent.call(this,e)&&!t},x.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},x.prototype.handlePointerAtPixel_=function(e,t){const i=t.getCoordinateFromPixel(e),o=function(e,t){return x.pointDistanceToSegmentDataSquared_(i,e)-x.pointDistanceToSegmentDataSquared_(i,t)},r=Object(g.buffer)(Object(g.createOrUpdateFromCoordinate)(i),t.getView().getResolution()*this.pixelTolerance_),s=this.rBush_.getInExtent(r);if(s.length>0){s.sort(o);const r=s[0],a=r.segment;let u=x.closestOnSegmentData_(i,r);const l=t.getPixelFromCoordinate(u);let d=c.default.distance(e,l);if(d<=this.pixelTolerance_){const e={};if(r.geometry.getType()===p.default.CIRCLE&&r.index===x.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{const i=t.getPixelFromCoordinate(a[0]),o=t.getPixelFromCoordinate(a[1]),r=c.default.squaredDistance(l,i),h=c.default.squaredDistance(l,o);let f;d=Math.sqrt(Math.min(r,h)),this.snappedToVertex_=d<=this.pixelTolerance_,this.snappedToVertex_&&(u=r>h?a[1]:a[0]),this.createOrUpdateVertexFeature_(u);for(let t=1,i=s.length;t<i&&(f=s[t].segment,c.default.equals(a[0],f[0])&&c.default.equals(a[1],f[1])||c.default.equals(a[0],f[1])&&c.default.equals(a[1],f[0]));++t)e[Object(n.getUid)(f)]=!0}return e[Object(n.getUid)(a)]=!0,void(this.vertexSegments_=e)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},x.pointDistanceToSegmentDataSquared_=function(e,t){const i=t.geometry;if(i.getType()===p.default.CIRCLE){const n=i;if(t.index===x.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const t=c.default.squaredDistance(n.getCenter(),e),i=Math.sqrt(t)-n.getRadius();return i*i}}return c.default.squaredDistanceToSegment(e,t.segment)},x.closestOnSegmentData_=function(e,t){const i=t.geometry;return i.getType()===p.default.CIRCLE&&t.index===x.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX?i.getClosestPoint(e):c.default.closestOnSegment(e,t.segment)},x.prototype.insertVertex_=function(e,t){const i=e.segment,n=e.feature,o=e.geometry,r=e.depth,s=e.index;let a;for(;t.length<o.getStride();)t.push(0);switch(o.getType()){case p.default.MULTI_LINE_STRING:case p.default.POLYGON:(a=o.getCoordinates())[r[0]].splice(s+1,0,t);break;case p.default.MULTI_POLYGON:(a=o.getCoordinates())[r[1]][r[0]].splice(s+1,0,t);break;case p.default.LINE_STRING:(a=o.getCoordinates()).splice(s+1,0,t);break;default:return}this.setGeometryCoordinates_(o,a);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(o,s,r,1);const l={segment:[i[0],t],feature:n,geometry:o,depth:r,index:s};u.insert(Object(g.boundingExtent)(l.segment),l),this.dragSegments_.push([l,1]);const c={segment:[t,i[1]],feature:n,geometry:o,depth:r,index:s+1};u.insert(Object(g.boundingExtent)(c.segment),c),this.dragSegments_.push([c,0]),this.ignoreNextSingleClick_=!0},x.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=a.a.POINTERDRAG){const e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new x.Event(v,this.features_,e)),this.modified_=!1,!0}return!1},x.prototype.removeVertex_=function(){const e=this.dragSegments_,t={};let i,o,r,s,a,u,l,c,d,h,f,_=!1;for(a=e.length-1;a>=0;--a)h=(r=e[a])[0],f=Object(n.getUid)(h.feature),h.depth&&(f+="-"+h.depth.join("-")),f in t||(t[f]={}),0===r[1]?(t[f].right=h,t[f].index=h.index):1==r[1]&&(t[f].left=h,t[f].index=h.index+1);for(f in t){switch(d=t[f].right,l=t[f].left,c=(u=t[f].index)-1,h=void 0!==l?l:d,c<0&&(c=0),i=o=(s=h.geometry).getCoordinates(),_=!1,s.getType()){case p.default.MULTI_LINE_STRING:o[h.depth[0]].length>2&&(o[h.depth[0]].splice(u,1),_=!0);break;case p.default.LINE_STRING:o.length>2&&(o.splice(u,1),_=!0);break;case p.default.MULTI_POLYGON:i=i[h.depth[1]];case p.default.POLYGON:(i=i[h.depth[0]]).length>4&&(u==i.length-1&&(u=0),i.splice(u,1),_=!0,0===u&&(i.pop(),i.push(i[0]),c=i.length-1))}if(_){this.setGeometryCoordinates_(s,o);const t=[];if(void 0!==l&&(this.rBush_.remove(l),t.push(l.segment[0])),void 0!==d&&(this.rBush_.remove(d),t.push(d.segment[1])),void 0!==l&&void 0!==d){const e={depth:h.depth,feature:h.feature,geometry:h.geometry,index:c,segment:t};this.rBush_.insert(Object(g.boundingExtent)(e.segment),e)}this.updateSegmentIndices_(s,u,h.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return _},x.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},x.prototype.updateSegmentIndices_=function(e,t,i,n){this.rBush_.forEachInExtent(e.getExtent(),function(o){o.geometry===e&&(void 0===i||void 0===o.depth||Object(l.equals)(o.depth,i))&&o.index>t&&(o.index+=n)})},x.getDefaultStyleFunction=function(){const e=b.default.createDefaultEditing();return function(t,i){return e[p.default.POINT]}},x.Event=function(e,t,i){h.default.call(this,e),this.features=t,this.mapBrowserEvent=i},Object(n.inherits)(x.Event,h.default);t.default=x},21:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),r=i(43),s=(n=r)&&n.__esModule?n:{default:n};var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s.default.call(this,e),this.detail=t};o.inherits(a,s.default),t.default=a},23:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(11),o=i(0),r=i(10),s=i(4),a=i(5),u=i(14),l=i(6),c=i(28),d=i(60),h=i(42),f=i(12),_=i(61),g=i(15),p=i(22);const m=function(e){const t=e||{},i=t.params||{},n=!("TRANSPARENT"in i)||i.TRANSPARENT;h.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:!n,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition}),this.gutter_=void 0!==t.gutter?t.gutter:0,this.params_=i,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=Object(s.createEmpty)(),this.updateV13_(),this.setKey(this.getKeyForParams_())};Object(o.inherits)(m,h.a),m.prototype.getGetFeatureInfoUrl=function(e,t,i,o){const r=Object(l.get)(i),u=this.getProjection();let h=this.getTileGrid();h||(h=this.getTileGridForProjection(r));const f=h.getTileCoordForCoordAndResolution(e,t);if(h.getResolutions().length<=f[0])return;let _=h.getResolution(f[0]),g=h.getTileCoordExtent(f,this.tmpExtent_),p=d.default.toSize(h.getTileSize(f[0]),this.tmpSize);const m=this.gutter_;0!==m&&(p=d.default.buffer(p,m,this.tmpSize),g=Object(s.buffer)(g,_*m,g)),u&&u!==r&&(_=c.a.calculateSourceResolution(u,r,e,_),g=Object(l.transformExtent)(g,r,u),e=Object(l.transform)(e,r,u));const y={SERVICE:"WMS",VERSION:n.a,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object(a.assign)(y,this.params_,o);const v=Math.floor((e[0]-g[0])/_),E=Math.floor((g[3]-e[1])/_);return y[this.v13_?"I":"X"]=v,y[this.v13_?"J":"Y"]=E,this.getRequestUrl_(f,p,g,1,u||r,y)},m.prototype.getGutterInternal=function(){return this.gutter_},m.prototype.getParams=function(){return this.params_},m.prototype.getRequestUrl_=function(e,t,i,n,o,s){const a=this.urls;if(!a)return;if(s.WIDTH=t[0],s.HEIGHT=t[1],s[this.v13_?"CRS":"SRS"]=o.getCode(),"STYLES"in this.params_||(s.STYLES=""),1!=n)switch(this.serverType_){case f.a.GEOSERVER:const e=90*n+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+e:s.FORMAT_OPTIONS="dpi:"+e;break;case f.a.MAPSERVER:s.MAP_RESOLUTION=90*n;break;case f.a.CARMENTA_SERVER:case f.a.QGIS:s.DPI=90*n;break;default:Object(r.a)(!1,52)}const l=o.getAxisOrientation(),c=i;let d,h;this.v13_&&"ne"==l.substr(0,2)&&(d=i[0],c[0]=i[1],c[1]=d,d=i[2],c[2]=i[3],c[3]=d);(s.BBOX=c.join(","),1==a.length)?h=a[0]:h=a[Object(u.modulo)(_.a.hash(e),a.length)];return Object(p.appendParams)(h,s)},m.prototype.getTilePixelRatio=function(e){return this.hidpi_&&void 0!==this.serverType_?e:1},m.prototype.getKeyForParams_=function(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")},m.prototype.fixedTileUrlFunction=function(e,t,i){let o=this.getTileGrid();if(o||(o=this.getTileGridForProjection(i)),o.getResolutions().length<=e[0])return;1==t||this.hidpi_&&void 0!==this.serverType_||(t=1);const r=o.getResolution(e[0]);let u=o.getTileCoordExtent(e,this.tmpExtent_),l=d.default.toSize(o.getTileSize(e[0]),this.tmpSize);const c=this.gutter_;0!==c&&(l=d.default.buffer(l,c,this.tmpSize),u=Object(s.buffer)(u,r*c,u)),1!=t&&(l=d.default.scale(l,t,this.tmpSize));const h={SERVICE:"WMS",VERSION:n.a,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return Object(a.assign)(h,this.params_),this.getRequestUrl_(e,l,u,t,i,h)},m.prototype.updateParams=function(e){Object(a.assign)(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())},m.prototype.updateV13_=function(){const e=this.params_.VERSION||n.a;this.v13_=g.default.compareVersions(e,"1.3")>=0},t.default=m},24:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(1)),o=r(i(47));function r(e){return e&&e.__esModule?e:{default:e}}var s={};s.module=angular.module("ngeoDataSources",[]),s.module.value("ngeoDataSources",new o.default),n.default.module.requires.push(s.module.name),t.default=s},26:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(1);(n=r)&&n.__esModule;var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inRange_=!1!==t.inRange,this.visible_=!0===t.visible,this.attributes=t.attributes||null,this.id_=t.id,this.identifierAttribute_=t.identifierAttribute,this.maxResolution_=t.maxResolution,this.minResolution_=t.minResolution,this.name_=t.name}return o(e,[{key:"getAttributes",value:function(){return this.attributes}},{key:"setAttributes",value:function(e){this.attributes=e}},{key:"inRange",get:function(){return this.inRange_},set:function(e){this.inRange_=e}},{key:"visible",get:function(){return this.visible_},set:function(e){this.visible_=e}},{key:"id",get:function(){return this.id_}},{key:"identifierAttribute",get:function(){return this.identifierAttribute_}},{key:"maxResolution",get:function(){return this.maxResolution_}},{key:"minResolution",get:function(){return this.minResolution_}},{key:"name",get:function(){return this.name_}},{key:"queryable",get:function(){return!1}},{key:"supportsDynamicInRange",get:function(){return null!==this.maxResolution||null!==this.minResolution}}]),e}();t.default=s},29:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(1)),o=d(i(0)),r=h(i(20)),s=d(i(5)),a=h(i(18)),u=h(i(17)),l=h(i(3)),c=h(i(36));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function h(e){return e&&e.__esModule?e:{default:e}}var f=function(){this.featureUidToGroupIndex_={},this.groups_=[],this.source_=new a.default({useSpatialIndex:!1}),this.layer_=new r.default({source:this.source_,style:this.styleFunction_.bind(this),updateWhileAnimating:!0,updateWhileInteracting:!0})};f.prototype.addFeature=function(e,t){l.default.assert(t>=0),l.default.assert(t<this.groups_.length);var i=o.getUid(e).toString();this.featureUidToGroupIndex_[i]=t,this.groups_[t].features[i]=e,this.source_.addFeature(e)},f.prototype.removeFeature=function(e,t){l.default.assert(t>=0),l.default.assert(t<this.groups_.length);var i=o.getUid(e).toString();delete this.featureUidToGroupIndex_[i],delete this.groups_[t].features[i],this.source_.removeFeature(e)},f.prototype.clear=function(e){l.default.assert(e>=0),l.default.assert(e<this.groups_.length);var t=this.groups_[e];for(var i in t.features)this.removeFeature(t.features[i],e);l.default.assert(s.isEmpty(t.features))},f.prototype.getLayer=function(){return this.layer_},f.prototype.getFeatureOverlay=function(){var e=this.groups_.length;return this.groups_.push({styleFunction:u.default.defaultFunction,features:{}}),new c.default(this,e)},f.prototype.init=function(e){this.layer_.setMap(e)},f.prototype.setStyle=function(e,t){l.default.assert(t>=0),l.default.assert(t<this.groups_.length),this.groups_[t].styleFunction=null===e?u.default.defaultFunction:u.default.createFunction(e)},f.prototype.styleFunction_=function(e,t){var i=o.getUid(e).toString();l.default.assert(i in this.featureUidToGroupIndex_);var n=this.featureUidToGroupIndex_[i];return this.groups_[n].styleFunction(e,t)},(f.module=angular.module("ngeoFeatureOverlayMgr",[c.default.module.name])).service("ngeoFeatureOverlayMgr",f),n.default.module.requires.push(f.module.name),t.default=f},3:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o={doAssertFailure_:function(e,t,i,n){var r="Assertion failed",s=void 0;i?(r+=": "+i,s=n):e&&(r+=": "+e,s=t);var a=new o.AssertionError(""+r,s||[]);o.errorHandler_(a)},setErrorHandler:function(e){o.ENABLE_ASSERTS&&(o.errorHandler_=e)},assert:function(e,t,i){return o.ENABLE_ASSERTS&&!e&&o.doAssertFailure_("",null,t,Array.prototype.slice.call(arguments,2)),e},fail:function(e,t){o.ENABLE_ASSERTS&&o.errorHandler_(new o.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1)))},assertNumber:function(e,t,i){return o.ENABLE_ASSERTS&&!goog.isNumber(e)&&o.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertString:function(e,t,i){return o.ENABLE_ASSERTS&&!goog.isString(e)&&o.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertFunction:function(e,t,i){return o.ENABLE_ASSERTS&&!goog.isFunction(e)&&o.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertObject:function(e,t,i){return o.ENABLE_ASSERTS&&!goog.isObject(e)&&o.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertArray:function(e,t,i){return o.ENABLE_ASSERTS&&!goog.isArray(e)&&o.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertBoolean:function(e,t,i){return o.ENABLE_ASSERTS&&!goog.isBoolean(e)&&o.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertElement:function(e,t,i){return!o.ENABLE_ASSERTS||goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT||o.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertInstanceof:function(e,t,i,n){return!o.ENABLE_ASSERTS||e instanceof t||o.doAssertFailure_("Expected instanceof %s but got %s.",[o.getType_(t),o.getType_(e)],i,Array.prototype.slice.call(arguments,3)),e},assertObjectPrototypeIsIntact:function(){for(var e in Object.prototype)o.fail(e+" should not be enumerable in Object.prototype.")},getType_:function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":void 0===e?"undefined":n(e)}};t.default=o},32:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(1)),o=c(i(33)),r=c(i(34)),s=c(i(29)),a=c(i(37)),u=c(i(38)),l=c(i(39));function c(e){return e&&e.__esModule?e:{default:e}}var d=angular.module("ngeoMapModule",[n.default.module.name,o.default.module.name,r.default.name,s.default.module.name,a.default.name,u.default.name,l.default.name]);t.default=d},33:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i(3)),o=f(i(1)),r=f(i(21)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),a=f(i(19)),u=f(i(52)),l=f(i(50)),c=f(i(16)),d=f(i(23)),h=f(i(58));function f(e){return e&&e.__esModule?e:{default:e}}var _=function(){a.default.call(this),this.mapUids_={}};s.inherits(_,a.default),_.prototype.get=function(e){return s.getUid(e).toString()in this.mapUids_?e.getLayers().item(0):null},_.prototype.set=function(e,t){var i=s.getUid(e).toString(),o=this.get(e);null!==o?(n.default.assert(i in this.mapUids_),null!==t?e.getLayers().setAt(0,t):(e.getLayers().removeAt(0),delete this.mapUids_[i])):null!==t&&(e.getLayers().insertAt(0,t),this.mapUids_[i]=!0);var a=new r.default("change",{current:t,previous:o});return this.dispatchEvent(a),o},_.prototype.updateDimensions=function(e,t){var i=this.get(e);if(i){var o=[i];i instanceof u.default&&(o=i.getLayers().getArray()),o.forEach(function(e){if(n.default.assertInstanceof(e,l.default),e){var i=!1,o={};for(var r in e.get("dimensions")){var s=t[r];void 0!==s&&(o[r]=s,i=!0)}if(i){var a=e.getSource();a instanceof h.default?(a.updateDimensions(o),a.refresh()):(a instanceof d.default||a instanceof c.default)&&(a.updateParams(o),a.refresh())}}})}},(_.module=angular.module("ngeoBackgroundLayerMgr",[])).service("ngeoBackgroundLayerMgr",_),o.default.module.requires.push(_.module.name),t.default=_},34:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(i(3)),o=u(i(1)),r=u(i(35)),s=u(i(2)),a=u(i(7));function u(e){return e&&e.__esModule?e:{default:e}}var l=angular.module("ngeoMap",[r.default.module.name]);o.default.module.requires.push(l.name),l.directive_=function(e,t){return{restrict:"A",link:function(i,o,r){var u=r.ngeoMap,l=i.$eval(u);n.default.assertInstanceof(l,a.default),l.setTarget(o[0]),t.map=l;var c=r.ngeoMapManageResize;if(i.$eval(c)){var d=r.ngeoMapResizeTransition,h=i.$eval(d);s.default.listen(e,"resize",function(){if(h){var t=Date.now(),i=!0;!function n(){l.updateSize(),l.renderSync(),i&&e.requestAnimationFrame(n),Date.now()-t>h&&(i=!1)}()}else l.updateSize()})}}}},l.directive_.$inject=["$window","ngeoSyncDataSourcesMap"],l.directive("ngeoMap",l.directive_),t.default=l},35:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=d(i(1)),r=d(i(26)),s=d(i(24)),a=d(i(2)),u=d(i(19)),l=d(i(31)),c=d(i(3));function d(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ngeoDataSources_=t,this.map_=null,this.listenerKeys_=[],a.default.listen(this.ngeoDataSources_,"add",this.handleDataSourcesAdd_,this)}return e.$inject=["ngeoDataSources"],n(e,[{key:"bindMap_",value:function(e){var t=e.getView();this.listenerKeys_.push(a.default.listen(t,"change:resolution",this.handleViewResolutionChange_,this));var i=t.getResolution();c.default.assertNumber(i),this.syncDataSourcesToResolution_(i)}},{key:"unbindMap_",value:function(e){u.default.unByKey(this.listenerKeys_),this.listenerKeys_=[]}},{key:"handleViewResolutionChange_",value:function(e){var t=e.target;c.default.assertInstanceof(t,l.default);var i=t.getResolution();c.default.assertNumber(i),this.syncDataSourcesToResolution_(i)}},{key:"syncDataSourcesToResolution_",value:function(e){var t=this;this.ngeoDataSources_.forEach(function(i){t.syncDataSourceToResolution_(i,e)})}},{key:"syncDataSourceToResolution_",value:function(e,t){if(e.supportsDynamicInRange){var i=e.maxResolution,n=e.minResolution,o=(null===n||void 0===n||t>=n)&&(null===i||void 0===i||t<=i);e.inRange=o}}},{key:"handleDataSourcesAdd_",value:function(e){var t=c.default.assertInstanceof(e.element,r.default);if(this.map_){var i=this.map_.getView().getResolution();c.default.assertNumber(i),this.syncDataSourceToResolution_(t,i)}}},{key:"map",set:function(e){this.map_&&this.unbindMap_(this.map_),this.map_=e,e&&this.bindMap_(e)}}]),e}();h.module=angular.module("ngeoSyncDataSourcesMap",[s.default.module.name]),h.module.service("ngeoSyncDataSourcesMap",h),o.default.module.requires.push(h.module.name),t.default=h},36:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(1)),o=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);t.default=e}(i(0)),r(i(2)));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t){this.manager_=e,this.features_=null,this.index_=t};s.prototype.addFeature=function(e){this.manager_.addFeature(e,this.index_)},s.prototype.removeFeature=function(e){this.manager_.removeFeature(e,this.index_)},s.prototype.clear=function(){this.manager_.clear(this.index_)},s.prototype.setFeatures=function(e){null!==this.features_&&(this.features_.clear(),o.default.unlisten(this.features_,"add",this.handleFeatureAdd_,this),o.default.unlisten(this.features_,"remove",this.handleFeatureRemove_,this)),null!==e&&(e.forEach(function(e){this.addFeature(e)},this),o.default.listen(e,"add",this.handleFeatureAdd_,this),o.default.listen(e,"remove",this.handleFeatureRemove_,this)),this.features_=e},s.prototype.setStyle=function(e){this.manager_.setStyle(e,this.index_)},s.prototype.handleFeatureAdd_=function(e){var t=e.element;this.addFeature(t)},s.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature(t)},s.module=angular.module("ngeoFeatureOverlay",[]),n.default.module.requires.push(s.module.name),t.default=s},37:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i(1),r=(n=o)&&n.__esModule?n:{default:n};var s=angular.module("ngeoRecenter",[]);r.default.module.requires.push(s.name),s.directive_=function(){return{restrict:"A",link:function(e,t,i){var n=i.ngeoRecenterMap,o=e.$eval(n);function r(t){var i=t.attr("ngeo-extent");if(void 0!==i){var n=o.getSize();o.getView().fit(e.$eval(i),{size:n})}var r=t.attr("ngeo-zoom");void 0!==r&&o.getView().setZoom(e.$eval(r))}t.on("click","*",function(e){r(angular.element($(this)))}),t.on("change",function(e){var t=e.target.options[e.target.selectedIndex];r(angular.element(t))})}}},s.directive("ngeoRecenter",s.directive_),t.default=s},38:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(3)),o=s(i(1)),r=s(i(7));function s(e){return e&&e.__esModule?e:{default:e}}var a=angular.module("ngeoResizemap",[]);o.default.module.requires.push(a.name),a.directive_=function(e){return{restrict:"A",link:function(t,i,o){var s=o.ngeoResizemap,a=t.$eval(s);n.default.assertInstanceof(a,r.default);var u=o.ngeoResizemapState;n.default.assert(void 0!==u);var l=void 0,c=void 0,d=function t(){a.updateSize(),a.renderSync(),Date.now()-l<1e3&&(c=e.requestAnimationFrame(t))};i.on("transitionend",function(){a.updateSize(),a.renderSync()}),t.$watch(u,function(t,i){t!=i&&(l=Date.now(),e.cancelAnimationFrame(c),c=e.requestAnimationFrame(d))})}}},a.directive("ngeoResizemap",a.directive_),t.default=a},389:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(390),i(59);var n=v(i(391)),o=v(i(47)),r=v(i(40)),s=v(i(7)),a=v(i(31)),u=v(i(62)),l=v(i(20)),c=v(i(48)),d=v(i(18)),h=v(i(99)),f=v(i(79)),_=v(i(17)),g=v(i(65)),p=v(i(109)),m=v(i(41)),y=v(i(32));function v(e){return e&&e.__esModule?e:{default:e}}app.module=angular.module("app",[ngeo.module.name,y.default.name]);var E=angular.module("app",["ngeo"]);app.MainController=function(){this.map=new s.default({layers:[new u.default({source:new c.default})],view:new a.default({center:[-10997148,4569099],zoom:4})});var e=this.map,t=new m.default([[[-9e6,4e6],[-11e6,4e6],[-11e6,6e6],[-9e6,6e6]]]);this.features=new o.default,this.features.push(new r.default({geometry:t}));var i=new d.default({features:this.features}),y=new l.default({source:i});y.setMap(e);var v,E=((v={}).Polygon=[new _.default({fill:new g.default({color:[255,255,255,.5]})}),new _.default({stroke:new f.default({color:[255,255,255,1],width:5})}),new _.default({stroke:new f.default({color:[0,153,255,1],width:3})})],v.Point=new _.default({image:new p.default,text:new h.default({text:"",font:"normal 18px FontAwesome",fill:new g.default({color:"#ffffff"})})}),v.GeometryCollection=v.Polygon.concat(v.Point),function(e,t){return v[e.getGeometry().getType()]});this.interaction=new n.default({features:this.features,layers:[y],style:E});var S=this.interaction;S.setActive(!1),e.addInteraction(S),e.on("singleclick",function(e){this.map.forEachFeatureAtPixel(e.pixel,function(e){return e})&&this.interaction.setActive(!0)},this)},E.controller("MainController",app.MainController),t.default={}},39:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i(1)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(8)),r=a(i(7)),s=a(i(2));function a(e){return e&&e.__esModule?e:{default:e}}var u=angular.module("ngeoScaleselector",[]);n.default.module.requires.push(u.name),u.value("ngeoScaleselectorTemplateUrl",function(e,t){var i=t.ngeoScaleselectorTemplateurl;return void 0!==i?i:n.default.baseModuleTemplateUrl+"/map/scaleselector.html"}),u.directive_=function(e){return{restrict:"A",scope:!0,controller:"NgeoScaleselectorController",templateUrl:e}},u.directive("ngeoScaleselector",u.directive_),u.ScaleselectorController_=function(e,t,i){var n=this,a=i.ngeoScaleselector;this.scales=e.$eval(a),goog.asserts.assert(void 0!==this.scales),this.zoomLevels,e.$watch(function(){return Object.keys(n.scales).length},function(e){n.zoomLevels=Object.keys(n.scales).map(Number),n.zoomLevels.sort(o.numberSafeCompareFunction)});var l=i.ngeoScaleselectorMap;this.map_=e.$eval(l),goog.asserts.assertInstanceof(this.map_,r.default);var c=i.ngeoScaleselectorOptions,d=e.$eval(c);if(this.options=u.ScaleselectorController_.getOptions_(d),this.$scope_=e,this.resolutionChangeKey_=null,this.currentScale=void 0,null!==this.map_.getView()){var h=this.map_.getView().getZoom();void 0!==h&&(this.currentScale=this.getScale(h))}s.default.listen(this.map_,"change:view",this.handleViewChange_,this),this.registerResolutionChangeListener_(),e.scaleselectorCtrl=this},u.ScaleselectorController_.getOptions_=function(e){var t=!1;return void 0!==e&&(t=1==e.dropup),{dropup:t}},u.ScaleselectorController_.prototype.getScale=function(e){return this.scales[e]},u.ScaleselectorController_.prototype.changeZoom=function(e){this.map_.getView().setZoom(e)},u.ScaleselectorController_.prototype.handleResolutionChange_=function(e){var t=this,i=this.map_.getView(),n=this.scales[i.getZoom()];void 0!==n&&this.$scope_.$applyAsync(function(){t.currentScale=n})},u.ScaleselectorController_.prototype.handleViewChange_=function(e){this.registerResolutionChangeListener_(),this.handleResolutionChange_(null)},u.ScaleselectorController_.prototype.registerResolutionChangeListener_=function(){null!==this.resolutionChangeKey_&&s.default.unlistenByKey(this.resolutionChangeKey_);var e=this.map_.getView();this.resolutionChangeKey_=s.default.listen(e,"change:resolution",this.handleResolutionChange_,this)},u.controller("NgeoScaleselectorController",u.ScaleselectorController_),t.default=u},390:function(e,t){},391:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(i(21)),o=y(i(3)),r=m(i(0)),s=m(i(4)),a=(y(i(47)),y(i(40))),u=(y(i(90)),y(i(2))),l=y(i(181)),c=y(i(78)),d=y(i(82)),h=y(i(27)),f=y(i(30)),_=y(i(41)),g=y(i(20)),p=y(i(18));function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function y(e){return e&&e.__esModule?e:{default:e}}var v=function(e){o.default.assert(e.features),this.listenerKeys_=[],this.modified_=!1,this.keyPressListenerKey_=null,this.changingFeature_=!1,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.features_=e.features,this.feature_=null,this.coordinate_=null,this.centerCoordinate_=null;var t=e.style?e.style:l.default.getDefaultStyleFunction();this.overlay_=new g.default({source:new p.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:t,updateWhileAnimating:!0,updateWhileInteracting:!0}),this.centerFeatures_={},c.default.call(this,{handleDownEvent:this.handleDown_,handleDragEvent:this.handleDrag_,handleUpEvent:this.handleUp_})};r.inherits(v,c.default),v.prototype.setActive=function(e){this.keyPressListenerKey_&&(u.default.unlistenByKey(this.keyPressListenerKey_),this.keyPressListenerKey_=null),c.default.prototype.setActive.call(this,e),e?(this.keyPressListenerKey_=u.default.listen(document,"keyup",this.handleKeyUp_,this),this.features_.forEach(this.addFeature_,this),this.listenerKeys_.push(u.default.listen(this.features_,"add",this.handleFeatureAdd_,this),u.default.listen(this.features_,"remove",this.handleFeatureRemove_,this))):(this.listenerKeys_.forEach(u.default.unlistenByKey),this.listenerKeys_.length=0,this.features_.forEach(this.removeFeature_,this))},v.prototype.addFeature_=function(e){var t=e.getGeometry();o.default.assertInstanceof(t,d.default),e.set("angle",0);var i=r.getUid(e),n=new h.default(this.getCenterCoordinate_(t)),s=new a.default(n);this.centerFeatures_[i]=s,this.overlay_.getSource().addFeature(s)},v.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new l.default.Event("modifystart",this.features_,e)))},v.prototype.removeFeature_=function(e){if(this.feature_=null,e){var t=r.getUid(e);this.centerFeatures_[t]&&(this.overlay_.getSource().removeFeature(this.centerFeatures_[t]),delete this.centerFeatures_[t])}},v.prototype.setMap=function(e){this.overlay_.setMap(e),c.default.prototype.setMap.call(this,e)},v.prototype.handleFeatureAdd_=function(e){var t=e.element;o.default.assertInstanceof(t,a.default,"feature should be an ol.Feature"),this.addFeature_(t)},v.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},v.prototype.handleDown_=function(e){var t=e.map.forEachFeatureAtPixel(e.pixel,function(e,t){return e},void 0);if(t){var i=!1;this.features_.forEach(function(e){r.getUid(e)==r.getUid(t)&&(i=!0)}),i||(t=null)}if(t){this.coordinate_=e.coordinate,this.feature_=t;var n=this.feature_.getGeometry();return void 0!==n&&(this.centerCoordinate_=this.getCenterCoordinate_(n)),!0}return!1},v.prototype.getCenterCoordinate_=function(e){var t=void 0;if(e instanceof f.default)t=e.getFlatMidpoint();else if(e instanceof _.default)t=e.getFlatInteriorPoint();else{var i=e.getExtent();t=s.getCenter(i)}return t},v.prototype.handleDrag_=function(e){this.willModifyFeatures_(e);var t=this.feature_.getGeometry(),i=this.coordinate_[0],n=this.coordinate_[1],o=this.centerCoordinate_[0],r=this.centerCoordinate_[1],s=i-o,a=n-r,u=e.coordinate[0]-o,l=e.coordinate[1]-r;this.coordinate_[0]=e.coordinate[0],this.coordinate_[1]=e.coordinate[1];var c=Math.atan2(l,u),d=Math.atan2(a,s)-c;t.rotate(-d,[o,r])},v.prototype.handleUp_=function(e){if(this.modified_){var t=new n.default("rotateend",{feature:this.feature_});this.dispatchEvent(t),this.modified_=!1,this.setActive(!1)}return!1},v.prototype.handleKeyUp_=function(e){27===e.keyCode&&this.setActive(!1)},t.default=v},48:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(49);const r=function(e){const t=e||{};let i;i=void 0!==t.attributions?t.attributions:[r.ATTRIBUTION];const n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",s=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";o.a.call(this,{attributions:i,cacheSize:t.cacheSize,crossOrigin:n,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:s,wrapX:t.wrapX})};Object(n.inherits)(r,o.a),r.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',t.default=r},49:function(e,t,i){"use strict";var n=i(0),o=i(42),r=i(71);const s=function(e){const t=e||{},i=void 0!==t.projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:r.a.createXYZ({extent:r.a.extentFromProjection(i),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});o.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:i,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(n.inherits)(s,o.a),t.a=s},99:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(65),o=i(138);const r=function(e){const t=e||{};this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.text_=t.text,this.textAlign_=t.textAlign,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new n.default({color:r.DEFAULT_FILL_COLOR_}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:o.a.POINT,this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding};r.DEFAULT_FILL_COLOR_="#333",r.prototype.clone=function(){return new r({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0})},r.prototype.getOverflow=function(){return this.overflow_},r.prototype.getFont=function(){return this.font_},r.prototype.getMaxAngle=function(){return this.maxAngle_},r.prototype.getPlacement=function(){return this.placement_},r.prototype.getOffsetX=function(){return this.offsetX_},r.prototype.getOffsetY=function(){return this.offsetY_},r.prototype.getFill=function(){return this.fill_},r.prototype.getRotateWithView=function(){return this.rotateWithView_},r.prototype.getRotation=function(){return this.rotation_},r.prototype.getScale=function(){return this.scale_},r.prototype.getStroke=function(){return this.stroke_},r.prototype.getText=function(){return this.text_},r.prototype.getTextAlign=function(){return this.textAlign_},r.prototype.getTextBaseline=function(){return this.textBaseline_},r.prototype.getBackgroundFill=function(){return this.backgroundFill_},r.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},r.prototype.getPadding=function(){return this.padding_},r.prototype.setOverflow=function(e){this.overflow_=e},r.prototype.setFont=function(e){this.font_=e},r.prototype.setMaxAngle=function(e){this.maxAngle_=e},r.prototype.setOffsetX=function(e){this.offsetX_=e},r.prototype.setOffsetY=function(e){this.offsetY_=e},r.prototype.setPlacement=function(e){this.placement_=e},r.prototype.setFill=function(e){this.fill_=e},r.prototype.setRotation=function(e){this.rotation_=e},r.prototype.setScale=function(e){this.scale_=e},r.prototype.setStroke=function(e){this.stroke_=e},r.prototype.setText=function(e){this.text_=e},r.prototype.setTextAlign=function(e){this.textAlign_=e},r.prototype.setTextBaseline=function(e){this.textBaseline_=e},r.prototype.setBackgroundFill=function(e){this.backgroundFill_=e},r.prototype.setBackgroundStroke=function(e){this.backgroundStroke_=e},r.prototype.setPadding=function(e){this.padding_=e},t.default=r}},[389]);
//# sourceMappingURL=rotate.min.js.map