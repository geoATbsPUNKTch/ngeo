webpackJsonp([26],{11:function(e,t,i){"use strict";t.a="1.3.0"},12:function(e,t,i){"use strict";t.a={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"}},16:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(11),r=i(0),o=i(63),a=i(56),s=i(2),u=i(9),l=i(4);const c=function(e,t,i,n,r,s){o.a.call(this,e,t,i,a.a.IDLE),this.src_=n,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.imageListenerKeys_=null,this.state=a.a.IDLE,this.imageLoadFunction_=s};Object(r.inherits)(c,o.a),c.prototype.getImage=function(){return this.image_},c.prototype.handleImageError_=function(){this.state=a.a.ERROR,this.unlistenImage_(),this.changed()},c.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Object(l.getHeight)(this.extent)/this.image_.height),this.state=a.a.LOADED,this.unlistenImage_(),this.changed()},c.prototype.load=function(){this.state!=a.a.IDLE&&this.state!=a.a.ERROR||(this.state=a.a.LOADING,this.changed(),this.imageListenerKeys_=[s.default.listenOnce(this.image_,u.a.ERROR,this.handleImageError_,this),s.default.listenOnce(this.image_,u.a.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_))},c.prototype.setImage=function(e){this.image_=e},c.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(s.default.unlistenByKey),this.imageListenerKeys_=null};var d=c,h=i(10),f=i(5),g=i(6),_=i(28),p=i(57),m=i(12),y=i(15),v=i(22);const E=function(e){const t=e||{};p.default.call(this,{attributions:t.attributions,projection:t.projection,resolutions:t.resolutions}),this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null,this.url_=t.url,this.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:p.default.defaultImageLoadFunction,this.params_=t.params||{},this.v13_=!0,this.updateV13_(),this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5};Object(r.inherits)(E,p.default),E.GETFEATUREINFO_IMAGE_SIZE_=[101,101],E.prototype.getGetFeatureInfoUrl=function(e,t,i,r){if(void 0===this.url_)return;const o=Object(g.get)(i),a=this.getProjection();a&&a!==o&&(t=_.a.calculateSourceResolution(a,o,e,t),e=Object(g.transform)(e,o,a));const s=Object(l.getForViewAndSize)(e,t,0,E.GETFEATUREINFO_IMAGE_SIZE_),u={SERVICE:"WMS",VERSION:n.a,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object(f.assign)(u,this.params_,r);const c=Math.floor((e[0]-s[0])/t),d=Math.floor((s[3]-e[1])/t);return u[this.v13_?"I":"X"]=c,u[this.v13_?"J":"Y"]=d,this.getRequestUrl_(s,E.GETFEATUREINFO_IMAGE_SIZE_,1,a||o,u)},E.prototype.getParams=function(){return this.params_},E.prototype.getImageInternal=function(e,t,i,r){if(void 0===this.url_)return null;t=this.findNearestResolution(t),1==i||this.hidpi_&&void 0!==this.serverType_||(i=1);const o=t/i,a=Object(l.getCenter)(e),c=Math.ceil(Object(l.getWidth)(e)/o),h=Math.ceil(Object(l.getHeight)(e)/o),g=Object(l.getForViewAndSize)(a,o,0,[c,h]),_=Math.ceil(this.ratio_*Object(l.getWidth)(e)/o),p=Math.ceil(this.ratio_*Object(l.getHeight)(e)/o),m=Object(l.getForViewAndSize)(a,o,0,[_,p]),y=this.image_;if(y&&this.renderedRevision_==this.getRevision()&&y.getResolution()==t&&y.getPixelRatio()==i&&Object(l.containsExtent)(y.getExtent(),g))return y;const v={SERVICE:"WMS",VERSION:n.a,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};Object(f.assign)(v,this.params_),this.imageSize_[0]=Math.round(Object(l.getWidth)(m)/o),this.imageSize_[1]=Math.round(Object(l.getHeight)(m)/o);const E=this.getRequestUrl_(m,this.imageSize_,i,r,v);return this.image_=new d(m,t,i,E,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),s.default.listen(this.image_,u.a.CHANGE,this.handleImageChange,this),this.image_},E.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},E.prototype.getRequestUrl_=function(e,t,i,n,r){if(Object(h.a)(void 0!==this.url_,9),r[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(r.STYLES=""),1!=i)switch(this.serverType_){case m.a.GEOSERVER:const e=90*i+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+e:r.FORMAT_OPTIONS="dpi:"+e;break;case m.a.MAPSERVER:r.MAP_RESOLUTION=90*i;break;case m.a.CARMENTA_SERVER:case m.a.QGIS:r.DPI=90*i;break;default:Object(h.a)(!1,8)}r.WIDTH=t[0],r.HEIGHT=t[1];const o=n.getAxisOrientation();let a;return a=this.v13_&&"ne"==o.substr(0,2)?[e[1],e[0],e[3],e[2]]:e,r.BBOX=a.join(","),Object(v.appendParams)(this.url_,r)},E.prototype.getUrl=function(){return this.url_},E.prototype.setImageLoadFunction=function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()},E.prototype.setUrl=function(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())},E.prototype.updateParams=function(e){Object(f.assign)(this.params_,e),this.updateV13_(),this.image_=null,this.changed()},E.prototype.updateV13_=function(){const e=this.params_.VERSION||n.a;this.v13_=y.default.compareVersions(e,"1.3")>=0};t.default=E},181:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(47),o=i(144),a=i(40),s=i(88),u=i(90),l=i(8),c=i(86),d=i(2),h=i(43),f=i(9),g=i(85),_=i(4),p=i(13),m=i(27),y="modifystart",v="modifyend",E=i(78),S=i(20),R=i(18),O=i(189),b=i(155),F=i(17);const T=function(e){let t;if(E.default.call(this,{handleDownEvent:T.handleDownEvent_,handleDragEvent:T.handleDragEvent_,handleEvent:T.handleEvent,handleUpEvent:T.handleUpEvent_}),this.condition_=e.condition?e.condition:g.default.primaryAction,this.defaultDeleteCondition_=function(e){return g.default.altKeyOnly(e)&&g.default.singleClick(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:g.default.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new b.default,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new S.default({source:new R.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:T.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,t=new r.default(this.source_.getFeatures()),d.default.listen(this.source_,O.a.ADDFEATURE,this.handleSourceAdd_,this),d.default.listen(this.source_,O.a.REMOVEFEATURE,this.handleSourceRemove_,this)):t=e.features,!t)throw new Error("The modify interaction requires features or a source");this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),d.default.listen(this.features_,o.a.ADD,this.handleFeatureAdd_,this),d.default.listen(this.features_,o.a.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null};Object(n.inherits)(T,E.default),T.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX=0,T.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX=1,T.prototype.addFeature_=function(e){const t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),d.default.listen(e,f.a.CHANGE,this.handleFeatureChange_,this)},T.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new T.Event(y,this.features_,e)))},T.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),d.default.unlisten(e,f.a.CHANGE,this.handleFeatureChange_,this)},T.prototype.removeFeatureSegmentData_=function(e){const t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])},T.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),E.default.prototype.setActive.call(this,e)},T.prototype.setMap=function(e){this.overlay_.setMap(e),E.default.prototype.setMap.call(this,e)},T.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},T.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},T.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},T.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}},T.prototype.handleFeatureRemove_=function(e){const t=e.element;this.removeFeature_(t)},T.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},T.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,a;for(r=0,o=i.length;r<o;++r)a={feature:e,geometry:t,depth:[r],index:r,segment:[n=i[r],n]},this.rBush_.insert(t.getExtent(),a)},T.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,a;for(n=0,r=i.length-1;n<r;++n)a={feature:e,geometry:t,index:n,segment:o=i.slice(n,n+2)},this.rBush_.insert(Object(_.boundingExtent)(o),a)},T.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,a,s,u,l;for(a=0,s=i.length;a<s;++a)for(r=0,o=(n=i[a]).length-1;r<o;++r)l={feature:e,geometry:t,depth:[a],index:r,segment:u=n.slice(r,r+2)},this.rBush_.insert(Object(_.boundingExtent)(u),l)},T.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,a,s,u,l;for(a=0,s=i.length;a<s;++a)for(r=0,o=(n=i[a]).length-1;r<o;++r)l={feature:e,geometry:t,depth:[a],index:r,segment:u=n.slice(r,r+2)},this.rBush_.insert(Object(_.boundingExtent)(u),l)},T.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,a,s,u,l,c,d,h;for(u=0,l=i.length;u<l;++u)for(a=0,s=(c=i[u]).length;a<s;++a)for(r=0,o=(n=c[a]).length-1;r<o;++r)h={feature:e,geometry:t,depth:[a,u],index:r,segment:d=n.slice(r,r+2)},this.rBush_.insert(Object(_.boundingExtent)(d),h)},T.prototype.writeCircleGeometry_=function(e,t){const i=t.getCenter(),n={feature:e,geometry:t,index:T.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX,segment:[i,i]},r={feature:e,geometry:t,index:T.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX,segment:[i,i]},o=[n,r];n.featureSegments=r.featureSegments=o,this.rBush_.insert(Object(_.createOrUpdateFromCoordinate)(i),n),this.rBush_.insert(t.getExtent(),r)},T.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t)this.SEGMENT_WRITERS_[i[t].getType()].call(this,e,i[t])},T.prototype.createOrUpdateVertexFeature_=function(e){let t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new a.default(new m.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t));return t},T.compareIndexes_=function(e,t){return e.index-t.index},T.handleDownEvent_=function(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);const t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;const i=this.vertexFeature_;if(i){const r=[],o=i.getGeometry().getCoordinates(),a=Object(_.boundingExtent)([o]),s=this.rBush_.getInExtent(a),u={};s.sort(T.compareIndexes_);for(let i=0,a=s.length;i<a;++i){const a=s[i],l=a.segment;let d=Object(n.getUid)(a.feature);const h=a.depth;if(h&&(d+="-"+h.join("-")),u[d]||(u[d]=new Array(2)),a.geometry.getType()===p.default.CIRCLE&&a.index===T.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const e=T.closestOnSegmentData_(t,a);c.default.equals(e,o)&&!u[d][0]&&(this.dragSegments_.push([a,0]),u[d][0]=a)}else if(c.default.equals(l[0],o)&&!u[d][0])this.dragSegments_.push([a,0]),u[d][0]=a;else if(c.default.equals(l[1],o)&&!u[d][1]){if((a.geometry.getType()===p.default.LINE_STRING||a.geometry.getType()===p.default.MULTI_LINE_STRING)&&u[d][0]&&0===u[d][0].index)continue;this.dragSegments_.push([a,1]),u[d][1]=a}else this.insertVertexCondition_(e)&&Object(n.getUid)(l)in this.vertexSegments_&&!u[d][0]&&!u[d][1]&&r.push([a,o])}r.length&&this.willModifyFeatures_(e);for(let e=r.length-1;e>=0;--e)this.insertVertex_.apply(this,r[e])}return!!this.vertexFeature_},T.handleDragEvent_=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);const t=e.coordinate;for(let e=0,i=this.dragSegments_.length;e<i;++e){const i=this.dragSegments_[e],n=i[0],r=n.depth,o=n.geometry;let a;const s=n.segment,u=i[1];for(;t.length<o.getStride();)t.push(s[u][t.length]);switch(o.getType()){case p.default.POINT:a=t,s[0]=s[1]=t;break;case p.default.MULTI_POINT:(a=o.getCoordinates())[n.index]=t,s[0]=s[1]=t;break;case p.default.LINE_STRING:(a=o.getCoordinates())[n.index+u]=t,s[u]=t;break;case p.default.MULTI_LINE_STRING:case p.default.POLYGON:(a=o.getCoordinates())[r[0]][n.index+u]=t,s[u]=t;break;case p.default.MULTI_POLYGON:(a=o.getCoordinates())[r[1]][r[0]][n.index+u]=t,s[u]=t;break;case p.default.CIRCLE:s[0]=s[1]=t,n.index===T.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX?(this.changingFeature_=!0,o.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,o.setRadius(c.default.distance(o.getCenter(),t)),this.changingFeature_=!1)}a&&this.setGeometryCoordinates_(o,a)}this.createOrUpdateVertexFeature_(t)},T.handleUpEvent_=function(e){let t,i;for(let e=this.dragSegments_.length-1;e>=0;--e)if((i=(t=this.dragSegments_[e][0]).geometry).getType()===p.default.CIRCLE){const e=i.getCenter(),n=t.featureSegments[0],r=t.featureSegments[1];n.segment[0]=n.segment[1]=e,r.segment[0]=r.segment[1]=e,this.rBush_.update(Object(_.createOrUpdateFromCoordinate)(e),n),this.rBush_.update(i.getExtent(),r)}else this.rBush_.update(Object(_.boundingExtent)(t.segment),t);return this.modified_&&(this.dispatchEvent(new T.Event(v,this.features_,e)),this.modified_=!1),!1},T.handleEvent=function(e){if(!(e instanceof u.default))return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=s.a.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=s.a.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==s.a.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),E.default.handleEvent.call(this,e)&&!t},T.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},T.prototype.handlePointerAtPixel_=function(e,t){const i=t.getCoordinateFromPixel(e),r=function(e,t){return T.pointDistanceToSegmentDataSquared_(i,e)-T.pointDistanceToSegmentDataSquared_(i,t)},o=Object(_.buffer)(Object(_.createOrUpdateFromCoordinate)(i),t.getView().getResolution()*this.pixelTolerance_),a=this.rBush_.getInExtent(o);if(a.length>0){a.sort(r);const o=a[0],s=o.segment;let u=T.closestOnSegmentData_(i,o);const l=t.getPixelFromCoordinate(u);let d=c.default.distance(e,l);if(d<=this.pixelTolerance_){const e={};if(o.geometry.getType()===p.default.CIRCLE&&o.index===T.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{const i=t.getPixelFromCoordinate(s[0]),r=t.getPixelFromCoordinate(s[1]),o=c.default.squaredDistance(l,i),h=c.default.squaredDistance(l,r);let f;d=Math.sqrt(Math.min(o,h)),this.snappedToVertex_=d<=this.pixelTolerance_,this.snappedToVertex_&&(u=o>h?s[1]:s[0]),this.createOrUpdateVertexFeature_(u);for(let t=1,i=a.length;t<i&&(f=a[t].segment,c.default.equals(s[0],f[0])&&c.default.equals(s[1],f[1])||c.default.equals(s[0],f[1])&&c.default.equals(s[1],f[0]));++t)e[Object(n.getUid)(f)]=!0}return e[Object(n.getUid)(s)]=!0,void(this.vertexSegments_=e)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},T.pointDistanceToSegmentDataSquared_=function(e,t){const i=t.geometry;if(i.getType()===p.default.CIRCLE){const n=i;if(t.index===T.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const t=c.default.squaredDistance(n.getCenter(),e),i=Math.sqrt(t)-n.getRadius();return i*i}}return c.default.squaredDistanceToSegment(e,t.segment)},T.closestOnSegmentData_=function(e,t){const i=t.geometry;return i.getType()===p.default.CIRCLE&&t.index===T.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX?i.getClosestPoint(e):c.default.closestOnSegment(e,t.segment)},T.prototype.insertVertex_=function(e,t){const i=e.segment,n=e.feature,r=e.geometry,o=e.depth,a=e.index;let s;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case p.default.MULTI_LINE_STRING:case p.default.POLYGON:(s=r.getCoordinates())[o[0]].splice(a+1,0,t);break;case p.default.MULTI_POLYGON:(s=r.getCoordinates())[o[1]][o[0]].splice(a+1,0,t);break;case p.default.LINE_STRING:(s=r.getCoordinates()).splice(a+1,0,t);break;default:return}this.setGeometryCoordinates_(r,s);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(r,a,o,1);const l={segment:[i[0],t],feature:n,geometry:r,depth:o,index:a};u.insert(Object(_.boundingExtent)(l.segment),l),this.dragSegments_.push([l,1]);const c={segment:[t,i[1]],feature:n,geometry:r,depth:o,index:a+1};u.insert(Object(_.boundingExtent)(c.segment),c),this.dragSegments_.push([c,0]),this.ignoreNextSingleClick_=!0},T.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=s.a.POINTERDRAG){const e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new T.Event(v,this.features_,e)),this.modified_=!1,!0}return!1},T.prototype.removeVertex_=function(){const e=this.dragSegments_,t={};let i,r,o,a,s,u,l,c,d,h,f,g=!1;for(s=e.length-1;s>=0;--s)h=(o=e[s])[0],f=Object(n.getUid)(h.feature),h.depth&&(f+="-"+h.depth.join("-")),f in t||(t[f]={}),0===o[1]?(t[f].right=h,t[f].index=h.index):1==o[1]&&(t[f].left=h,t[f].index=h.index+1);for(f in t){switch(d=t[f].right,l=t[f].left,c=(u=t[f].index)-1,h=void 0!==l?l:d,c<0&&(c=0),i=r=(a=h.geometry).getCoordinates(),g=!1,a.getType()){case p.default.MULTI_LINE_STRING:r[h.depth[0]].length>2&&(r[h.depth[0]].splice(u,1),g=!0);break;case p.default.LINE_STRING:r.length>2&&(r.splice(u,1),g=!0);break;case p.default.MULTI_POLYGON:i=i[h.depth[1]];case p.default.POLYGON:(i=i[h.depth[0]]).length>4&&(u==i.length-1&&(u=0),i.splice(u,1),g=!0,0===u&&(i.pop(),i.push(i[0]),c=i.length-1))}if(g){this.setGeometryCoordinates_(a,r);const t=[];if(void 0!==l&&(this.rBush_.remove(l),t.push(l.segment[0])),void 0!==d&&(this.rBush_.remove(d),t.push(d.segment[1])),void 0!==l&&void 0!==d){const e={depth:h.depth,feature:h.feature,geometry:h.geometry,index:c,segment:t};this.rBush_.insert(Object(_.boundingExtent)(e.segment),e)}this.updateSegmentIndices_(a,u,h.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return g},T.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},T.prototype.updateSegmentIndices_=function(e,t,i,n){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(void 0===i||void 0===r.depth||Object(l.equals)(r.depth,i))&&r.index>t&&(r.index+=n)})},T.getDefaultStyleFunction=function(){const e=F.default.createDefaultEditing();return function(t,i){return e[p.default.POINT]}},T.Event=function(e,t,i){h.default.call(this,e),this.features=t,this.mapBrowserEvent=i},Object(n.inherits)(T.Event,h.default);t.default=T},21:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),o=i(43),a=(n=o)&&n.__esModule?n:{default:n};var s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.default.call(this,e),this.detail=t};r.inherits(s,a.default),t.default=s},23:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(11),r=i(0),o=i(10),a=i(4),s=i(5),u=i(14),l=i(6),c=i(28),d=i(60),h=i(42),f=i(12),g=i(61),_=i(15),p=i(22);const m=function(e){const t=e||{},i=t.params||{},n=!("TRANSPARENT"in i)||i.TRANSPARENT;h.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:!n,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition}),this.gutter_=void 0!==t.gutter?t.gutter:0,this.params_=i,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=Object(a.createEmpty)(),this.updateV13_(),this.setKey(this.getKeyForParams_())};Object(r.inherits)(m,h.a),m.prototype.getGetFeatureInfoUrl=function(e,t,i,r){const o=Object(l.get)(i),u=this.getProjection();let h=this.getTileGrid();h||(h=this.getTileGridForProjection(o));const f=h.getTileCoordForCoordAndResolution(e,t);if(h.getResolutions().length<=f[0])return;let g=h.getResolution(f[0]),_=h.getTileCoordExtent(f,this.tmpExtent_),p=d.default.toSize(h.getTileSize(f[0]),this.tmpSize);const m=this.gutter_;0!==m&&(p=d.default.buffer(p,m,this.tmpSize),_=Object(a.buffer)(_,g*m,_)),u&&u!==o&&(g=c.a.calculateSourceResolution(u,o,e,g),_=Object(l.transformExtent)(_,o,u),e=Object(l.transform)(e,o,u));const y={SERVICE:"WMS",VERSION:n.a,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object(s.assign)(y,this.params_,r);const v=Math.floor((e[0]-_[0])/g),E=Math.floor((_[3]-e[1])/g);return y[this.v13_?"I":"X"]=v,y[this.v13_?"J":"Y"]=E,this.getRequestUrl_(f,p,_,1,u||o,y)},m.prototype.getGutterInternal=function(){return this.gutter_},m.prototype.getParams=function(){return this.params_},m.prototype.getRequestUrl_=function(e,t,i,n,r,a){const s=this.urls;if(!s)return;if(a.WIDTH=t[0],a.HEIGHT=t[1],a[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(a.STYLES=""),1!=n)switch(this.serverType_){case f.a.GEOSERVER:const e=90*n+.5|0;"FORMAT_OPTIONS"in a?a.FORMAT_OPTIONS+=";dpi:"+e:a.FORMAT_OPTIONS="dpi:"+e;break;case f.a.MAPSERVER:a.MAP_RESOLUTION=90*n;break;case f.a.CARMENTA_SERVER:case f.a.QGIS:a.DPI=90*n;break;default:Object(o.a)(!1,52)}const l=r.getAxisOrientation(),c=i;let d,h;this.v13_&&"ne"==l.substr(0,2)&&(d=i[0],c[0]=i[1],c[1]=d,d=i[2],c[2]=i[3],c[3]=d);(a.BBOX=c.join(","),1==s.length)?h=s[0]:h=s[Object(u.modulo)(g.a.hash(e),s.length)];return Object(p.appendParams)(h,a)},m.prototype.getTilePixelRatio=function(e){return this.hidpi_&&void 0!==this.serverType_?e:1},m.prototype.getKeyForParams_=function(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")},m.prototype.fixedTileUrlFunction=function(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;1==t||this.hidpi_&&void 0!==this.serverType_||(t=1);const o=r.getResolution(e[0]);let u=r.getTileCoordExtent(e,this.tmpExtent_),l=d.default.toSize(r.getTileSize(e[0]),this.tmpSize);const c=this.gutter_;0!==c&&(l=d.default.buffer(l,c,this.tmpSize),u=Object(a.buffer)(u,o*c,u)),1!=t&&(l=d.default.scale(l,t,this.tmpSize));const h={SERVICE:"WMS",VERSION:n.a,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return Object(s.assign)(h,this.params_),this.getRequestUrl_(e,l,u,t,i,h)},m.prototype.updateParams=function(e){Object(s.assign)(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())},m.prototype.updateV13_=function(){const e=this.params_.VERSION||n.a;this.v13_=_.default.compareVersions(e,"1.3")>=0},t.default=m},24:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(1)),r=o(i(47));function o(e){return e&&e.__esModule?e:{default:e}}var a={};a.module=angular.module("ngeoDataSources",[]),a.module.value("ngeoDataSources",new r.default),n.default.module.requires.push(a.module.name),t.default=a},26:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(1);(n=o)&&n.__esModule;var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inRange_=!1!==t.inRange,this.visible_=!0===t.visible,this.attributes=t.attributes||null,this.id_=t.id,this.identifierAttribute_=t.identifierAttribute,this.maxResolution_=t.maxResolution,this.minResolution_=t.minResolution,this.name_=t.name}return r(e,[{key:"getAttributes",value:function(){return this.attributes}},{key:"setAttributes",value:function(e){this.attributes=e}},{key:"inRange",get:function(){return this.inRange_},set:function(e){this.inRange_=e}},{key:"visible",get:function(){return this.visible_},set:function(e){this.visible_=e}},{key:"id",get:function(){return this.id_}},{key:"identifierAttribute",get:function(){return this.identifierAttribute_}},{key:"maxResolution",get:function(){return this.maxResolution_}},{key:"minResolution",get:function(){return this.minResolution_}},{key:"name",get:function(){return this.name_}},{key:"queryable",get:function(){return!1}},{key:"supportsDynamicInRange",get:function(){return null!==this.maxResolution||null!==this.minResolution}}]),e}();t.default=a},29:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(1)),r=d(i(0)),o=h(i(20)),a=d(i(5)),s=h(i(18)),u=h(i(17)),l=h(i(3)),c=h(i(36));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function h(e){return e&&e.__esModule?e:{default:e}}var f=function(){this.featureUidToGroupIndex_={},this.groups_=[],this.source_=new s.default({useSpatialIndex:!1}),this.layer_=new o.default({source:this.source_,style:this.styleFunction_.bind(this),updateWhileAnimating:!0,updateWhileInteracting:!0})};f.prototype.addFeature=function(e,t){l.default.assert(t>=0),l.default.assert(t<this.groups_.length);var i=r.getUid(e).toString();this.featureUidToGroupIndex_[i]=t,this.groups_[t].features[i]=e,this.source_.addFeature(e)},f.prototype.removeFeature=function(e,t){l.default.assert(t>=0),l.default.assert(t<this.groups_.length);var i=r.getUid(e).toString();delete this.featureUidToGroupIndex_[i],delete this.groups_[t].features[i],this.source_.removeFeature(e)},f.prototype.clear=function(e){l.default.assert(e>=0),l.default.assert(e<this.groups_.length);var t=this.groups_[e];for(var i in t.features)this.removeFeature(t.features[i],e);l.default.assert(a.isEmpty(t.features))},f.prototype.getLayer=function(){return this.layer_},f.prototype.getFeatureOverlay=function(){var e=this.groups_.length;return this.groups_.push({styleFunction:u.default.defaultFunction,features:{}}),new c.default(this,e)},f.prototype.init=function(e){this.layer_.setMap(e)},f.prototype.setStyle=function(e,t){l.default.assert(t>=0),l.default.assert(t<this.groups_.length),this.groups_[t].styleFunction=null===e?u.default.defaultFunction:u.default.createFunction(e)},f.prototype.styleFunction_=function(e,t){var i=r.getUid(e).toString();l.default.assert(i in this.featureUidToGroupIndex_);var n=this.featureUidToGroupIndex_[i];return this.groups_[n].styleFunction(e,t)},(f.module=angular.module("ngeoFeatureOverlayMgr",[c.default.module.name])).service("ngeoFeatureOverlayMgr",f),n.default.module.requires.push(f.module.name),t.default=f},3:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r={doAssertFailure_:function(e,t,i,n){var o="Assertion failed",a=void 0;i?(o+=": "+i,a=n):e&&(o+=": "+e,a=t);var s=new r.AssertionError(""+o,a||[]);r.errorHandler_(s)},setErrorHandler:function(e){r.ENABLE_ASSERTS&&(r.errorHandler_=e)},assert:function(e,t,i){return r.ENABLE_ASSERTS&&!e&&r.doAssertFailure_("",null,t,Array.prototype.slice.call(arguments,2)),e},fail:function(e,t){r.ENABLE_ASSERTS&&r.errorHandler_(new r.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1)))},assertNumber:function(e,t,i){return r.ENABLE_ASSERTS&&!goog.isNumber(e)&&r.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertString:function(e,t,i){return r.ENABLE_ASSERTS&&!goog.isString(e)&&r.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertFunction:function(e,t,i){return r.ENABLE_ASSERTS&&!goog.isFunction(e)&&r.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertObject:function(e,t,i){return r.ENABLE_ASSERTS&&!goog.isObject(e)&&r.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertArray:function(e,t,i){return r.ENABLE_ASSERTS&&!goog.isArray(e)&&r.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertBoolean:function(e,t,i){return r.ENABLE_ASSERTS&&!goog.isBoolean(e)&&r.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertElement:function(e,t,i){return!r.ENABLE_ASSERTS||goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT||r.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},assertInstanceof:function(e,t,i,n){return!r.ENABLE_ASSERTS||e instanceof t||r.doAssertFailure_("Expected instanceof %s but got %s.",[r.getType_(t),r.getType_(e)],i,Array.prototype.slice.call(arguments,3)),e},assertObjectPrototypeIsIntact:function(){for(var e in Object.prototype)r.fail(e+" should not be enumerable in Object.prototype.")},getType_:function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":void 0===e?"undefined":n(e)}};t.default=r},32:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(1)),r=c(i(33)),o=c(i(34)),a=c(i(29)),s=c(i(37)),u=c(i(38)),l=c(i(39));function c(e){return e&&e.__esModule?e:{default:e}}var d=angular.module("ngeoMapModule",[n.default.module.name,r.default.module.name,o.default.name,a.default.module.name,s.default.name,u.default.name,l.default.name]);t.default=d},33:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i(3)),r=f(i(1)),o=f(i(21)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),s=f(i(19)),u=f(i(52)),l=f(i(50)),c=f(i(16)),d=f(i(23)),h=f(i(58));function f(e){return e&&e.__esModule?e:{default:e}}var g=function(){s.default.call(this),this.mapUids_={}};a.inherits(g,s.default),g.prototype.get=function(e){return a.getUid(e).toString()in this.mapUids_?e.getLayers().item(0):null},g.prototype.set=function(e,t){var i=a.getUid(e).toString(),r=this.get(e);null!==r?(n.default.assert(i in this.mapUids_),null!==t?e.getLayers().setAt(0,t):(e.getLayers().removeAt(0),delete this.mapUids_[i])):null!==t&&(e.getLayers().insertAt(0,t),this.mapUids_[i]=!0);var s=new o.default("change",{current:t,previous:r});return this.dispatchEvent(s),r},g.prototype.updateDimensions=function(e,t){var i=this.get(e);if(i){var r=[i];i instanceof u.default&&(r=i.getLayers().getArray()),r.forEach(function(e){if(n.default.assertInstanceof(e,l.default),e){var i=!1,r={};for(var o in e.get("dimensions")){var a=t[o];void 0!==a&&(r[o]=a,i=!0)}if(i){var s=e.getSource();s instanceof h.default?(s.updateDimensions(r),s.refresh()):(s instanceof d.default||s instanceof c.default)&&(s.updateParams(r),s.refresh())}}})}},(g.module=angular.module("ngeoBackgroundLayerMgr",[])).service("ngeoBackgroundLayerMgr",g),r.default.module.requires.push(g.module.name),t.default=g},34:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(i(3)),r=u(i(1)),o=u(i(35)),a=u(i(2)),s=u(i(7));function u(e){return e&&e.__esModule?e:{default:e}}var l=angular.module("ngeoMap",[o.default.module.name]);r.default.module.requires.push(l.name),l.directive_=function(e,t){return{restrict:"A",link:function(i,r,o){var u=o.ngeoMap,l=i.$eval(u);n.default.assertInstanceof(l,s.default),l.setTarget(r[0]),t.map=l;var c=o.ngeoMapManageResize;if(i.$eval(c)){var d=o.ngeoMapResizeTransition,h=i.$eval(d);a.default.listen(e,"resize",function(){if(h){var t=Date.now(),i=!0;!function n(){l.updateSize(),l.renderSync(),i&&e.requestAnimationFrame(n),Date.now()-t>h&&(i=!1)}()}else l.updateSize()})}}}},l.directive_.$inject=["$window","ngeoSyncDataSourcesMap"],l.directive("ngeoMap",l.directive_),t.default=l},35:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=d(i(1)),o=d(i(26)),a=d(i(24)),s=d(i(2)),u=d(i(19)),l=d(i(31)),c=d(i(3));function d(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ngeoDataSources_=t,this.map_=null,this.listenerKeys_=[],s.default.listen(this.ngeoDataSources_,"add",this.handleDataSourcesAdd_,this)}return e.$inject=["ngeoDataSources"],n(e,[{key:"bindMap_",value:function(e){var t=e.getView();this.listenerKeys_.push(s.default.listen(t,"change:resolution",this.handleViewResolutionChange_,this));var i=t.getResolution();c.default.assertNumber(i),this.syncDataSourcesToResolution_(i)}},{key:"unbindMap_",value:function(e){u.default.unByKey(this.listenerKeys_),this.listenerKeys_=[]}},{key:"handleViewResolutionChange_",value:function(e){var t=e.target;c.default.assertInstanceof(t,l.default);var i=t.getResolution();c.default.assertNumber(i),this.syncDataSourcesToResolution_(i)}},{key:"syncDataSourcesToResolution_",value:function(e){var t=this;this.ngeoDataSources_.forEach(function(i){t.syncDataSourceToResolution_(i,e)})}},{key:"syncDataSourceToResolution_",value:function(e,t){if(e.supportsDynamicInRange){var i=e.maxResolution,n=e.minResolution,r=(null===n||void 0===n||t>=n)&&(null===i||void 0===i||t<=i);e.inRange=r}}},{key:"handleDataSourcesAdd_",value:function(e){var t=c.default.assertInstanceof(e.element,o.default);if(this.map_){var i=this.map_.getView().getResolution();c.default.assertNumber(i),this.syncDataSourceToResolution_(t,i)}}},{key:"map",set:function(e){this.map_&&this.unbindMap_(this.map_),this.map_=e,e&&this.bindMap_(e)}}]),e}();h.module=angular.module("ngeoSyncDataSourcesMap",[a.default.module.name]),h.module.service("ngeoSyncDataSourcesMap",h),r.default.module.requires.push(h.module.name),t.default=h},36:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(1)),r=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);t.default=e}(i(0)),o(i(2)));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e,t){this.manager_=e,this.features_=null,this.index_=t};a.prototype.addFeature=function(e){this.manager_.addFeature(e,this.index_)},a.prototype.removeFeature=function(e){this.manager_.removeFeature(e,this.index_)},a.prototype.clear=function(){this.manager_.clear(this.index_)},a.prototype.setFeatures=function(e){null!==this.features_&&(this.features_.clear(),r.default.unlisten(this.features_,"add",this.handleFeatureAdd_,this),r.default.unlisten(this.features_,"remove",this.handleFeatureRemove_,this)),null!==e&&(e.forEach(function(e){this.addFeature(e)},this),r.default.listen(e,"add",this.handleFeatureAdd_,this),r.default.listen(e,"remove",this.handleFeatureRemove_,this)),this.features_=e},a.prototype.setStyle=function(e){this.manager_.setStyle(e,this.index_)},a.prototype.handleFeatureAdd_=function(e){var t=e.element;this.addFeature(t)},a.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature(t)},a.module=angular.module("ngeoFeatureOverlay",[]),n.default.module.requires.push(a.module.name),t.default=a},37:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=i(1),o=(n=r)&&n.__esModule?n:{default:n};var a=angular.module("ngeoRecenter",[]);o.default.module.requires.push(a.name),a.directive_=function(){return{restrict:"A",link:function(e,t,i){var n=i.ngeoRecenterMap,r=e.$eval(n);function o(t){var i=t.attr("ngeo-extent");if(void 0!==i){var n=r.getSize();r.getView().fit(e.$eval(i),{size:n})}var o=t.attr("ngeo-zoom");void 0!==o&&r.getView().setZoom(e.$eval(o))}t.on("click","*",function(e){o(angular.element($(this)))}),t.on("change",function(e){var t=e.target.options[e.target.selectedIndex];o(angular.element(t))})}}},a.directive("ngeoRecenter",a.directive_),t.default=a},372:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(373),i(59);var n=y(i(374)),r=y(i(7)),o=y(i(31)),a=y(i(62)),s=y(i(20)),u=y(i(48)),l=y(i(18)),c=y(i(41)),d=y(i(47)),h=y(i(40)),f=y(i(17)),g=y(i(109)),_=y(i(65)),p=y(i(79)),m=y(i(32));function y(e){return e&&e.__esModule?e:{default:e}}var v=angular.module("app",[ngeo.module.name,m.default.name]);app.MainController=function(){this.map=new r.default({layers:[new a.default({source:new u.default})],view:new o.default({center:[-10997148,4569099],zoom:4})});var e=this.map,t=new c.default([[[-9e6,4e6],[-11e6,4e6],[-11e6,6e6],[-9e6,6e6]]]);this.features=new d.default,this.features.push(new h.default({geometry:t,isRectangle:!0}));var i,m=((i={}).Polygon=[new f.default({fill:new _.default({color:[255,255,255,.5]})}),new f.default({stroke:new p.default({color:[255,255,255,1],width:5})}),new f.default({stroke:new p.default({color:[0,153,255,1],width:3})})],i.Point=[new f.default({image:new g.default({radius:7,fill:new _.default({color:[0,153,255,1]}),stroke:new p.default({color:[255,255,255,.75],width:1.5})}),zIndex:1e5})],i.GeometryCollection=i.Polygon.concat(i.Point),function(e,t){return i[e.getGeometry().getType()]}),y=new l.default({features:this.features});new s.default({source:y}).setMap(e),this.interaction=new n.default({features:this.features,style:m});var v=this.interaction;e.addInteraction(v),v.setActive(!0)},v.controller("MainController",app.MainController),t.default={}},373:function(e,t){},374:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i(3)),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(0)),o=(f(i(47)),f(i(40))),a=(f(i(90)),f(i(2))),s=f(i(27)),u=f(i(41)),l=f(i(181)),c=f(i(78)),d=f(i(20)),h=f(i(18));function f(e){return e&&e.__esModule?e:{default:e}}var g=function(e){n.default.assert(e.features),c.default.call(this,{handleDownEvent:this.handleDown_,handleDragEvent:this.handleDrag_,handleUpEvent:this.handleUp_}),this.modified_=!1;var t=e.style?e.style:l.default.getDefaultStyleFunction();this.vectorPoints_=new d.default({source:new h.default({wrapX:!!e.wrapX}),visible:this.getActive(),style:t,updateWhileAnimating:!0,updateWhileInteracting:!0}),this.features_=e.features,this.feature_=null,this.cache_={},this.params_=null,a.default.listen(this.features_,"add",this.handleFeatureAdd_,this),a.default.listen(this.features_,"remove",this.handleFeatureRemove_,this),this.features_.forEach(this.addFeature_,this)};r.inherits(g,c.default),g.prototype.setActive=function(e){c.default.prototype.setActive.call(this,e),this.vectorPoints_&&this.vectorPoints_.setVisible(e)},g.prototype.addFeature_=function(e){var t=e.getGeometry();if(t instanceof u.default){var i=r.getUid(e),n=this.cache_[i];if(n)return;for(var a=this.vectorPoints_.getSource(),l=t.getCoordinates()[0];l.length>4;)l[0][0]<l[1][0]&&l[0][1]<=l[1][1]?l.pop():l.shift();var c=[],d=void 0,h=void 0;l.forEach(function(t){d=new s.default(t),h=new o.default({corner:!0,geometry:d,siblingX:null,siblingY:null,boxFeature:e}),c.push(h)},this),n={corners:c},this.cache_[i]=n;var f=void 0,g=void 0;c.forEach(function(e,t){(f=c[t-1])||(f=c[c.length-1]),(g=c[t+1])||(g=c[0]),t%2==0?(e.set("siblingX",g),e.set("siblingY",f)):(e.set("siblingX",f),e.set("siblingY",g))},this),a.addFeatures(c)}},g.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new l.default.Event("modifystart",this.features_,e)),this.params_=this.initializeParams_())},g.prototype.initializeParams_=function(){var e=this.feature_.get("siblingX");n.default.assertInstanceof(e,o.default);var t=e.get("siblingY");n.default.assertInstanceof(t,o.default);var i=t.getGeometry();n.default.assertInstanceof(i,s.default);var r=i.getCoordinates(),a=this.getMap().getPixelFromCoordinate(r),u=t.get("siblingX");n.default.assertInstanceof(u,o.default);var l=u.getGeometry();n.default.assertInstanceof(l,s.default);var c=l.getCoordinates(),d=this.getMap().getPixelFromCoordinate(c),h=[d[0]-a[0],d[1]-a[1]],f=Math.sqrt(h[0]*h[0]+h[1]*h[1]);h[0]/=f,h[1]/=f;var g=e.getGeometry();n.default.assertInstanceof(g,s.default);var _=g.getCoordinates(),p=this.getMap().getPixelFromCoordinate(_),m=[p[0]-a[0],p[1]-a[1]],y=Math.sqrt(m[0]*m[0]+m[1]*m[1]);return m[0]/=y,m[1]/=y,isNaN(h[0])&&isNaN(m[0])?(h=[0,1],m=[1,0]):isNaN(h[0])?h=[m[1],-m[0]]:isNaN(m[0])&&(m=[h[1],-h[0]]),{originCoordinate:r,originPixel:a,siblingXPoint:l,siblingYPoint:g,vectorX:h,vectorY:m}},g.prototype.removeFeature_=function(e){for(var t=r.getUid(e),i=this.cache_[t].corners,n=0;n<i.length;n++)this.vectorPoints_.getSource().removeFeature(i[n]);this.feature_=null,i.length=0,delete this.cache_[t]},g.prototype.setMap=function(e){this.vectorPoints_.setMap(e),c.default.prototype.setMap.call(this,e)},g.prototype.handleFeatureAdd_=function(e){var t=e.element;n.default.assertInstanceof(t,o.default,"feature should be an ol.Feature"),this.addFeature_(t)},g.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},g.prototype.handleDown_=function(e){var t=e.map.forEachFeatureAtPixel(e.pixel,function(e){return e.get("siblingX")&&e.get("siblingY")?e:void 0});return!!t&&(this.feature_=t,!0)},g.prototype.handleDrag_=function(e){this.willModifyFeatures_(e);var t=this.feature_,i=t.getGeometry();if(i instanceof s.default){i.setCoordinates(e.coordinate);var r=e.pixel,o=this.params_.originPixel,a=this.params_.siblingXPoint,l=this.params_.siblingYPoint,c=this.params_.vectorX,d=this.params_.vectorY,h=this.params_.originCoordinate,f=this.calculateNewPixel_(o,r,c),g=this.getMap().getCoordinateFromPixel(f);a.setCoordinates(g);var _=this.calculateNewPixel_(o,r,d),p=this.getMap().getCoordinateFromPixel(_);l.setCoordinates(p);var m=t.get("boxFeature").getGeometry();n.default.assertInstanceof(m,u.default),m.setCoordinates([[e.coordinate,g,h,p,e.coordinate]])}},g.prototype.calculateNewPixel_=function(e,t,i){var n=[t[0]-e[0],t[1]-e[1]],r=n[0]*i[0]+n[1]*i[1],o=[i[0]*r,i[1]*r];return[o[0]+e[0],o[1]+e[1]]},g.prototype.handleUp_=function(e){return this.modified_&&(this.dispatchEvent(new l.default.Event("modifyend",this.features_,e)),this.params_=null,this.modified_=!1),!1},t.default=g},38:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i(3)),r=a(i(1)),o=a(i(7));function a(e){return e&&e.__esModule?e:{default:e}}var s=angular.module("ngeoResizemap",[]);r.default.module.requires.push(s.name),s.directive_=function(e){return{restrict:"A",link:function(t,i,r){var a=r.ngeoResizemap,s=t.$eval(a);n.default.assertInstanceof(s,o.default);var u=r.ngeoResizemapState;n.default.assert(void 0!==u);var l=void 0,c=void 0,d=function t(){s.updateSize(),s.renderSync(),Date.now()-l<1e3&&(c=e.requestAnimationFrame(t))};i.on("transitionend",function(){s.updateSize(),s.renderSync()}),t.$watch(u,function(t,i){t!=i&&(l=Date.now(),e.cancelAnimationFrame(c),c=e.requestAnimationFrame(d))})}}},s.directive("ngeoResizemap",s.directive_),t.default=s},39:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(1)),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(8)),o=s(i(7)),a=s(i(2));function s(e){return e&&e.__esModule?e:{default:e}}var u=angular.module("ngeoScaleselector",[]);n.default.module.requires.push(u.name),u.value("ngeoScaleselectorTemplateUrl",function(e,t){var i=t.ngeoScaleselectorTemplateurl;return void 0!==i?i:n.default.baseModuleTemplateUrl+"/map/scaleselector.html"}),u.directive_=function(e){return{restrict:"A",scope:!0,controller:"NgeoScaleselectorController",templateUrl:e}},u.directive("ngeoScaleselector",u.directive_),u.ScaleselectorController_=function(e,t,i){var n=this,s=i.ngeoScaleselector;this.scales=e.$eval(s),goog.asserts.assert(void 0!==this.scales),this.zoomLevels,e.$watch(function(){return Object.keys(n.scales).length},function(e){n.zoomLevels=Object.keys(n.scales).map(Number),n.zoomLevels.sort(r.numberSafeCompareFunction)});var l=i.ngeoScaleselectorMap;this.map_=e.$eval(l),goog.asserts.assertInstanceof(this.map_,o.default);var c=i.ngeoScaleselectorOptions,d=e.$eval(c);if(this.options=u.ScaleselectorController_.getOptions_(d),this.$scope_=e,this.resolutionChangeKey_=null,this.currentScale=void 0,null!==this.map_.getView()){var h=this.map_.getView().getZoom();void 0!==h&&(this.currentScale=this.getScale(h))}a.default.listen(this.map_,"change:view",this.handleViewChange_,this),this.registerResolutionChangeListener_(),e.scaleselectorCtrl=this},u.ScaleselectorController_.getOptions_=function(e){var t=!1;return void 0!==e&&(t=1==e.dropup),{dropup:t}},u.ScaleselectorController_.prototype.getScale=function(e){return this.scales[e]},u.ScaleselectorController_.prototype.changeZoom=function(e){this.map_.getView().setZoom(e)},u.ScaleselectorController_.prototype.handleResolutionChange_=function(e){var t=this,i=this.map_.getView(),n=this.scales[i.getZoom()];void 0!==n&&this.$scope_.$applyAsync(function(){t.currentScale=n})},u.ScaleselectorController_.prototype.handleViewChange_=function(e){this.registerResolutionChangeListener_(),this.handleResolutionChange_(null)},u.ScaleselectorController_.prototype.registerResolutionChangeListener_=function(){null!==this.resolutionChangeKey_&&a.default.unlistenByKey(this.resolutionChangeKey_);var e=this.map_.getView();this.resolutionChangeKey_=a.default.listen(e,"change:resolution",this.handleResolutionChange_,this)},u.controller("NgeoScaleselectorController",u.ScaleselectorController_),t.default=u},48:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(49);const o=function(e){const t=e||{};let i;i=void 0!==t.attributions?t.attributions:[o.ATTRIBUTION];const n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",a=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";r.a.call(this,{attributions:i,cacheSize:t.cacheSize,crossOrigin:n,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:a,wrapX:t.wrapX})};Object(n.inherits)(o,r.a),o.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',t.default=o},49:function(e,t,i){"use strict";var n=i(0),r=i(42),o=i(71);const a=function(e){const t=e||{},i=void 0!==t.projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:o.a.createXYZ({extent:o.a.extentFromProjection(i),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});r.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:i,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(n.inherits)(a,r.a),t.a=a}},[372]);
//# sourceMappingURL=modifyrectangle.min.js.map