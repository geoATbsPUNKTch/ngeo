webpackJsonp([12],{150:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(37),o=i(101),s=i(18),a=i(68),u=i(102),l=i(7),h=i(60),d=i(2),c=i(35),g=i(10),_=i(47),f=i(1),p=i(24),m=i(25),y={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},v=i(48),E=i(28),x=i(23),C=i(159),F=i(113),S=i(21);const I=function(e){let t;if(v.default.call(this,{handleDownEvent:T,handleDragEvent:M,handleEvent:b,handleUpEvent:w}),this.condition_=e.condition?e.condition:_.primaryAction,this.defaultDeleteCondition_=function(e){return Object(_.altKeyOnly)(e)&&Object(_.singleClick)(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:_.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new F.default,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new E.default({source:new x.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:I.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,t=new r.default(this.source_.getFeatures()),Object(d.listen)(this.source_,C.a.ADDFEATURE,this.handleSourceAdd_,this),Object(d.listen)(this.source_,C.a.REMOVEFEATURE,this.handleSourceRemove_,this)):t=e.features,!t)throw new Error("The modify interaction requires features or a source");this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),Object(d.listen)(this.features_,o.a.ADD,this.handleFeatureAdd_,this),Object(d.listen)(this.features_,o.a.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null};function O(e,t){return e.index-t.index}function T(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);const t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;const i=this.vertexFeature_;if(i){const r=[],o=i.getGeometry().getCoordinates(),s=Object(f.boundingExtent)([o]),a=this.rBush_.getInExtent(s),u={};a.sort(O);for(let i=0,s=a.length;i<s;++i){const s=a[i],l=s.segment;let d=Object(n.getUid)(s.feature);const c=s.depth;if(c&&(d+="-"+c.join("-")),u[d]||(u[d]=new Array(2)),s.geometry.getType()===p.a.CIRCLE&&s.index===I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const e=G(t,s);Object(h.equals)(e,o)&&!u[d][0]&&(this.dragSegments_.push([s,0]),u[d][0]=s)}else if(Object(h.equals)(l[0],o)&&!u[d][0])this.dragSegments_.push([s,0]),u[d][0]=s;else if(Object(h.equals)(l[1],o)&&!u[d][1]){if((s.geometry.getType()===p.a.LINE_STRING||s.geometry.getType()===p.a.MULTI_LINE_STRING)&&u[d][0]&&0===u[d][0].index)continue;this.dragSegments_.push([s,1]),u[d][1]=s}else this.insertVertexCondition_(e)&&Object(n.getUid)(l)in this.vertexSegments_&&!u[d][0]&&!u[d][1]&&r.push([s,o])}r.length&&this.willModifyFeatures_(e);for(let e=r.length-1;e>=0;--e)this.insertVertex_.apply(this,r[e])}return!!this.vertexFeature_}function M(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);const t=e.coordinate;for(let e=0,i=this.dragSegments_.length;e<i;++e){const i=this.dragSegments_[e],n=i[0],r=n.depth,o=n.geometry;let s;const a=n.segment,u=i[1];for(;t.length<o.getStride();)t.push(a[u][t.length]);switch(o.getType()){case p.a.POINT:s=t,a[0]=a[1]=t;break;case p.a.MULTI_POINT:(s=o.getCoordinates())[n.index]=t,a[0]=a[1]=t;break;case p.a.LINE_STRING:(s=o.getCoordinates())[n.index+u]=t,a[u]=t;break;case p.a.MULTI_LINE_STRING:case p.a.POLYGON:(s=o.getCoordinates())[r[0]][n.index+u]=t,a[u]=t;break;case p.a.MULTI_POLYGON:(s=o.getCoordinates())[r[1]][r[0]][n.index+u]=t,a[u]=t;break;case p.a.CIRCLE:a[0]=a[1]=t,n.index===I.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX?(this.changingFeature_=!0,o.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,o.setRadius(Object(h.distance)(o.getCenter(),t)),this.changingFeature_=!1)}s&&this.setGeometryCoordinates_(o,s)}this.createOrUpdateVertexFeature_(t)}function w(e){let t,i;for(let e=this.dragSegments_.length-1;e>=0;--e)if((i=(t=this.dragSegments_[e][0]).geometry).getType()===p.a.CIRCLE){const e=i.getCenter(),n=t.featureSegments[0],r=t.featureSegments[1];n.segment[0]=n.segment[1]=e,r.segment[0]=r.segment[1]=e,this.rBush_.update(Object(f.createOrUpdateFromCoordinate)(e),n),this.rBush_.update(i.getExtent(),r)}else this.rBush_.update(Object(f.boundingExtent)(t.segment),t);return this.modified_&&(this.dispatchEvent(new I.Event(y.MODIFYEND,this.features_,e)),this.modified_=!1),!1}function b(e){if(!(e instanceof u.default))return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=a.a.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=a.a.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==a.a.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),v.handleEvent.call(this,e)&&!t}function P(e,t){const i=t.geometry;if(i.getType()===p.a.CIRCLE){const n=i;if(t.index===I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const t=Object(h.squaredDistance)(n.getCenter(),e),i=Math.sqrt(t)-n.getRadius();return i*i}}return Object(h.squaredDistanceToSegment)(e,t.segment)}function G(e,t){const i=t.geometry;return i.getType()===p.a.CIRCLE&&t.index===I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX?i.getClosestPoint(e):Object(h.closestOnSegment)(e,t.segment)}Object(n.inherits)(I,v.default),I.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX=0,I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX=1,I.prototype.addFeature_=function(e){const t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),Object(d.listen)(e,g.a.CHANGE,this.handleFeatureChange_,this)},I.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new I.Event(y.MODIFYSTART,this.features_,e)))},I.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),Object(d.unlisten)(e,g.a.CHANGE,this.handleFeatureChange_,this)},I.prototype.removeFeatureSegmentData_=function(e){const t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])},I.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),v.default.prototype.setActive.call(this,e)},I.prototype.setMap=function(e){this.overlay_.setMap(e),v.default.prototype.setMap.call(this,e)},I.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},I.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},I.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},I.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}},I.prototype.handleFeatureRemove_=function(e){const t=e.element;this.removeFeature_(t)},I.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},I.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s;for(r=0,o=i.length;r<o;++r)s={feature:e,geometry:t,depth:[r],index:r,segment:[n=i[r],n]},this.rBush_.insert(t.getExtent(),s)},I.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s;for(n=0,r=i.length-1;n<r;++n)s={feature:e,geometry:t,index:n,segment:o=i.slice(n,n+2)},this.rBush_.insert(Object(f.boundingExtent)(o),s)},I.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,u,l;for(s=0,a=i.length;s<a;++s)for(r=0,o=(n=i[s]).length-1;r<o;++r)l={feature:e,geometry:t,depth:[s],index:r,segment:u=n.slice(r,r+2)},this.rBush_.insert(Object(f.boundingExtent)(u),l)},I.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,u,l;for(s=0,a=i.length;s<a;++s)for(r=0,o=(n=i[s]).length-1;r<o;++r)l={feature:e,geometry:t,depth:[s],index:r,segment:u=n.slice(r,r+2)},this.rBush_.insert(Object(f.boundingExtent)(u),l)},I.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,u,l,h,d,c;for(u=0,l=i.length;u<l;++u)for(s=0,a=(h=i[u]).length;s<a;++s)for(r=0,o=(n=h[s]).length-1;r<o;++r)c={feature:e,geometry:t,depth:[s,u],index:r,segment:d=n.slice(r,r+2)},this.rBush_.insert(Object(f.boundingExtent)(d),c)},I.prototype.writeCircleGeometry_=function(e,t){const i=t.getCenter(),n={feature:e,geometry:t,index:I.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX,segment:[i,i]},r={feature:e,geometry:t,index:I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX,segment:[i,i]},o=[n,r];n.featureSegments=r.featureSegments=o,this.rBush_.insert(Object(f.createOrUpdateFromCoordinate)(i),n),this.rBush_.insert(t.getExtent(),r)},I.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t)this.SEGMENT_WRITERS_[i[t].getType()].call(this,e,i[t])},I.prototype.createOrUpdateVertexFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new s.default(new m.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t);return t},I.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},I.prototype.handlePointerAtPixel_=function(e,t){const i=t.getCoordinateFromPixel(e),r=function(e,t){return P(i,e)-P(i,t)},o=Object(f.buffer)(Object(f.createOrUpdateFromCoordinate)(i),t.getView().getResolution()*this.pixelTolerance_),s=this.rBush_.getInExtent(o);if(s.length>0){s.sort(r);const o=s[0],a=o.segment;let u=G(i,o);const l=t.getPixelFromCoordinate(u);let d=Object(h.distance)(e,l);if(d<=this.pixelTolerance_){const e={};if(o.geometry.getType()===p.a.CIRCLE&&o.index===I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{const i=t.getPixelFromCoordinate(a[0]),r=t.getPixelFromCoordinate(a[1]),o=Object(h.squaredDistance)(l,i),c=Object(h.squaredDistance)(l,r);let g;d=Math.sqrt(Math.min(o,c)),this.snappedToVertex_=d<=this.pixelTolerance_,this.snappedToVertex_&&(u=o>c?a[1]:a[0]),this.createOrUpdateVertexFeature_(u);for(let t=1,i=s.length;t<i&&(g=s[t].segment,Object(h.equals)(a[0],g[0])&&Object(h.equals)(a[1],g[1])||Object(h.equals)(a[0],g[1])&&Object(h.equals)(a[1],g[0]));++t)e[Object(n.getUid)(g)]=!0}return e[Object(n.getUid)(a)]=!0,void(this.vertexSegments_=e)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},I.prototype.insertVertex_=function(e,t){const i=e.segment,n=e.feature,r=e.geometry,o=e.depth,s=e.index;let a;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case p.a.MULTI_LINE_STRING:case p.a.POLYGON:(a=r.getCoordinates())[o[0]].splice(s+1,0,t);break;case p.a.MULTI_POLYGON:(a=r.getCoordinates())[o[1]][o[0]].splice(s+1,0,t);break;case p.a.LINE_STRING:(a=r.getCoordinates()).splice(s+1,0,t);break;default:return}this.setGeometryCoordinates_(r,a);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(r,s,o,1);const l={segment:[i[0],t],feature:n,geometry:r,depth:o,index:s};u.insert(Object(f.boundingExtent)(l.segment),l),this.dragSegments_.push([l,1]);const h={segment:[t,i[1]],feature:n,geometry:r,depth:o,index:s+1};u.insert(Object(f.boundingExtent)(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},I.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=a.a.POINTERDRAG){const e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new I.Event(y.MODIFYEND,this.features_,e)),this.modified_=!1,!0}return!1},I.prototype.removeVertex_=function(){const e=this.dragSegments_,t={};let i,r,o,s,a,u,l,h,d,c,g,_=!1;for(a=e.length-1;a>=0;--a)c=(o=e[a])[0],g=Object(n.getUid)(c.feature),c.depth&&(g+="-"+c.depth.join("-")),g in t||(t[g]={}),0===o[1]?(t[g].right=c,t[g].index=c.index):1==o[1]&&(t[g].left=c,t[g].index=c.index+1);for(g in t){switch(d=t[g].right,l=t[g].left,h=(u=t[g].index)-1,c=void 0!==l?l:d,h<0&&(h=0),i=r=(s=c.geometry).getCoordinates(),_=!1,s.getType()){case p.a.MULTI_LINE_STRING:r[c.depth[0]].length>2&&(r[c.depth[0]].splice(u,1),_=!0);break;case p.a.LINE_STRING:r.length>2&&(r.splice(u,1),_=!0);break;case p.a.MULTI_POLYGON:i=i[c.depth[1]];case p.a.POLYGON:(i=i[c.depth[0]]).length>4&&(u==i.length-1&&(u=0),i.splice(u,1),_=!0,0===u&&(i.pop(),i.push(i[0]),h=i.length-1))}if(_){this.setGeometryCoordinates_(s,r);const t=[];if(void 0!==l&&(this.rBush_.remove(l),t.push(l.segment[0])),void 0!==d&&(this.rBush_.remove(d),t.push(d.segment[1])),void 0!==l&&void 0!==d){const e={depth:c.depth,feature:c.feature,geometry:c.geometry,index:h,segment:t};this.rBush_.insert(Object(f.boundingExtent)(e.segment),e)}this.updateSegmentIndices_(s,u,c.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return _},I.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},I.prototype.updateSegmentIndices_=function(e,t,i,n){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(void 0===i||void 0===r.depth||Object(l.equals)(r.depth,i))&&r.index>t&&(r.index+=n)})},I.getDefaultStyleFunction=function(){const e=S.default.createDefaultEditing();return function(t,i){return e[p.a.POINT]}},I.Event=function(e,t,i){c.default.call(this,e),this.features=t,this.mapBrowserEvent=i},Object(n.inherits)(I.Event,c.default);t.default=I},4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(5);const o=function(e){const t=e||{};let i;i=void 0!==t.attributions?t.attributions:[o.ATTRIBUTION];const n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",s=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";r.a.call(this,{attributions:i,cacheSize:t.cacheSize,crossOrigin:n,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:s,wrapX:t.wrapX})};Object(n.inherits)(o,r.a),o.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',t.default=o},472:function(e,t,i){i(8),e.exports=i(473)},473:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(474),i(9);var n=p(i(133)),r=p(i(475)),o=p(i(12)),s=p(i(17)),a=p(i(16)),u=p(i(28)),l=p(i(4)),h=p(i(23)),d=p(i(134)),c=p(i(26)),g=p(i(37)),_=p(i(18)),f=p(i(14));function p(e){return e&&e.__esModule?e:{default:e}}var m={},y=angular.module("app",[f.default.name]);m.MainController=function(){this.map=new o.default({layers:[new a.default({source:new l.default})],view:new s.default({center:[-10997148,4569099],zoom:4})});var e=this.map,t=new d.default([-10691093,4966327],465e3);this.features=new g.default;var i=new _.default({geometry:c.default.fromCircle(t),color:"#000000",label:"Circle 1",opacity:"0.5",stroke:"2"});i.set(n.default.IS_CIRCLE,!0),this.features.push(i);var f=new h.default({features:this.features});new u.default({source:f}).setMap(e),this.interaction=new r.default({features:this.features});var p=this.interaction;p.setActive(!0),e.addInteraction(p)},y.controller("MainController",m.MainController),t.default=m},474:function(e,t){},475:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=F(i(3)),r=F(i(133)),o=F(i(160)),s=C(i(0)),a=F(i(18)),u=F(i(102)),l=C(i(60)),h=C(i(2)),d=C(i(1)),c=F(i(134)),g=F(i(36)),_=F(i(25)),f=F(i(26)),p=F(i(150)),m=F(i(48)),y=F(i(28)),v=F(i(23)),E=F(i(113)),x=F(i(21));function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function F(e){return e&&e.__esModule?e:{default:e}}var S=function e(t){n.default.assert(t.features),m.default.call(this,{handleDownEvent:e.handleDownEvent_,handleDragEvent:e.handleDragEvent_,handleEvent:e.handleEvent,handleUpEvent:e.handleUpEvent_}),this.vertexFeature_=null,this.lastPixel_=[0,0],this.modified_=!1,this.rBush_=new E.default,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=null,this.overlay_=new y.default({source:new v.default({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:e.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.features_=t.features,this.features_.forEach(this.addFeature_,this),h.listen(this.features_,"add",this.handleFeatureAdd_,this),h.listen(this.features_,"remove",this.handleFeatureRemove_,this)};s.inherits(S,m.default),S.prototype.addFeature_=function(e){if("Polygon"===e.getGeometry().getType()&&e.get(r.default.IS_CIRCLE)){var t=e.getGeometry();this.writeCircleGeometry_(e,t);var i=this.getMap();i&&this.handlePointerAtPixel_(this.lastPixel_,i)}},S.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new p.default.Event("modifystart",this.features_,e)))},S.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},S.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(var n=i.length-1;n>=0;--n)t.remove(i[n])},S.prototype.setMap=function(e){this.overlay_.setMap(e),m.default.prototype.setMap.call(this,e)},S.prototype.handleFeatureAdd_=function(e){var t=e.element;n.default.assertInstanceof(t,a.default,"feature should be an ol.Feature"),this.addFeature_(t)},S.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},S.prototype.writeCircleGeometry_=function(e,t){var i,n=t.getCoordinates(),r=void 0,o=void 0,s=void 0,a=void 0,u=void 0,l=void 0;for(a=0,i=n.length;a<i;++a)for(o=0,s=(r=n[a]).length-1;o<s;++o)l={feature:e,geometry:t,depth:[a],index:o,segment:u=r.slice(o,o+2)},this.rBush_.insert(d.boundingExtent(u),l)},S.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new a.default(new _.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t));return t},S.compareIndexes_=function(e,t){return e.index-t.index},S.handleDownEvent_=function(e){this.handlePointerAtPixel_(e.pixel,e.map),this.dragSegments_=[],this.modified_=!1;var t=this.vertexFeature_;if(t){var i=t.getGeometry().getCoordinates(),n=d.boundingExtent([i]),r=this.rBush_.getInExtent(n),o={};r.sort(S.compareIndexes_);for(var a=0,u=r.length;a<u;++a){var h=r[a],c=h.segment,g=s.getUid(h.feature),_=h.depth;_&&(g+="-"+_.join("-")),o[g]||(o[g]=new Array(2)),l.equals(c[0],i)&&!o[g][0]?(this.dragSegments_.push([h,0]),o[g][0]=h):l.equals(c[1],i)&&!o[g][1]&&(this.dragSegments_.push([h,1]),o[g][1]=h)}}return!!this.vertexFeature_},S.handleDragEvent_=function(e){this.willModifyFeatures_(e);var t=e.coordinate,i=this.dragSegments_[0][0].geometry,n=d.getCenter(i.getExtent()),s=new g.default([n,t]),a=new c.default(n,s.getLength()),u=f.default.fromCircle(a,64).getCoordinates();this.setGeometryCoordinates_(i,u);var l=o.default.getAzimut(s);this.features_.getArray()[0].set(r.default.AZIMUT,l),this.createOrUpdateVertexFeature_(t)},S.handleUpEvent_=function(e){return this.rBush_.clear(),this.writeCircleGeometry_(this.dragSegments_[0][0].feature,this.dragSegments_[0][0].geometry),this.modified_&&(this.dispatchEvent(new p.default.Event("modifyend",this.features_,e)),this.modified_=!1),!1},S.handleEvent=function(e){if(!(e instanceof u.default))return!0;return e.map.getView().getInteracting()||"pointermove"!=e.type||this.handlingDownUpSequence||this.handlePointerMove_(e),m.default.handleEvent.call(this,e)&&!0},S.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},S.prototype.handlePointerAtPixel_=function(e,t){var i=t.getCoordinateFromPixel(e),n=t.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),r=t.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),o=d.boundingExtent([n,r]),a=this.rBush_.getInExtent(o);if(a.length>0){a.sort(function(e,t){return l.squaredDistanceToSegment(i,e.segment)-l.squaredDistanceToSegment(i,t.segment)});var u=a[0].segment,h=l.closestOnSegment(i,u),c=t.getPixelFromCoordinate(h);if(Math.sqrt(l.squaredDistance(e,c))<=this.pixelTolerance_){var g=t.getPixelFromCoordinate(u[0]),_=t.getPixelFromCoordinate(u[1]),f=l.squaredDistance(c,g),p=l.squaredDistance(c,_),m=Math.sqrt(Math.min(f,p));if(this.snappedToVertex_=m<=this.pixelTolerance_,this.snappedToVertex_){h=f>p?u[1]:u[0],this.createOrUpdateVertexFeature_(h);var y={};y[s.getUid(u)]=!0;for(var v=void 0,E=1,x=a.length;E<x&&(v=a[E].segment,l.equals(u[0],v[0])&&l.equals(u[1],v[1])||l.equals(u[0],v[1])&&l.equals(u[1],v[0]));++E)y[s.getUid(v)]=!0;return}}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},S.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},S.getDefaultStyleFunction=function(){var e=x.default.createDefaultEditing();return function(t,i){return e.Point}},t.default=S},5:function(e,t,i){"use strict";var n=i(0),r=i(19),o=i(20);const s=function(e){const t=e||{},i=void 0!==t.projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:Object(o.a)({extent:Object(o.b)(i),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});r.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:i,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(n.inherits)(s,r.a),t.a=s}},[472]);
//# sourceMappingURL=modifycircle.ad5785b27fda22138430.js.map