webpackJsonp([10],{150:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(37),o=i(101),s=i(18),a=i(68),u=i(102),l=i(7),h=i(60),d=i(2),c=i(35),_=i(10),f=i(47),g=i(1),p=i(24),m=i(25),y={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},E=i(48),v=i(28),x=i(23),C=i(159),F=i(113),O=i(21);const I=function(e){let t;if(E.default.call(this,{handleDownEvent:w,handleDragEvent:M,handleEvent:b,handleUpEvent:T}),this.condition_=e.condition?e.condition:f.primaryAction,this.defaultDeleteCondition_=function(e){return Object(f.altKeyOnly)(e)&&Object(f.singleClick)(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:f.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new F.default,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new v.default({source:new x.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:I.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,t=new r.default(this.source_.getFeatures()),Object(d.listen)(this.source_,C.a.ADDFEATURE,this.handleSourceAdd_,this),Object(d.listen)(this.source_,C.a.REMOVEFEATURE,this.handleSourceRemove_,this)):t=e.features,!t)throw new Error("The modify interaction requires features or a source");this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),Object(d.listen)(this.features_,o.a.ADD,this.handleFeatureAdd_,this),Object(d.listen)(this.features_,o.a.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null};function S(e,t){return e.index-t.index}function w(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);const t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;const i=this.vertexFeature_;if(i){const r=[],o=i.getGeometry().getCoordinates(),s=Object(g.boundingExtent)([o]),a=this.rBush_.getInExtent(s),u={};a.sort(S);for(let i=0,s=a.length;i<s;++i){const s=a[i],l=s.segment;let d=Object(n.getUid)(s.feature);const c=s.depth;if(c&&(d+="-"+c.join("-")),u[d]||(u[d]=new Array(2)),s.geometry.getType()===p.a.CIRCLE&&s.index===I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const e=R(t,s);Object(h.equals)(e,o)&&!u[d][0]&&(this.dragSegments_.push([s,0]),u[d][0]=s)}else if(Object(h.equals)(l[0],o)&&!u[d][0])this.dragSegments_.push([s,0]),u[d][0]=s;else if(Object(h.equals)(l[1],o)&&!u[d][1]){if((s.geometry.getType()===p.a.LINE_STRING||s.geometry.getType()===p.a.MULTI_LINE_STRING)&&u[d][0]&&0===u[d][0].index)continue;this.dragSegments_.push([s,1]),u[d][1]=s}else this.insertVertexCondition_(e)&&Object(n.getUid)(l)in this.vertexSegments_&&!u[d][0]&&!u[d][1]&&r.push([s,o])}r.length&&this.willModifyFeatures_(e);for(let e=r.length-1;e>=0;--e)this.insertVertex_.apply(this,r[e])}return!!this.vertexFeature_}function M(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);const t=e.coordinate;for(let e=0,i=this.dragSegments_.length;e<i;++e){const i=this.dragSegments_[e],n=i[0],r=n.depth,o=n.geometry;let s;const a=n.segment,u=i[1];for(;t.length<o.getStride();)t.push(a[u][t.length]);switch(o.getType()){case p.a.POINT:s=t,a[0]=a[1]=t;break;case p.a.MULTI_POINT:(s=o.getCoordinates())[n.index]=t,a[0]=a[1]=t;break;case p.a.LINE_STRING:(s=o.getCoordinates())[n.index+u]=t,a[u]=t;break;case p.a.MULTI_LINE_STRING:case p.a.POLYGON:(s=o.getCoordinates())[r[0]][n.index+u]=t,a[u]=t;break;case p.a.MULTI_POLYGON:(s=o.getCoordinates())[r[1]][r[0]][n.index+u]=t,a[u]=t;break;case p.a.CIRCLE:a[0]=a[1]=t,n.index===I.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX?(this.changingFeature_=!0,o.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,o.setRadius(Object(h.distance)(o.getCenter(),t)),this.changingFeature_=!1)}s&&this.setGeometryCoordinates_(o,s)}this.createOrUpdateVertexFeature_(t)}function T(e){let t,i;for(let e=this.dragSegments_.length-1;e>=0;--e)if((i=(t=this.dragSegments_[e][0]).geometry).getType()===p.a.CIRCLE){const e=i.getCenter(),n=t.featureSegments[0],r=t.featureSegments[1];n.segment[0]=n.segment[1]=e,r.segment[0]=r.segment[1]=e,this.rBush_.update(Object(g.createOrUpdateFromCoordinate)(e),n),this.rBush_.update(i.getExtent(),r)}else this.rBush_.update(Object(g.boundingExtent)(t.segment),t);return this.modified_&&(this.dispatchEvent(new I.Event(y.MODIFYEND,this.features_,e)),this.modified_=!1),!1}function b(e){if(!(e instanceof u.default))return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=a.a.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=a.a.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==a.a.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),E.handleEvent.call(this,e)&&!t}function N(e,t){const i=t.geometry;if(i.getType()===p.a.CIRCLE){const n=i;if(t.index===I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const t=Object(h.squaredDistance)(n.getCenter(),e),i=Math.sqrt(t)-n.getRadius();return i*i}}return Object(h.squaredDistanceToSegment)(e,t.segment)}function R(e,t){const i=t.geometry;return i.getType()===p.a.CIRCLE&&t.index===I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX?i.getClosestPoint(e):Object(h.closestOnSegment)(e,t.segment)}Object(n.inherits)(I,E.default),I.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX=0,I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX=1,I.prototype.addFeature_=function(e){const t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),Object(d.listen)(e,_.a.CHANGE,this.handleFeatureChange_,this)},I.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new I.Event(y.MODIFYSTART,this.features_,e)))},I.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),Object(d.unlisten)(e,_.a.CHANGE,this.handleFeatureChange_,this)},I.prototype.removeFeatureSegmentData_=function(e){const t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])},I.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),E.default.prototype.setActive.call(this,e)},I.prototype.setMap=function(e){this.overlay_.setMap(e),E.default.prototype.setMap.call(this,e)},I.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},I.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},I.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},I.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}},I.prototype.handleFeatureRemove_=function(e){const t=e.element;this.removeFeature_(t)},I.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},I.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s;for(r=0,o=i.length;r<o;++r)s={feature:e,geometry:t,depth:[r],index:r,segment:[n=i[r],n]},this.rBush_.insert(t.getExtent(),s)},I.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s;for(n=0,r=i.length-1;n<r;++n)s={feature:e,geometry:t,index:n,segment:o=i.slice(n,n+2)},this.rBush_.insert(Object(g.boundingExtent)(o),s)},I.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,u,l;for(s=0,a=i.length;s<a;++s)for(r=0,o=(n=i[s]).length-1;r<o;++r)l={feature:e,geometry:t,depth:[s],index:r,segment:u=n.slice(r,r+2)},this.rBush_.insert(Object(g.boundingExtent)(u),l)},I.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,u,l;for(s=0,a=i.length;s<a;++s)for(r=0,o=(n=i[s]).length-1;r<o;++r)l={feature:e,geometry:t,depth:[s],index:r,segment:u=n.slice(r,r+2)},this.rBush_.insert(Object(g.boundingExtent)(u),l)},I.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,u,l,h,d,c;for(u=0,l=i.length;u<l;++u)for(s=0,a=(h=i[u]).length;s<a;++s)for(r=0,o=(n=h[s]).length-1;r<o;++r)c={feature:e,geometry:t,depth:[s,u],index:r,segment:d=n.slice(r,r+2)},this.rBush_.insert(Object(g.boundingExtent)(d),c)},I.prototype.writeCircleGeometry_=function(e,t){const i=t.getCenter(),n={feature:e,geometry:t,index:I.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX,segment:[i,i]},r={feature:e,geometry:t,index:I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX,segment:[i,i]},o=[n,r];n.featureSegments=r.featureSegments=o,this.rBush_.insert(Object(g.createOrUpdateFromCoordinate)(i),n),this.rBush_.insert(t.getExtent(),r)},I.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t)this.SEGMENT_WRITERS_[i[t].getType()].call(this,e,i[t])},I.prototype.createOrUpdateVertexFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new s.default(new m.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t);return t},I.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},I.prototype.handlePointerAtPixel_=function(e,t){const i=t.getCoordinateFromPixel(e),r=function(e,t){return N(i,e)-N(i,t)},o=Object(g.buffer)(Object(g.createOrUpdateFromCoordinate)(i),t.getView().getResolution()*this.pixelTolerance_),s=this.rBush_.getInExtent(o);if(s.length>0){s.sort(r);const o=s[0],a=o.segment;let u=R(i,o);const l=t.getPixelFromCoordinate(u);let d=Object(h.distance)(e,l);if(d<=this.pixelTolerance_){const e={};if(o.geometry.getType()===p.a.CIRCLE&&o.index===I.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{const i=t.getPixelFromCoordinate(a[0]),r=t.getPixelFromCoordinate(a[1]),o=Object(h.squaredDistance)(l,i),c=Object(h.squaredDistance)(l,r);let _;d=Math.sqrt(Math.min(o,c)),this.snappedToVertex_=d<=this.pixelTolerance_,this.snappedToVertex_&&(u=o>c?a[1]:a[0]),this.createOrUpdateVertexFeature_(u);for(let t=1,i=s.length;t<i&&(_=s[t].segment,Object(h.equals)(a[0],_[0])&&Object(h.equals)(a[1],_[1])||Object(h.equals)(a[0],_[1])&&Object(h.equals)(a[1],_[0]));++t)e[Object(n.getUid)(_)]=!0}return e[Object(n.getUid)(a)]=!0,void(this.vertexSegments_=e)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},I.prototype.insertVertex_=function(e,t){const i=e.segment,n=e.feature,r=e.geometry,o=e.depth,s=e.index;let a;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case p.a.MULTI_LINE_STRING:case p.a.POLYGON:(a=r.getCoordinates())[o[0]].splice(s+1,0,t);break;case p.a.MULTI_POLYGON:(a=r.getCoordinates())[o[1]][o[0]].splice(s+1,0,t);break;case p.a.LINE_STRING:(a=r.getCoordinates()).splice(s+1,0,t);break;default:return}this.setGeometryCoordinates_(r,a);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(r,s,o,1);const l={segment:[i[0],t],feature:n,geometry:r,depth:o,index:s};u.insert(Object(g.boundingExtent)(l.segment),l),this.dragSegments_.push([l,1]);const h={segment:[t,i[1]],feature:n,geometry:r,depth:o,index:s+1};u.insert(Object(g.boundingExtent)(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},I.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=a.a.POINTERDRAG){const e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new I.Event(y.MODIFYEND,this.features_,e)),this.modified_=!1,!0}return!1},I.prototype.removeVertex_=function(){const e=this.dragSegments_,t={};let i,r,o,s,a,u,l,h,d,c,_,f=!1;for(a=e.length-1;a>=0;--a)c=(o=e[a])[0],_=Object(n.getUid)(c.feature),c.depth&&(_+="-"+c.depth.join("-")),_ in t||(t[_]={}),0===o[1]?(t[_].right=c,t[_].index=c.index):1==o[1]&&(t[_].left=c,t[_].index=c.index+1);for(_ in t){switch(d=t[_].right,l=t[_].left,h=(u=t[_].index)-1,c=void 0!==l?l:d,h<0&&(h=0),i=r=(s=c.geometry).getCoordinates(),f=!1,s.getType()){case p.a.MULTI_LINE_STRING:r[c.depth[0]].length>2&&(r[c.depth[0]].splice(u,1),f=!0);break;case p.a.LINE_STRING:r.length>2&&(r.splice(u,1),f=!0);break;case p.a.MULTI_POLYGON:i=i[c.depth[1]];case p.a.POLYGON:(i=i[c.depth[0]]).length>4&&(u==i.length-1&&(u=0),i.splice(u,1),f=!0,0===u&&(i.pop(),i.push(i[0]),h=i.length-1))}if(f){this.setGeometryCoordinates_(s,r);const t=[];if(void 0!==l&&(this.rBush_.remove(l),t.push(l.segment[0])),void 0!==d&&(this.rBush_.remove(d),t.push(d.segment[1])),void 0!==l&&void 0!==d){const e={depth:c.depth,feature:c.feature,geometry:c.geometry,index:h,segment:t};this.rBush_.insert(Object(g.boundingExtent)(e.segment),e)}this.updateSegmentIndices_(s,u,c.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return f},I.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},I.prototype.updateSegmentIndices_=function(e,t,i,n){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(void 0===i||void 0===r.depth||Object(l.equals)(r.depth,i))&&r.index>t&&(r.index+=n)})},I.getDefaultStyleFunction=function(){const e=O.default.createDefaultEditing();return function(t,i){return e[p.a.POINT]}},I.Event=function(e,t,i){c.default.call(this,e),this.features=t,this.mapBrowserEvent=i},Object(n.inherits)(I.Event,c.default);t.default=I},4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(5);const o=function(e){const t=e||{};let i;i=void 0!==t.attributions?t.attributions:[o.ATTRIBUTION];const n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",s=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";r.a.call(this,{attributions:i,cacheSize:t.cacheSize,crossOrigin:n,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:s,wrapX:t.wrapX})};Object(n.inherits)(o,r.a),o.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',t.default=o},499:function(e,t,i){i(8),e.exports=i(500)},5:function(e,t,i){"use strict";var n=i(0),r=i(19),o=i(20);const s=function(e){const t=e||{},i=void 0!==t.projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:Object(o.a)({extent:Object(o.b)(i),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});r.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:i,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(n.inherits)(s,r.a),t.a=s},500:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(501),i(9);var n=E(i(502)),r=E(i(37)),o=E(i(18)),s=E(i(12)),a=E(i(17)),u=E(i(16)),l=E(i(28)),h=E(i(4)),d=E(i(23)),c=E(i(135)),_=E(i(40)),f=E(i(21)),g=E(i(45)),p=E(i(54)),m=E(i(26)),y=E(i(14));function E(e){return e&&e.__esModule?e:{default:e}}var v={};v.module=angular.module("app",[y.default.name]);var x=angular.module("app",["ngeo"]);v.MainController=function(){this.map=new s.default({layers:[new u.default({source:new h.default})],view:new a.default({center:[-10997148,4569099],zoom:4})});var e=this.map,t=new m.default([[[-9e6,4e6],[-11e6,4e6],[-11e6,6e6],[-9e6,6e6]]]);this.features=new r.default,this.features.push(new o.default({geometry:t}));var i=new d.default({features:this.features}),y=new l.default({source:i});y.setMap(e);var E,v=((E={}).Polygon=[new f.default({fill:new g.default({color:[255,255,255,.5]})}),new f.default({stroke:new _.default({color:[255,255,255,1],width:5})}),new f.default({stroke:new _.default({color:[0,153,255,1],width:3})})],E.Point=new f.default({image:new p.default,text:new c.default({text:"",font:"normal 18px FontAwesome",fill:new g.default({color:"#ffffff"})})}),E.GeometryCollection=E.Polygon.concat(E.Point),function(e,t){return E[e.getGeometry().getType()]});this.interaction=new n.default({features:this.features,layers:[y],style:v});var x=this.interaction;x.setActive(!1),e.addInteraction(x),e.on("singleclick",function(e){this.map.forEachFeatureAtPixel(e.pixel,function(e){return e})&&this.interaction.setActive(!0)},this)},x.controller("MainController",v.MainController),t.default=v},501:function(e,t){},502:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(i(3)),r=y(i(182)),o=m(i(0)),s=m(i(1)),a=y(i(18)),u=m(i(2)),l=y(i(150)),h=y(i(48)),d=y(i(74)),c=y(i(25)),_=y(i(36)),f=y(i(26)),g=y(i(28)),p=y(i(23));function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function y(e){return e&&e.__esModule?e:{default:e}}var E=function(e){n.default.assert(e.features),this.listenerKeys_=[],this.modified_=!1,this.keyPressListenerKey_=null,this.changingFeature_=!1,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.features_=e.features,this.feature_=null,this.coordinate_=null,this.centerCoordinate_=null;var t=e.style?e.style:l.default.getDefaultStyleFunction();this.overlay_=new g.default({source:new p.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:t,updateWhileAnimating:!0,updateWhileInteracting:!0}),this.centerFeatures_={},h.default.call(this,{handleDownEvent:this.handleDown_,handleDragEvent:this.handleDrag_,handleUpEvent:this.handleUp_})};o.inherits(E,h.default),E.prototype.setActive=function(e){this.keyPressListenerKey_&&(u.unlistenByKey(this.keyPressListenerKey_),this.keyPressListenerKey_=null),h.default.prototype.setActive.call(this,e),e?(this.keyPressListenerKey_=u.listen(document,"keyup",this.handleKeyUp_,this),this.features_.forEach(this.addFeature_,this),this.listenerKeys_.push(u.listen(this.features_,"add",this.handleFeatureAdd_,this),u.listen(this.features_,"remove",this.handleFeatureRemove_,this))):(this.listenerKeys_.forEach(u.unlistenByKey),this.listenerKeys_.length=0,this.features_.forEach(this.removeFeature_,this))},E.prototype.addFeature_=function(e){var t=e.getGeometry();n.default.assertInstanceof(t,d.default),e.set("angle",0);var i=o.getUid(e),r=new c.default(this.getCenterCoordinate_(t)),s=new a.default(r);this.centerFeatures_[i]=s,this.overlay_.getSource().addFeature(s)},E.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new l.default.Event("modifystart",this.features_,e)))},E.prototype.removeFeature_=function(e){if(this.feature_=null,e){var t=o.getUid(e);this.centerFeatures_[t]&&(this.overlay_.getSource().removeFeature(this.centerFeatures_[t]),delete this.centerFeatures_[t])}},E.prototype.setMap=function(e){this.overlay_.setMap(e),h.default.prototype.setMap.call(this,e)},E.prototype.handleFeatureAdd_=function(e){var t=e.element;n.default.assertInstanceof(t,a.default,"feature should be an ol.Feature"),this.addFeature_(t)},E.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},E.prototype.handleDown_=function(e){var t=e.map.forEachFeatureAtPixel(e.pixel,function(e,t){return e},void 0);if(t){var i=!1;this.features_.forEach(function(e){o.getUid(e)==o.getUid(t)&&(i=!0)}),i||(t=null)}if(t){this.coordinate_=e.coordinate,this.feature_=t;var n=this.feature_.getGeometry();return void 0!==n&&(this.centerCoordinate_=this.getCenterCoordinate_(n)),!0}return!1},E.prototype.getCenterCoordinate_=function(e){var t=void 0;if(e instanceof _.default)t=e.getFlatMidpoint();else if(e instanceof f.default)t=e.getFlatInteriorPoint();else{var i=e.getExtent();t=s.getCenter(i)}return t},E.prototype.handleDrag_=function(e){this.willModifyFeatures_(e);var t=this.feature_.getGeometry(),i=this.coordinate_[0],n=this.coordinate_[1],r=this.centerCoordinate_[0],o=this.centerCoordinate_[1],s=i-r,a=n-o,u=e.coordinate[0]-r,l=e.coordinate[1]-o;this.coordinate_[0]=e.coordinate[0],this.coordinate_[1]=e.coordinate[1];var h=Math.atan2(l,u),d=Math.atan2(a,s)-h;t.rotate(-d,[r,o])},E.prototype.handleUp_=function(e){if(this.modified_){var t=new r.default("rotateend",{feature:this.feature_});this.dispatchEvent(t),this.modified_=!1,this.setActive(!1)}return!1},E.prototype.handleKeyUp_=function(e){27===e.keyCode&&this.setActive(!1)},t.default=E}},[499]);
//# sourceMappingURL=rotate.88f8b9da89810966747e.js.map