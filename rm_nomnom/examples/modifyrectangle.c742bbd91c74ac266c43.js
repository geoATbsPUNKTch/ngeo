webpackJsonp([11],{150:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(37),o=i(101),s=i(18),a=i(68),l=i(102),u=i(7),h=i(60),d=i(2),c=i(35),g=i(10),_=i(47),f=i(1),p=i(24),m=i(25),y={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},v=i(48),E=i(28),x=i(23),C=i(159),F=i(113),I=i(21);const O=function(e){let t;if(v.default.call(this,{handleDownEvent:w,handleDragEvent:S,handleEvent:P,handleUpEvent:M}),this.condition_=e.condition?e.condition:_.primaryAction,this.defaultDeleteCondition_=function(e){return Object(_.altKeyOnly)(e)&&Object(_.singleClick)(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:_.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new F.default,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new E.default({source:new x.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:O.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,t=new r.default(this.source_.getFeatures()),Object(d.listen)(this.source_,C.a.ADDFEATURE,this.handleSourceAdd_,this),Object(d.listen)(this.source_,C.a.REMOVEFEATURE,this.handleSourceRemove_,this)):t=e.features,!t)throw new Error("The modify interaction requires features or a source");this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),Object(d.listen)(this.features_,o.a.ADD,this.handleFeatureAdd_,this),Object(d.listen)(this.features_,o.a.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null};function b(e,t){return e.index-t.index}function w(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);const t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;const i=this.vertexFeature_;if(i){const r=[],o=i.getGeometry().getCoordinates(),s=Object(f.boundingExtent)([o]),a=this.rBush_.getInExtent(s),l={};a.sort(b);for(let i=0,s=a.length;i<s;++i){const s=a[i],u=s.segment;let d=Object(n.getUid)(s.feature);const c=s.depth;if(c&&(d+="-"+c.join("-")),l[d]||(l[d]=new Array(2)),s.geometry.getType()===p.a.CIRCLE&&s.index===O.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const e=T(t,s);Object(h.equals)(e,o)&&!l[d][0]&&(this.dragSegments_.push([s,0]),l[d][0]=s)}else if(Object(h.equals)(u[0],o)&&!l[d][0])this.dragSegments_.push([s,0]),l[d][0]=s;else if(Object(h.equals)(u[1],o)&&!l[d][1]){if((s.geometry.getType()===p.a.LINE_STRING||s.geometry.getType()===p.a.MULTI_LINE_STRING)&&l[d][0]&&0===l[d][0].index)continue;this.dragSegments_.push([s,1]),l[d][1]=s}else this.insertVertexCondition_(e)&&Object(n.getUid)(u)in this.vertexSegments_&&!l[d][0]&&!l[d][1]&&r.push([s,o])}r.length&&this.willModifyFeatures_(e);for(let e=r.length-1;e>=0;--e)this.insertVertex_.apply(this,r[e])}return!!this.vertexFeature_}function S(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);const t=e.coordinate;for(let e=0,i=this.dragSegments_.length;e<i;++e){const i=this.dragSegments_[e],n=i[0],r=n.depth,o=n.geometry;let s;const a=n.segment,l=i[1];for(;t.length<o.getStride();)t.push(a[l][t.length]);switch(o.getType()){case p.a.POINT:s=t,a[0]=a[1]=t;break;case p.a.MULTI_POINT:(s=o.getCoordinates())[n.index]=t,a[0]=a[1]=t;break;case p.a.LINE_STRING:(s=o.getCoordinates())[n.index+l]=t,a[l]=t;break;case p.a.MULTI_LINE_STRING:case p.a.POLYGON:(s=o.getCoordinates())[r[0]][n.index+l]=t,a[l]=t;break;case p.a.MULTI_POLYGON:(s=o.getCoordinates())[r[1]][r[0]][n.index+l]=t,a[l]=t;break;case p.a.CIRCLE:a[0]=a[1]=t,n.index===O.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX?(this.changingFeature_=!0,o.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,o.setRadius(Object(h.distance)(o.getCenter(),t)),this.changingFeature_=!1)}s&&this.setGeometryCoordinates_(o,s)}this.createOrUpdateVertexFeature_(t)}function M(e){let t,i;for(let e=this.dragSegments_.length-1;e>=0;--e)if((i=(t=this.dragSegments_[e][0]).geometry).getType()===p.a.CIRCLE){const e=i.getCenter(),n=t.featureSegments[0],r=t.featureSegments[1];n.segment[0]=n.segment[1]=e,r.segment[0]=r.segment[1]=e,this.rBush_.update(Object(f.createOrUpdateFromCoordinate)(e),n),this.rBush_.update(i.getExtent(),r)}else this.rBush_.update(Object(f.boundingExtent)(t.segment),t);return this.modified_&&(this.dispatchEvent(new O.Event(y.MODIFYEND,this.features_,e)),this.modified_=!1),!1}function P(e){if(!(e instanceof l.default))return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=a.a.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=a.a.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==a.a.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),v.handleEvent.call(this,e)&&!t}function N(e,t){const i=t.geometry;if(i.getType()===p.a.CIRCLE){const n=i;if(t.index===O.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){const t=Object(h.squaredDistance)(n.getCenter(),e),i=Math.sqrt(t)-n.getRadius();return i*i}}return Object(h.squaredDistanceToSegment)(e,t.segment)}function T(e,t){const i=t.geometry;return i.getType()===p.a.CIRCLE&&t.index===O.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX?i.getClosestPoint(e):Object(h.closestOnSegment)(e,t.segment)}Object(n.inherits)(O,v.default),O.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX=0,O.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX=1,O.prototype.addFeature_=function(e){const t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),Object(d.listen)(e,g.a.CHANGE,this.handleFeatureChange_,this)},O.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new O.Event(y.MODIFYSTART,this.features_,e)))},O.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),Object(d.unlisten)(e,g.a.CHANGE,this.handleFeatureChange_,this)},O.prototype.removeFeatureSegmentData_=function(e){const t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])},O.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),v.default.prototype.setActive.call(this,e)},O.prototype.setMap=function(e){this.overlay_.setMap(e),v.default.prototype.setMap.call(this,e)},O.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},O.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},O.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},O.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}},O.prototype.handleFeatureRemove_=function(e){const t=e.element;this.removeFeature_(t)},O.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},O.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s;for(r=0,o=i.length;r<o;++r)s={feature:e,geometry:t,depth:[r],index:r,segment:[n=i[r],n]},this.rBush_.insert(t.getExtent(),s)},O.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s;for(n=0,r=i.length-1;n<r;++n)s={feature:e,geometry:t,index:n,segment:o=i.slice(n,n+2)},this.rBush_.insert(Object(f.boundingExtent)(o),s)},O.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,l,u;for(s=0,a=i.length;s<a;++s)for(r=0,o=(n=i[s]).length-1;r<o;++r)u={feature:e,geometry:t,depth:[s],index:r,segment:l=n.slice(r,r+2)},this.rBush_.insert(Object(f.boundingExtent)(l),u)},O.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,l,u;for(s=0,a=i.length;s<a;++s)for(r=0,o=(n=i[s]).length-1;r<o;++r)u={feature:e,geometry:t,depth:[s],index:r,segment:l=n.slice(r,r+2)},this.rBush_.insert(Object(f.boundingExtent)(l),u)},O.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();let n,r,o,s,a,l,u,h,d,c;for(l=0,u=i.length;l<u;++l)for(s=0,a=(h=i[l]).length;s<a;++s)for(r=0,o=(n=h[s]).length-1;r<o;++r)c={feature:e,geometry:t,depth:[s,l],index:r,segment:d=n.slice(r,r+2)},this.rBush_.insert(Object(f.boundingExtent)(d),c)},O.prototype.writeCircleGeometry_=function(e,t){const i=t.getCenter(),n={feature:e,geometry:t,index:O.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX,segment:[i,i]},r={feature:e,geometry:t,index:O.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX,segment:[i,i]},o=[n,r];n.featureSegments=r.featureSegments=o,this.rBush_.insert(Object(f.createOrUpdateFromCoordinate)(i),n),this.rBush_.insert(t.getExtent(),r)},O.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t)this.SEGMENT_WRITERS_[i[t].getType()].call(this,e,i[t])},O.prototype.createOrUpdateVertexFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new s.default(new m.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t);return t},O.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},O.prototype.handlePointerAtPixel_=function(e,t){const i=t.getCoordinateFromPixel(e),r=function(e,t){return N(i,e)-N(i,t)},o=Object(f.buffer)(Object(f.createOrUpdateFromCoordinate)(i),t.getView().getResolution()*this.pixelTolerance_),s=this.rBush_.getInExtent(o);if(s.length>0){s.sort(r);const o=s[0],a=o.segment;let l=T(i,o);const u=t.getPixelFromCoordinate(l);let d=Object(h.distance)(e,u);if(d<=this.pixelTolerance_){const e={};if(o.geometry.getType()===p.a.CIRCLE&&o.index===O.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(l);else{const i=t.getPixelFromCoordinate(a[0]),r=t.getPixelFromCoordinate(a[1]),o=Object(h.squaredDistance)(u,i),c=Object(h.squaredDistance)(u,r);let g;d=Math.sqrt(Math.min(o,c)),this.snappedToVertex_=d<=this.pixelTolerance_,this.snappedToVertex_&&(l=o>c?a[1]:a[0]),this.createOrUpdateVertexFeature_(l);for(let t=1,i=s.length;t<i&&(g=s[t].segment,Object(h.equals)(a[0],g[0])&&Object(h.equals)(a[1],g[1])||Object(h.equals)(a[0],g[1])&&Object(h.equals)(a[1],g[0]));++t)e[Object(n.getUid)(g)]=!0}return e[Object(n.getUid)(a)]=!0,void(this.vertexSegments_=e)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},O.prototype.insertVertex_=function(e,t){const i=e.segment,n=e.feature,r=e.geometry,o=e.depth,s=e.index;let a;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case p.a.MULTI_LINE_STRING:case p.a.POLYGON:(a=r.getCoordinates())[o[0]].splice(s+1,0,t);break;case p.a.MULTI_POLYGON:(a=r.getCoordinates())[o[1]][o[0]].splice(s+1,0,t);break;case p.a.LINE_STRING:(a=r.getCoordinates()).splice(s+1,0,t);break;default:return}this.setGeometryCoordinates_(r,a);const l=this.rBush_;l.remove(e),this.updateSegmentIndices_(r,s,o,1);const u={segment:[i[0],t],feature:n,geometry:r,depth:o,index:s};l.insert(Object(f.boundingExtent)(u.segment),u),this.dragSegments_.push([u,1]);const h={segment:[t,i[1]],feature:n,geometry:r,depth:o,index:s+1};l.insert(Object(f.boundingExtent)(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},O.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=a.a.POINTERDRAG){const e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new O.Event(y.MODIFYEND,this.features_,e)),this.modified_=!1,!0}return!1},O.prototype.removeVertex_=function(){const e=this.dragSegments_,t={};let i,r,o,s,a,l,u,h,d,c,g,_=!1;for(a=e.length-1;a>=0;--a)c=(o=e[a])[0],g=Object(n.getUid)(c.feature),c.depth&&(g+="-"+c.depth.join("-")),g in t||(t[g]={}),0===o[1]?(t[g].right=c,t[g].index=c.index):1==o[1]&&(t[g].left=c,t[g].index=c.index+1);for(g in t){switch(d=t[g].right,u=t[g].left,h=(l=t[g].index)-1,c=void 0!==u?u:d,h<0&&(h=0),i=r=(s=c.geometry).getCoordinates(),_=!1,s.getType()){case p.a.MULTI_LINE_STRING:r[c.depth[0]].length>2&&(r[c.depth[0]].splice(l,1),_=!0);break;case p.a.LINE_STRING:r.length>2&&(r.splice(l,1),_=!0);break;case p.a.MULTI_POLYGON:i=i[c.depth[1]];case p.a.POLYGON:(i=i[c.depth[0]]).length>4&&(l==i.length-1&&(l=0),i.splice(l,1),_=!0,0===l&&(i.pop(),i.push(i[0]),h=i.length-1))}if(_){this.setGeometryCoordinates_(s,r);const t=[];if(void 0!==u&&(this.rBush_.remove(u),t.push(u.segment[0])),void 0!==d&&(this.rBush_.remove(d),t.push(d.segment[1])),void 0!==u&&void 0!==d){const e={depth:c.depth,feature:c.feature,geometry:c.geometry,index:h,segment:t};this.rBush_.insert(Object(f.boundingExtent)(e.segment),e)}this.updateSegmentIndices_(s,l,c.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return _},O.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},O.prototype.updateSegmentIndices_=function(e,t,i,n){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(void 0===i||void 0===r.depth||Object(u.equals)(r.depth,i))&&r.index>t&&(r.index+=n)})},O.getDefaultStyleFunction=function(){const e=I.default.createDefaultEditing();return function(t,i){return e[p.a.POINT]}},O.Event=function(e,t,i){c.default.call(this,e),this.features=t,this.mapBrowserEvent=i},Object(n.inherits)(O.Event,c.default);t.default=O},4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(5);const o=function(e){const t=e||{};let i;i=void 0!==t.attributions?t.attributions:[o.ATTRIBUTION];const n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",s=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";r.a.call(this,{attributions:i,cacheSize:t.cacheSize,crossOrigin:n,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:s,wrapX:t.wrapX})};Object(n.inherits)(o,r.a),o.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',t.default=o},476:function(e,t,i){i(8),e.exports=i(477)},477:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(478),i(9);var n=y(i(479)),r=y(i(12)),o=y(i(17)),s=y(i(16)),a=y(i(28)),l=y(i(4)),u=y(i(23)),h=y(i(26)),d=y(i(37)),c=y(i(18)),g=y(i(21)),_=y(i(54)),f=y(i(45)),p=y(i(40)),m=y(i(14));function y(e){return e&&e.__esModule?e:{default:e}}var v={},E=angular.module("app",[m.default.name]);v.MainController=function(){this.map=new r.default({layers:[new s.default({source:new l.default})],view:new o.default({center:[-10997148,4569099],zoom:4})});var e=this.map,t=new h.default([[[-9e6,4e6],[-11e6,4e6],[-11e6,6e6],[-9e6,6e6]]]);this.features=new d.default,this.features.push(new c.default({geometry:t,isRectangle:!0}));var i,m=((i={}).Polygon=[new g.default({fill:new f.default({color:[255,255,255,.5]})}),new g.default({stroke:new p.default({color:[255,255,255,1],width:5})}),new g.default({stroke:new p.default({color:[0,153,255,1],width:3})})],i.Point=[new g.default({image:new _.default({radius:7,fill:new f.default({color:[0,153,255,1]}),stroke:new p.default({color:[255,255,255,.75],width:1.5})}),zIndex:1e5})],i.GeometryCollection=i.Polygon.concat(i.Point),function(e,t){return i[e.getGeometry().getType()]}),y=new u.default({features:this.features});new a.default({source:y}).setMap(e),this.interaction=new n.default({features:this.features,style:m});var v=this.interaction;e.addInteraction(v),v.setActive(!0)},E.controller("MainController",v.MainController),t.default=v},478:function(e,t){},479:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(i(3)),r=g(i(0)),o=_(i(18)),s=g(i(2)),a=_(i(25)),l=_(i(26)),u=_(i(150)),h=_(i(48)),d=_(i(28)),c=_(i(23));function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function _(e){return e&&e.__esModule?e:{default:e}}var f=function(e){n.default.assert(e.features),h.default.call(this,{handleDownEvent:this.handleDown_,handleDragEvent:this.handleDrag_,handleUpEvent:this.handleUp_}),this.modified_=!1;var t=e.style?e.style:u.default.getDefaultStyleFunction();this.vectorPoints_=new d.default({source:new c.default({wrapX:!!e.wrapX}),visible:this.getActive(),style:t,updateWhileAnimating:!0,updateWhileInteracting:!0}),this.features_=e.features,this.feature_=null,this.cache_={},this.params_=null,s.listen(this.features_,"add",this.handleFeatureAdd_,this),s.listen(this.features_,"remove",this.handleFeatureRemove_,this),this.features_.forEach(this.addFeature_,this)};r.inherits(f,h.default),f.prototype.setActive=function(e){h.default.prototype.setActive.call(this,e),this.vectorPoints_&&this.vectorPoints_.setVisible(e)},f.prototype.addFeature_=function(e){var t=e.getGeometry();if(t instanceof l.default){var i=r.getUid(e),n=this.cache_[i];if(n)return;for(var s=this.vectorPoints_.getSource(),u=t.getCoordinates()[0];u.length>4;)u[0][0]<u[1][0]&&u[0][1]<=u[1][1]?u.pop():u.shift();var h=[],d=void 0,c=void 0;u.forEach(function(t){d=new a.default(t),c=new o.default({corner:!0,geometry:d,siblingX:null,siblingY:null,boxFeature:e}),h.push(c)},this),n={corners:h},this.cache_[i]=n;var g=void 0,_=void 0;h.forEach(function(e,t){(g=h[t-1])||(g=h[h.length-1]),(_=h[t+1])||(_=h[0]),t%2==0?(e.set("siblingX",_),e.set("siblingY",g)):(e.set("siblingX",g),e.set("siblingY",_))},this),s.addFeatures(h)}},f.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new u.default.Event("modifystart",this.features_,e)),this.params_=this.initializeParams_())},f.prototype.initializeParams_=function(){var e=this.feature_.get("siblingX");n.default.assertInstanceof(e,o.default);var t=e.get("siblingY");n.default.assertInstanceof(t,o.default);var i=t.getGeometry();n.default.assertInstanceof(i,a.default);var r=i.getCoordinates(),s=this.getMap().getPixelFromCoordinate(r),l=t.get("siblingX");n.default.assertInstanceof(l,o.default);var u=l.getGeometry();n.default.assertInstanceof(u,a.default);var h=u.getCoordinates(),d=this.getMap().getPixelFromCoordinate(h),c=[d[0]-s[0],d[1]-s[1]],g=Math.sqrt(c[0]*c[0]+c[1]*c[1]);c[0]/=g,c[1]/=g;var _=e.getGeometry();n.default.assertInstanceof(_,a.default);var f=_.getCoordinates(),p=this.getMap().getPixelFromCoordinate(f),m=[p[0]-s[0],p[1]-s[1]],y=Math.sqrt(m[0]*m[0]+m[1]*m[1]);return m[0]/=y,m[1]/=y,isNaN(c[0])&&isNaN(m[0])?(c=[0,1],m=[1,0]):isNaN(c[0])?c=[m[1],-m[0]]:isNaN(m[0])&&(m=[c[1],-c[0]]),{originCoordinate:r,originPixel:s,siblingXPoint:u,siblingYPoint:_,vectorX:c,vectorY:m}},f.prototype.removeFeature_=function(e){for(var t=r.getUid(e),i=this.cache_[t].corners,n=0;n<i.length;n++)this.vectorPoints_.getSource().removeFeature(i[n]);this.feature_=null,i.length=0,delete this.cache_[t]},f.prototype.setMap=function(e){this.vectorPoints_.setMap(e),h.default.prototype.setMap.call(this,e)},f.prototype.handleFeatureAdd_=function(e){var t=e.element;n.default.assertInstanceof(t,o.default,"feature should be an ol.Feature"),this.addFeature_(t)},f.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},f.prototype.handleDown_=function(e){var t=e.map.forEachFeatureAtPixel(e.pixel,function(e){return e.get("siblingX")&&e.get("siblingY")?e:void 0});return!!t&&(this.feature_=t,!0)},f.prototype.handleDrag_=function(e){this.willModifyFeatures_(e);var t=this.feature_,i=t.getGeometry();if(i instanceof a.default){i.setCoordinates(e.coordinate);var r=e.pixel,o=this.params_.originPixel,s=this.params_.siblingXPoint,u=this.params_.siblingYPoint,h=this.params_.vectorX,d=this.params_.vectorY,c=this.params_.originCoordinate,g=this.calculateNewPixel_(o,r,h),_=this.getMap().getCoordinateFromPixel(g);s.setCoordinates(_);var f=this.calculateNewPixel_(o,r,d),p=this.getMap().getCoordinateFromPixel(f);u.setCoordinates(p);var m=t.get("boxFeature").getGeometry();n.default.assertInstanceof(m,l.default),m.setCoordinates([[e.coordinate,_,c,p,e.coordinate]])}},f.prototype.calculateNewPixel_=function(e,t,i){var n=[t[0]-e[0],t[1]-e[1]],r=n[0]*i[0]+n[1]*i[1],o=[i[0]*r,i[1]*r];return[o[0]+e[0],o[1]+e[1]]},f.prototype.handleUp_=function(e){return this.modified_&&(this.dispatchEvent(new u.default.Event("modifyend",this.features_,e)),this.params_=null,this.modified_=!1),!1},t.default=f},5:function(e,t,i){"use strict";var n=i(0),r=i(19),o=i(20);const s=function(e){const t=e||{},i=void 0!==t.projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:Object(o.a)({extent:Object(o.b)(i),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});r.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:i,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(n.inherits)(s,r.a),t.a=s}},[476]);
//# sourceMappingURL=modifyrectangle.c742bbd91c74ac266c43.js.map