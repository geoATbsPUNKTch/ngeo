webpackJsonp([1],{199:function(e,t){e.exports='<h3>Total: {{ qrCtrl.result.total }}</h3> <ul class="nav nav-tabs" role=tablist> <li ng-repeat="source in qrCtrl.result.sources" role=presentation ng-if=source.features.length> <a href="#{{ ::source.id }}" aria-controls="{{ ::source.id }}" role=tab data-toggle=tab> <span>{{ ::source.label }}</span> <span>({{ ::source.features.length }})</span> </a> </li> </ul> <div class=tab-content> <div ng-repeat="source in qrCtrl.result.sources" role=tabpanel class=tab-pane ng-if=source.features.length id="{{ ::source.id }}"> <div ng-repeat="feature in ::source.features"> <h3>{{ ::feature.get(\'display_name\') }}</h3> <div ng-repeat="(key, value) in ::feature.getProperties()" ng-init="value = value !== undefined ? value : \'\'"> <span ng-if="::(key !== feature.getGeometryName() && key !== \'ngeo_feature_type_\')"> <span ng-bind=::key></span>: <span ng-bind=::value></span> </span> </div> </div> </div> </div> '},200:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=g(r(!function(){var e=new Error('Cannot find module "gmf/index.js"');throw e.code="MODULE_NOT_FOUND",e}())),n=g(r(!function(){var e=new Error('Cannot find module "goog/asserts.js"');throw e.code="MODULE_NOT_FOUND",e}())),i=g(r(56)),a=g(r(37)),l=g(r(201)),u=g(r(87)),s=g(r(14)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(3)),d=g(r(41)),h=g(r(26)),f=g(r(27)),p=g(r(8));function g(e){return e&&e.__esModule?e:{default:e}}var m=angular.module("gmfQueryWindowComponent",[i.default.module.name,a.default.module.name,l.default.name,u.default.module.name,"ngAnimate","ngTouch"]);function v(e,t,r){return r(e,t)}m.config(["$animateProvider",function(e){e.classNameFilter(/gmf-animatable/)}]),m.value("gmfDisplayquerywindowTemplateUrl",function(e,t){var r=t.gmfDisplayquerywindowTemplateurl;return void 0!==r?r:o.default.baseModuleTemplateUrl+"/query/windowComponent.html"}),v.$inject=["$element","$attrs","gmfDisplayquerywindowTemplateUrl"],m.component_={controller:"GmfDisplayquerywindowController as ctrl",bindings:{draggableContainment:"<?gmfDisplayquerywindowDraggableContainment",featuresStyleFn:"&gmfDisplayquerywindowFeaturesstyle",selectedFeatureStyleFn:"&gmfDisplayquerywindowSelectedfeaturestyle",defaultCollapsedFn:"&?gmfDisplayquerywindowDefaultcollapsed",desktop:"=gmfDisplayquerywindowDesktop",showUnqueriedLayers:"=gmfDisplayquerywindowShowunqueriedlayers"},templateUrl:v},m.component("gmfDisplayquerywindow",m.component_),m.Controller_=function(e,t,r,o,n){var i=this;this.draggableContainment,this.desktop=!1,this.collapsed=!this.desktop,this.showUnqueriedLayers_=!1,this.sourcesFilter={queried:!0},this.ngeoQueryResult={sources:[],total:0,pending:!1},this.ngeoMapQuerent_=o,this.selectedSource=null,this.features_=new s.default,this.ngeoFeatureOverlayMgr_=n,this.highlightFeatures_=new s.default,this.source=null,this.feature=null,this.currentResult=-1,this.isNext=!0,this.animate=0,this.open=!1,this.element_=e,t.$watchCollection(function(){return r},function(e,t){i.updateQueryResult_(e),e.total>0?i.show():t!==e&&i.close()})},m.Controller_.$inject=["$element","$scope","ngeoQueryResult","ngeoMapQuerent","ngeoFeatureOverlayMgr"],m.Controller_.prototype.$onInit=function(){this.draggableContainment=this.draggableContainment||"document",this.desktop=this.desktop,this.collapsed=this.defaultCollapsedFn?!0===this.defaultCollapsedFn():!this.desktop,this.showUnqueriedLayers_=!!this.showUnqueriedLayers&&!0===this.showUnqueriedLayers,this.sourcesFilter=this.showUnqueriedLayers_?{}:{queried:!0};var e=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();e.setFeatures(this.features_);var t=this.featuresStyleFn();void 0!==t&&(n.default.assertInstanceof(t,p.default),e.setStyle(t));var r=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();r.setFeatures(this.highlightFeatures_);var o=this.selectedFeatureStyleFn();if(void 0!==o)n.default.assertInstanceof(o,p.default);else{var i=new h.default({color:[255,0,0,.6]}),a=new f.default({color:[255,0,0,1],width:2});o=new p.default({fill:i,image:new d.default({fill:i,radius:5,stroke:a}),stroke:a})}r.setStyle(o),this.desktop&&(this.element_.find(".gmf-displayquerywindow .container").draggable({cancel:"input,textarea,button,select,option,tr",containment:this.draggableContainment}),this.element_.find(".gmf-displayquerywindow .container").resizable({minHeight:240,minWidth:240}))},m.Controller_.prototype.show=function(){this.clear(),this.updateFeatures_()},m.Controller_.prototype.updateFeatures_=function(){this.setCurrentResult_(0,!1),null!==this.source&&(this.collectFeatures_(),this.highlightCurrentFeature_(),this.open=!0)},m.Controller_.prototype.setCurrentResult_=function(e,t){var r=!1;if(e!==this.currentResult){var o=void 0,n=void 0,i=void 0,a=this.feature,l=this.ngeoQueryResult.sources;for(this.currentResult=e,o=0;o<l.length;o++)if(n=l[o],null===this.selectedSource||this.selectedSource===n){if(!(e>=(i=n.features).length)){this.source=n,this.feature=n.features[e],r=!0;break}e-=i.length}t&&this.highlightCurrentFeature_(a)}return r},m.Controller_.prototype.previous=function(){var e=this.currentResult-1;e<0&&(e=this.getResultLength()-1),this.setCurrentResult_(e,!0)&&this.animate_(!1)},m.Controller_.prototype.next=function(){var e=this.currentResult+1;e>this.getResultLength()-1&&(e=0),this.setCurrentResult_(e,!0)&&this.animate_(!0)},m.Controller_.prototype.updateQueryResult_=function(e){this.ngeoQueryResult.total=0,this.ngeoQueryResult.sources.length=0;for(var t=0;t<e.sources.length;t++){var r=e.sources[t];r.features=r.features.filter(function(e){return n.default.assert(e),!c.isEmpty(a.default.getFilteredFeatureValues(e))}),this.ngeoQueryResult.sources.push(r),this.ngeoQueryResult.total+=r.features.length}},m.Controller_.prototype.getResultLength=function(){return null===this.selectedSource?this.ngeoQueryResult.total:this.selectedSource.features.length},m.Controller_.prototype.isFirst=function(){return 0==this.currentResult},m.Controller_.prototype.isLast=function(){return this.currentResult==this.getResultLength()-1},m.Controller_.prototype.getFeatureValues=function(){return this.feature?a.default.getFilteredFeatureValues(this.feature):null},m.Controller_.prototype.animate_=function(e){this.isNext=e,this.animate++},m.Controller_.prototype.collectFeatures_=function(){var e=this.ngeoQueryResult.sources;this.features_.clear();for(var t=0;t<e.length;t++){var r=e[t];if(null===this.selectedSource||this.selectedSource===r)for(var o=r.features,n=0;n<o.length;n++)this.features_.push(o[n])}},m.Controller_.prototype.highlightCurrentFeature_=function(e){this.highlightFeatures_.clear(),this.features_.remove(this.feature),this.highlightFeatures_.push(this.feature),void 0!==e&&this.features_.push(e)},m.Controller_.prototype.close=function(){this.open=!1,this.clear(),this.ngeoMapQuerent_.clear()},m.Controller_.prototype.clear=function(){this.feature=null,this.source=null,this.currentResult=-1,this.features_.clear(),this.highlightFeatures_.clear(),this.selectedSource=null},m.Controller_.prototype.setSelectedSource=function(e){null!==e&&e.features.length<=0||(this.clear(),this.selectedSource=e,this.updateFeatures_())},m.controller("GmfDisplayquerywindowController",m.Controller_),t.default=m},201:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=angular.module("ngeoMiscSwipe",[]);o.factory("$verticalSwipe",[function(){var e={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup",cancel:"pointercancel"}};function t(e){var t=e.originalEvent||e,r=t.touches&&t.touches.length?t.touches:[t],o=t.changedTouches&&t.changedTouches[0]||r[0];return{x:o.clientX,y:o.clientY}}function r(t,r){var o=[];return angular.forEach(t,function(t){var n=e[t][r];n&&o.push(n)}),o.join(" ")}return{bind:function(e,o,n){var i=void 0,a=void 0,l=void 0,u=void 0,s=!1;n=n||["mouse","touch","pointer"],e.on(r(n,"start"),function(e){l=t(e),s=!0,i=0,a=0,u=l,o.start&&o.start(l,e)});var c=r(n,"cancel");c&&e.on(c,function(e){s=!1,o.cancel&&o.cancel(e)}),e.on(r(n,"move"),function(e){if(s&&l){var r=t(e);if(i+=Math.abs(r.x-u.x),a+=Math.abs(r.y-u.y),u=r,!(i<10&&a<10))return i>a?(s=!1,void(o.cancel&&o.cancel(e))):(e.preventDefault(),void(o.move&&o.move(r,e)))}}),e.on(r(n,"end"),function(e){s&&(s=!1,o.end&&o.end(t(e),e))})}}}]),o.makeSwipeDirective_=function(e,t,r){o.directive(e,["$parse","$verticalSwipe",function(o,n){var i=75,a=.3,l=30;return function(u,s,c){var d=o(c[e]),h=void 0,f=void 0;var p=["touch"];angular.isDefined(c.ngeoSwipeDisableMouse)||p.push("mouse"),n.bind(s,{start:function(e,t){h=e,f=!0},cancel:function(e){f=!1},end:function(e,o){(function(e){if(!h)return!1;var r=(e.y-h.y)*t,o=Math.abs(e.x-h.x);return f&&o<i&&r>0&&r>l&&o/r<a})(e)&&u.$apply(function(){s.triggerHandler(r),d(u,{$event:o})})}},p)}}])},o.makeSwipeDirective_("ngeoSwipeDown",1,"swipedown"),o.makeSwipeDirective_("ngeoSwipeUp",-1,"swipeup"),t.default=o},380:function(e,t,r){r(12),e.exports=r(381)},381:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=C(r(126)),n=C(r(64)),i=C(r(24)),a=C(r(200)),l=C(r(15)),u=C(r(86)),s=C(r(30)),c=C(r(135)),d=C(r(134)),h=C(r(13)),f=C(r(17)),p=C(r(11)),g=C(r(5)),m=C(r(41)),v=C(r(26)),y=C(r(27)),w=C(r(8)),_=C(r(97));function C(e){return e&&e.__esModule?e:{default:e}}var b={};b.module=angular.module("gmfapp",[o.default.module.name,n.default.name,i.default.name,a.default.name,l.default.module.name,_.default.name,u.default.name,c.default.name,d.default.name]),b.module.value("ngeoQueryOptions",{limit:20}),b.module.value("gmfTreeUrl","https://geomapfish-demo.camptocamp.net/2.2/wsgi/themes?version=2&background=background"),b.constant("defaultTheme","Demo"),b.constant("angularLocaleScript","../build/angular-locale_{{locale}}.js"),b.queryresultComponent={controller:"AppQueryresultController",controllerAs:"qrCtrl",template:r(199)},b.module.component("appQueryresult",b.queryresultComponent),b.QueryresultController=function(e){this.result=e},b.QueryresultController.$inject=["ngeoQueryResult"],b.module.controller("AppQueryresultController",b.QueryresultController),b.MainController=function(e,t,r){var o=this;e.loadThemes();var n=new v.default({color:[255,170,0,.6]}),i=new y.default({color:[255,170,0,1],width:2});this.featureStyle=new w.default({fill:n,image:new m.default({fill:n,radius:5,stroke:i}),stroke:i}),this.map=new h.default({layers:[new p.default({source:new g.default})],view:new f.default({projection:s.default,resolutions:[200,100,50,20,10,5,2.5,2,1,.5],center:[537635,152640],zoom:3})}),t.setDatasourceMap(this.map),this.themes=void 0,this.treeSource=void 0,this.queryActive=!0,e.getThemesObject().then(function(e){e&&(o.themes=e,o.treeSource=e[3])}),r.init(this.map)},b.MainController.$inject=["gmfThemes","gmfDataSourcesManager","ngeoFeatureOverlayMgr"],b.module.controller("MainController",b.MainController),t.default=b},5:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(19),i=r(20);const a=function(e){const t=e||{},r=void 0!==t.projection?t.projection:"EPSG:3857",o=void 0!==t.tileGrid?t.tileGrid:Object(i.a)({extent:Object(i.b)(r),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});n.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:r,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(o.inherits)(a,n.a);var l=a;const u=function(e){const t=e||{};let r;r=void 0!==t.attributions?t.attributions:[u.ATTRIBUTION];const o=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";l.call(this,{attributions:r,cacheSize:t.cacheSize,crossOrigin:o,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:n,wrapX:t.wrapX})};Object(o.inherits)(u,l),u.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.';t.default=u}},[380]);
//# sourceMappingURL=displayquerywindow.ba0445ad599436c5706e.js.map