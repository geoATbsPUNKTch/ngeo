webpackJsonp([2],{362:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=m(i(1)),r=g(i(0)),a=m(i(2)),o=m(i(12)),s=g(i(27)),l=m(i(32)),u=m(i(19)),h=m(i(59)),c=m(i(67)),d=m(i(55)),f=m(i(44)),p=m(i(40));function g(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function m(t){return t&&t.__esModule?t:{default:t}}var _=function(t){d.default.call(this,{handleEvent:s.TRUE}),this.changeEventKey_=null,this.type_=t.type,this.minPoints_=t.minPoints?t.minPoints:"Polygon"===this.type_?3:2,this.sketchFeature_=null,this.sketchPoints_=[],this.sketchPoint_=null,this.overlay_=new f.default({source:new p.default({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:c.default.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),a.default.listen(this,"change:active",this.updateState_,this),this.set("dirty",!1),this.set("drawing",!1),this.set("valid",!1)};r.inherits(_,d.default),_.prototype.setMap=function(t){this.getMap()&&this.changeEventKey_&&a.default.unlistenByKey(this.changeEventKey_),d.default.prototype.setMap.call(this,t),t&&(this.changeEventKey_=a.default.listen(t.getView(),"change:center",this.handleViewCenterChange_,this)),this.updateState_()},_.prototype.getDirty=function(){return this.get("dirty")},_.prototype.getDrawing=function(){return this.get("drawing")},_.prototype.getValid=function(){return this.get("valid")},_.prototype.getFeature=function(){return this.sketchFeature_},_.prototype.addToDrawing=function(){var t=this.getActive(),e=this.getDrawing();if(t&&e){var i=void 0,r=this.getSketchPointGeometry_().getCoordinates(),a=void 0;if("Point"===this.type_)return this.sketchFeature_||(this.sketchFeature_=new o.default(new u.default(r)),this.dispatchEvent(new c.default.Event("drawstart",this.sketchFeature_))),i=this.sketchFeature_.getGeometry(),n.default.assertInstanceof(i,h.default),void i.setCoordinates(r);"LineString"===this.type_&&(this.sketchPoints_.push(this.sketchPoint_),this.sketchFeature_?(i=this.sketchFeature_.getGeometry(),n.default.assertInstanceof(i,h.default),(a=i.getCoordinates()).push(r.slice()),i.setCoordinates(a)):(a=[r.slice(),r.slice()],this.sketchFeature_=new o.default(new l.default(a)),this.dispatchEvent(new c.default.Event("drawstart",this.sketchFeature_)))),this.getDirty()&&this.set("dirty",!1);var s=this.getValid();"LineString"===this.type_&&(a.length>=this.minPoints_?s||this.set("valid",!0):s&&this.set("valid",!1)),this.sketchPoint_=null,this.updateSketchFeatures_()}},_.prototype.clearDrawing=function(){this.setActive(!1),this.setActive(!0)},_.prototype.finishDrawing=function(){var t=this.getActive(),e=this.getDrawing();t&&e&&(this.sketchPoint_&&this.addToDrawing(),this.set("drawing",!1),this.dispatchEvent(new c.default.Event("drawend",this.sketchFeature_)))},_.prototype.startDrawing_=function(){this.set("drawing",!0),this.createOrUpdateSketchPoint_(),this.updateSketchFeatures_(),"Point"===this.type_&&this.addToDrawing()},_.prototype.modifyDrawing_=function(){if(this.sketchFeature_){var t=this.getCenter_();if("LineString"===this.type_){var e=this.sketchFeature_.getGeometry();n.default.assertInstanceof(e,h.default);var i=e.getCoordinates();i.pop(),i.push(t),e.setCoordinates(i)}this.getDirty()||this.set("dirty",!0)}},_.prototype.abortDrawing_=function(){var t=this.sketchFeature_;return(t||this.sketchPoints_.length>0)&&(this.sketchFeature_=null,this.sketchPoint_=null,this.overlay_.getSource().clear(!0)),this.sketchPoints_=[],this.set("dirty",!1),this.set("drawing",!1),this.set("valid",!1),t},_.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e?this.startDrawing_():this.abortDrawing_(),this.overlay_.setMap(e?t:null)},_.prototype.handleViewCenterChange_=function(t){var e=this.getActive(),i=this.getDrawing();e&&i&&(this.createOrUpdateSketchPoint_(),"Point"===this.type_?this.addToDrawing():(this.modifyDrawing_(),this.updateSketchFeatures_()))},_.prototype.createOrUpdateSketchPoint_=function(){var t=this.getCenter_();this.sketchPoint_?this.getSketchPointGeometry_().setCoordinates(t):this.sketchPoint_=new o.default(new u.default(t))},_.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t),e.addFeatures(this.sketchPoints_)},_.prototype.getSketchPointGeometry_=function(){n.default.assert(this.sketchPoint_,"sketch point should be thruty");var t=this.sketchPoint_.getGeometry();return n.default.assertInstanceof(t,u.default),t},_.prototype.getCenter_=function(){var t=this.getMap().getView().getCenter();return n.default.assertArray(t),t},e.default=_},549:function(t,e,i){i(15),t.exports=i(550)},550:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(551),i(17);var n=p(i(28)),r=p(i(197)),a=p(i(552)),o=p(i(555)),s=p(i(111)),l=p(i(35)),u=p(i(16)),h=p(i(21)),c=p(i(558)),d=p(i(14)),f=p(i(7));function p(t){return t&&t.__esModule?t:{default:t}}var g={};g.module=angular.module("gmfapp",[n.default.name,r.default.module.name,a.default.name,o.default.name,s.default.name]),g.module.value("gmfRasterUrl","https://geomapfish-demo.camptocamp.net/2.2/wsgi/raster"),g.constant("defaultTheme","Demo"),g.constant("angularLocaleScript","../build/angular-locale_{{locale}}.js"),g.MainController=function(t){var e=t.getMapCenter()||[537635,152640],i=t.getMapZoom()||3;this.map=new u.default({layers:[new d.default({source:new f.default})],view:new h.default({projection:l.default,resolutions:[200,100,50,20,10,5,2.5,2,1,.5],center:e,zoom:i})}),this.map.addControl(new c.default),this.measureLengthActive=!1,this.measurePointLayersConfig={aster:{unit:"m",decimals:2},srtm:{unit:"m"}},this.measurePointActive=!1},g.MainController.$inject=["gmfPermalink"],g.module.controller("MainController",g.MainController),e.default=g},551:function(t,e){},552:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});d(i(13));var n=d(i(88)),r=d(i(553)),a=d(i(92)),o=d(i(2)),s=d(i(34)),l=d(i(30)),u=d(i(105)),h=d(i(31)),c=d(i(10));function d(t){return t&&t.__esModule?t:{default:t}}var f=angular.module("gmfMobileMeasureLength",[n.default.name]);f.value("gmfMobileMeasureLengthTemplateUrl",function(t,e){var n=e.gmfMobileMeasureLengthTemplateurl;return void 0!==n?n:i(554)}),f.component_=function(t){return{restrict:"A",scope:{active:"=gmfMobileMeasurelengthActive",precision:"<?gmfMobileMeasurelengthPrecision",map:"=gmfMobileMeasurelengthMap",sketchStyle:"=?gmfMobileMeasurelengthSketchstyle"},controller:"GmfMobileMeasureLengthController as ctrl",bindToController:!0,templateUrl:t,link:function(t,e,i,n){n.init()}}},f.component_.$inject=["gmfMobileMeasureLengthTemplateUrl"],f.directive("gmfMobileMeasurelength",f.component_),f.Controller_=function(t,e){var i=this;this.scope_=t,this.filter_=e,this.map,this.active,this.scope_.$watch(function(){return i.active},function(t){i.measure.setActive(t)}),this.precision,this.sketchStyle=new c.default({fill:new l.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new h.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new u.default({stroke:new h.default({color:"rgba(0, 0, 0, 0.7)",width:2}),points:4,radius:8,radius2:0,angle:0})}),this.measure,this.drawInteraction,this.dirty=!1,this.drawing=!1,this.valid=!1},f.Controller_.$inject=["$scope","$filter"],f.Controller_.prototype.init=function(){this.measure=new r.default(this.filter_("ngeoUnitPrefix"),{precision:this.precision,sketchStyle:this.sketchStyle}),this.measure.setActive(this.active),a.default.interaction(this.measure),this.drawInteraction=this.measure.getDrawInteraction();var t=this.drawInteraction;a.default.interaction(t),Object.defineProperty(this,"hasPoints",{get:function(){return null!==this.drawInteraction.getFeature()}}),o.default.listen(t,s.default.getChangeEventType("dirty"),function(){this.dirty=t.getDirty(),this.dirty&&this.scope_.$apply()},this),o.default.listen(t,s.default.getChangeEventType("drawing"),function(){this.drawing=t.getDrawing()},this),o.default.listen(t,s.default.getChangeEventType("valid"),function(){this.valid=t.getValid()},this),this.map.addInteraction(this.measure)},f.Controller_.prototype.addPoint=function(){this.drawInteraction.addToDrawing()},f.Controller_.prototype.clear=function(){this.drawInteraction.clearDrawing()},f.Controller_.prototype.finish=function(){this.drawInteraction.finishDrawing()},f.Controller_.prototype.deactivate=function(){this.active=!1},f.controller("GmfMobileMeasureLengthController",f.Controller_),e.default=f},553:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(i(234)),r=o(i(362)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(0));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e){var i=void 0!==e?e:{};a.obj.assign(i,{displayHelpTooltip:!1}),n.default.call(this,t,i)};a.inherits(s,n.default),s.prototype.createDrawInteraction=function(t,e){return new r.default({type:"LineString",style:t,source:e})},e.default=s},554:function(t,e,i){t.exports=i.p+"e3a91ab40cf47b665f03006216b9a06d.html"},555:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});f(i(13));var n=f(i(179)),r=f(i(1)),a=f(i(556)),o=f(i(168)),s=f(i(92)),l=f(i(2)),u=f(i(30)),h=f(i(105)),c=f(i(31)),d=f(i(10));function f(t){return t&&t.__esModule?t:{default:t}}var p=angular.module("gmfMobileMeasurePoint",[n.default.module.name,o.default.name]);p.value("gmfMobileMeasurePointTemplateUrl",function(t,e){var n=e.gmfMobileMeasurePointTemplateurl;return void 0!==n?n:i(557)}),p.component_=function(t){return{restrict:"A",scope:{active:"=gmfMobileMeasurepointActive",getCoordinateDecimalsFn:"&?gmfMobileMeasurepointCoordinatedecimals",getLayersConfigFn:"&gmfMobileMeasurepointLayersconfig",map:"=gmfMobileMeasurepointMap",sketchStyle:"=?gmfMobileMeasurepointSketchstyle",format:"<gmfMobileMeasurepointFormat"},controller:"GmfMobileMeasurePointController as ctrl",bindToController:!0,templateUrl:t,link:function(t,e,i,n){n.init()}}},p.component_.$inject=["gmfMobileMeasurePointTemplateUrl"],p.directive("gmfMobileMeasurepoint",p.component_),p.Controller_=function(t,e,i,n,r){var a=this;this.gmfRaster_=n,this.ngeoDebounce_=r,this.gettextCatalog_=t,this.$filter_=i,this.map,this.active,e.$watch(function(){return a.active},function(t){a.measure.setActive(t),a.handleMeasureActiveChange_()});var o=this.getCoordinateDecimalsFn;this.coordinateDecimals=o?o():0,this.layersConfig,this.sketchStyle,void 0===this.sketchStyle&&(this.sketchStyle=new d.default({fill:new u.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new c.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new h.default({stroke:new c.default({color:"rgba(0, 0, 0, 0.7)",width:2}),points:4,radius:8,radius2:0,angle:0})})),this.format,this.measure,this.drawInteraction,this.mapViewPropertyChangeEventKey_=null},p.Controller_.$inject=["gettextCatalog","$scope","$filter","gmfRaster","ngeoDebounce"],p.Controller_.prototype.init=function(){this.measure=new a.default(this.$filter_("ngeoNumberCoordinates"),this.format||"{x}, {y}",{decimals:this.coordinateDecimals,sketchStyle:this.sketchStyle}),this.measure.setActive(this.active),s.default.interaction(this.measure),this.drawInteraction=this.measure.getDrawInteraction(),s.default.interaction(this.drawInteraction);var t=this.getLayersConfigFn();r.default.assert(Array.isArray(t)),this.layersConfig=t,this.map.addInteraction(this.measure)},p.Controller_.prototype.deactivate=function(){this.active=!1},p.Controller_.prototype.translate=function(t){return this.gettextCatalog_.getString(t)},p.Controller_.prototype.handleMeasureActiveChange_=function(){if(this.measure.getActive()){var t=this.map.getView();this.mapViewPropertyChangeEventKey_=l.default.listen(t,"propertychange",this.ngeoDebounce_(this.getMeasure_.bind(this),300,!0),this),this.getMeasure_()}else this.mapViewPropertyChangeEventKey_&&(l.default.unlistenByKey(this.mapViewPropertyChangeEventKey_),this.mapViewPropertyChangeEventKey_=null)},p.Controller_.prototype.getMeasure_=function(){var t=this,e=this.map.getView().getCenter();r.default.assertArray(e);var i={layers:this.layersConfig.map(function(t){return t.name}).join(",")};this.gmfRaster_.getRaster(e,i).then(function(e){var i=t.measure.getTooltipElement(),n=document.createElement("div");n.className="gmf-mobile-measure-point";var r=!0,a=!1,o=void 0;try{for(var s,l=t.layersConfig[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value,h=u.name;if(h in e){var c=e[h],d=document.createElement("div");d.className="gmf-mobile-measure-point-"+h;var f=u.unit||"",p=u.decimals&&u.decimals>0||0;c=t.$filter_("number")(c,p),d.innerHTML=[t.translate(h),": ",c," ",f].join(""),n.appendChild(d)}}}catch(t){a=!0,o=t}finally{try{!r&&l.return&&l.return()}finally{if(a)throw o}}var g=i.getElementsByClassName("gmf-mobile-measure-point");g[0]&&g[0].remove(),i.appendChild(n)})},p.controller("GmfMobileMeasurePointController",p.Controller_),p.LayerConfig,e.default=p},556:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=h(i(1)),r=h(i(153)),a=h(i(362)),o=u(i(0)),s=u(i(4)),l=h(i(19));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function h(t){return t&&t.__esModule?t:{default:t}}var c=function(t,e,i){var n=void 0!==i?i:{};s.assign(n,{displayHelpTooltip:!1}),r.default.call(this,n),this.format_=t,this.coordFormat_=e};o.inherits(c,r.default),c.prototype.createDrawInteraction=function(t,e){return new a.default({type:"Point",style:t,source:e})},c.prototype.handleMeasure=function(t){var e=n.default.assertInstanceof(this.sketchFeature.getGeometry(),l.default),i=this.decimals;t(r.default.getFormattedPoint(e,i,this.format_,this.coordFormat_),e.getLastCoordinate())},e.default=c},557:function(t,e,i){t.exports=i.p+"f9ce6026e8fd600ec8f4a6664fe7eecb.html"},558:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(34),a=i(22),o=i(139),s="degrees",l="imperial",u="nautical",h="metric",c="us",d=i(100),f=i(2),p=i(8),g=i(85);const m=function(t){const e=t||{},i=void 0!==e.className?e.className:"ol-scale-line";this.innerElement_=document.createElement("DIV"),this.innerElement_.className=i+"-inner",this.element_=document.createElement("DIV"),this.element_.className=i+" "+d.d,this.element_.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==e.minWidth?e.minWidth:64,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="";const n=e.render?e.render:m.render;o.default.call(this,{element:this.element_,render:n,target:e.target}),f.default.listen(this,r.default.getChangeEventType(m.Property_.UNITS),this.handleUnitsChanged_,this),this.setUnits(e.units||h)};Object(n.inherits)(m,o.default),m.LEADING_DIGITS=[1,2,5],m.prototype.getUnits=function(){return this.get(m.Property_.UNITS)},m.render=function(t){const e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()},m.prototype.handleUnitsChanged_=function(){this.updateElement_()},m.prototype.setUnits=function(t){this.set(m.Property_.UNITS,t)},m.prototype.updateElement_=function(){const t=this.viewState_;if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));const e=t.center,i=t.projection,n=this.getUnits(),r=n==s?g.a.DEGREES:g.a.METERS;let o=Object(p.getPointResolution)(i,t.resolution,e,r);i.getUnits()!=g.a.DEGREES&&n==h&&(o*=i.getMetersPerUnit());let d=this.minWidth_*o,f="";if(n==s){const t=p.METERS_PER_UNIT[g.a.DEGREES];i.getUnits()==g.a.DEGREES?d*=t:o/=t,d<t/60?(f="″",o*=3600):d<t?(f="′",o*=60):f="°"}else n==l?d<.9144?(f="in",o/=.0254):d<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344):n==u?(o/=1852,f="nm"):n==h?d<.001?(f="μm",o*=1e6):d<1?(f="mm",o*=1e3):d<1e3?f="m":(f="km",o/=1e3):n==c?d<.9144?(f="in",o*=39.37):d<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472):Object(a.a)(!1,33);let _,y,v=3*Math.floor(Math.log(this.minWidth_*o)/Math.log(10));for(;;){if(_=m.LEADING_DIGITS[(v%3+3)%3]*Math.pow(10,Math.floor(v/3)),y=Math.round(_/o),isNaN(y))return this.element_.style.display="none",void(this.renderedVisible_=!1);if(y>=this.minWidth_)break;++v}const w=_+" "+f;this.renderedHTML_!=w&&(this.innerElement_.innerHTML=w,this.renderedHTML_=w),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0)},m.Property_={UNITS:"units"};e.default=m},7:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(23),a=i(24);const o=function(t){const e=t||{},i=void 0!==e.projection?e.projection:"EPSG:3857",n=void 0!==e.tileGrid?e.tileGrid:a.a.createXYZ({extent:a.a.extentFromProjection(i),maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});r.a.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,opaque:e.opaque,projection:i,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition})};Object(n.inherits)(o,r.a);var s=o;const l=function(t){const e=t||{};let i;i=void 0!==e.attributions?e.attributions:[l.ATTRIBUTION];const n=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",r=void 0!==e.url?e.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";s.call(this,{attributions:i,cacheSize:e.cacheSize,crossOrigin:n,opaque:void 0===e.opaque||e.opaque,maxZoom:void 0!==e.maxZoom?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:r,wrapX:e.wrapX})};Object(n.inherits)(l,s),l.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.';e.default=l}},[549]);
//# sourceMappingURL=mobilemeasure.bbf1e96c1c1c7c6a6407.js.map