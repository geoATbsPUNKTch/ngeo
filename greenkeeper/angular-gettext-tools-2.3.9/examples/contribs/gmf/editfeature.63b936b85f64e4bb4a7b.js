webpackJsonp([18],{521:function(e,t,i){i(17),e.exports=i(522)},522:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),i(523),i(18);m(i(36));var o=m(i(142)),r=m(i(165)),n=m(i(30)),a=m(i(10)),l=m(i(16)),s=m(i(24)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(3)),c=m(i(20)),h=m(i(14)),d=m(i(85)),p=m(i(6)),f=m(i(86));function m(e){return e&&e.__esModule?e:{default:e}}var g={};g.module=angular.module("gmfapp",[o.default.name,r.default.module.name,n.default.name]),g.module.value("authenticationBaseUrl","https://geomapfish-demo.camptocamp.net/2.2/wsgi"),g.module.value("gmfLayersUrl","https://geomapfish-demo.camptocamp.net/2.2/wsgi/layers/"),g.constant("defaultTheme","Demo"),g.constant("angularLocaleScript","../build/angular-locale_{{locale}}.js"),g.MainController=function(t,i,o){this.scope_=t,this.editFeature_=i,this.gmfUser=o,this.wmsSource_=new f.default({url:"https://geomapfish-demo.camptocamp.net/2.2/wsgi/mapserv_proxy",params:{LAYERS:"point"}}),this.wmsLayer_=new d.default({source:this.wmsSource_}),this.pixelBuffer_=10,this.layerId_=113,this.feature=null,this.pending=!1,this.map=new l.default({layers:[new h.default({source:new p.default}),this.wmsLayer_],view:new s.default({projection:"EPSG:21781",resolutions:[200,100,50,20,10,5,2.5,2,1,.5],center:[537635,152640],zoom:2})}),this.map.on("singleclick",this.handleMapSingleClick_,this),e('[data-toggle="tooltip"]').tooltip({container:"body",trigger:"hover"})},g.MainController.$inject=["$scope","gmfEditFeature","gmfUser"],g.MainController.prototype.handleMapSingleClick_=function(e){var t=e.coordinate,i=this.map.getView().getResolution()*this.pixelBuffer_,o=u.buffer([t[0],t[1],t[0],t[1]],i);this.editFeature_.getFeaturesInExtent([this.layerId_],o).then(this.handleGetFeatures_.bind(this)),this.feature=null,this.pending=!0,this.scope_.$apply()},g.MainController.prototype.handleGetFeatures_=function(e){this.pending=!1,e.length&&(this.feature=e[0])},g.MainController.prototype.insertFeature=function(){this.pending=!0;var e=this.map,t=e.getView(),i=-50*t.getResolution(),o=e.getSize(),r=u.buffer(t.calculateExtent(o),i),n=u.getBottomLeft(r),l=u.getTopRight(r),s=n[0],h=n[1],d=l[0],p=d-s,f=l[1]-h,m=[s+Math.random()*p,d+Math.random()*f],g=new a.default({geometry:new c.default(m),name:"New point"});this.editFeature_.insertFeatures(this.layerId_,[g]).then(this.handleEditFeature_.bind(this))},g.MainController.prototype.updateFeature=function(){console.assert(this.feature),this.pending=!0,this.feature.set("name","Updated name"),this.editFeature_.updateFeature(this.layerId_,this.feature).then(this.handleEditFeature_.bind(this)),this.feature=null},g.MainController.prototype.deleteFeature=function(){console.assert(this.feature),this.editFeature_.deleteFeature(this.layerId_,this.feature).then(this.handleEditFeature_.bind(this)),this.feature=null},g.MainController.prototype.handleEditFeature_=function(e){this.pending=!1,this.refreshWMSLayer_()},g.MainController.prototype.refreshWMSLayer_=function(){this.wmsSource_.updateParams({random:Math.random()})},g.module.controller("MainController",g.MainController),t.default=g}).call(t,i(8))},523:function(e,t){},6:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(26),n=i(23);const a=function(e){const t=e||{},i=void 0!==t.projection?t.projection:"EPSG:3857",o=void 0!==t.tileGrid?t.tileGrid:n.a.createXYZ({extent:n.a.extentFromProjection(i),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});r.a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,opaque:t.opaque,projection:i,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})};Object(o.inherits)(a,r.a);var l=a;const s=function(e){const t=e||{};let i;i=void 0!==t.attributions?t.attributions:[s.ATTRIBUTION];const o=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",r=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";l.call(this,{attributions:i,cacheSize:t.cacheSize,crossOrigin:o,opaque:void 0===t.opaque||t.opaque,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,url:r,wrapX:t.wrapX})};Object(o.inherits)(s,l),s.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.';t.default=s}},[521]);
//# sourceMappingURL=editfeature.63b936b85f64e4bb4a7b.js.map